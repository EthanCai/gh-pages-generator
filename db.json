{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/favicon.ico","path":"favicon.ico","modified":0,"renderable":0},{"_id":"source/images/avatar.jpg","path":"images/avatar.jpg","modified":0,"renderable":0},{"_id":"source/samples/expvarsample.go","path":"samples/expvarsample.go","modified":0,"renderable":0},{"_id":"themes/hexo-theme-next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/src/affix.js","path":"js/src/affix.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/src/motion.js","path":"js/src/motion.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/src/utils.js","path":"js/src/utils.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/LICENSE","path":"vendors/fastclick/LICENSE","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/README.md","path":"vendors/fastclick/README.md","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/bower.json","path":"vendors/fastclick/bower.json","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/HELP-US-OUT.txt","path":"vendors/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/bower.json","path":"vendors/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/CONTRIBUTING.md","path":"vendors/jquery_lazyload/CONTRIBUTING.md","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/README.md","path":"vendors/jquery_lazyload/README.md","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/bower.json","path":"vendors/jquery_lazyload/bower.json","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/jquery.scrollstop.js","path":"vendors/jquery_lazyload/jquery.scrollstop.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/jquery.lazyload.js","path":"vendors/jquery_lazyload/jquery.lazyload.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/velocity/bower.json","path":"vendors/velocity/bower.json","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.min.js","path":"vendors/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.ui.js","path":"vendors/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.ui.min.js","path":"vendors/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/jquery/index.js","path":"vendors/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/blank.gif","path":"vendors/fancybox/source/blank.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_loading.gif","path":"vendors/fancybox/source/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_loading@2x.gif","path":"vendors/fancybox/source/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_overlay.png","path":"vendors/fancybox/source/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_sprite.png","path":"vendors/fancybox/source/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_sprite@2x.png","path":"vendors/fancybox/source/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.css","path":"vendors/fancybox/source/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.pack.js","path":"vendors/fancybox/source/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.js","path":"vendors/fancybox/source/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/lib/fastclick.js","path":"vendors/fastclick/lib/fastclick.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/lib/fastclick.min.js","path":"vendors/fastclick/lib/fastclick.min.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.css","path":"vendors/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.css.map","path":"vendors/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.min.css","path":"vendors/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff2","path":"vendors/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/ua-parser-js/dist/ua-parser.min.js","path":"vendors/ua-parser-js/dist/ua-parser.min.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/ua-parser-js/dist/ua-parser.pack.js","path":"vendors/ua-parser-js/dist/ua-parser.pack.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.eot","path":"vendors/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/FontAwesome.otf","path":"vendors/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff","path":"vendors/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.js","path":"vendors/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/fancybox_buttons.png","path":"vendors/fancybox/source/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-media.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.ttf","path":"vendors/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.svg","path":"vendors/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1}],"Cache":[{"_id":"source/404.html","hash":"e71593534c6b530fd2df06be07c8d940b985529c","modified":1502679922000},{"_id":"source/favicon.ico","hash":"1f7d35b787b1751eef2793a2a8c6171dff51820f","modified":1502679922000},{"_id":"themes/hexo-theme-next/.bowerrc","hash":"80e096fdc1cf912ee85dd9f7e6e77fd40cf60f10","modified":1502679922000},{"_id":"themes/hexo-theme-next/.gitignore","hash":"efec790f5b7a0256763e1cc08f12c4f0aff509f6","modified":1502679922000},{"_id":"themes/hexo-theme-next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1502679922000},{"_id":"themes/hexo-theme-next/.javascript_ignore","hash":"d619ee13031908cd72666e4ff652d2ea3483b1c3","modified":1502679922000},{"_id":"themes/hexo-theme-next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1502679922000},{"_id":"themes/hexo-theme-next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1502679922000},{"_id":"themes/hexo-theme-next/README.en.md","hash":"565ba52b3825b85a9f05b41183caca7f18b741d4","modified":1502679922000},{"_id":"themes/hexo-theme-next/bower.json","hash":"d7f8d4eb7c6ac1bb8d642112601005f93e3da49b","modified":1502679922000},{"_id":"themes/hexo-theme-next/README.md","hash":"500b5606eb6a09c979d16128f8b00f4bf9bc95ac","modified":1502679922000},{"_id":"themes/hexo-theme-next/gulpfile.coffee","hash":"b3d53f36460119c741a98c0dc494b1c65d3ec943","modified":1502679922000},{"_id":"themes/hexo-theme-next/_config.yml","hash":"86f1c9467f6b8b2f54ff773799fabc653366b20a","modified":1502679922000},{"_id":"themes/hexo-theme-next/package.json","hash":"bd016b54983b7e06a649ee915b2e13a60d47553e","modified":1502679922000},{"_id":"source/_drafts/Error-Handling-in-Go.md","hash":"cf80b738bcbeed828a65feb92962ecf22694f7d5","modified":1514476781000},{"_id":"source/_drafts/build-your-own-container-cluster-for-development-based-on-docker-swarm.md","hash":"db6bc0dd001a10ffa8456dbc2412a0d8d6ff2e3c","modified":1511000654000},{"_id":"source/_posts/a-path-for-expand-mongodb-cluster.md","hash":"895d7d23e50b3d0f5f3a77ee9cab4a048b3161c9","modified":1502679922000},{"_id":"source/_posts/bad-parts-about-json-serialization-in-Golang.md","hash":"ba0871231e67f774e0c491482de8347e88235571","modified":1502679922000},{"_id":"source/_posts/collected-papers.md","hash":"4f16b224343cab27aed9984c94df6d8567ff0205","modified":1502679922000},{"_id":"source/_posts/config-smallest-mongodb-cluster-on-ubuntu-14-04.md","hash":"d067913c3636ae10775bb6a9a50dea1622d3f223","modified":1502679922000},{"_id":"source/_posts/configure-smallest-elasticsearch-cluster.md","hash":"abda98d08497142c2bc0ea479a23a6ec2485a203","modified":1502679922000},{"_id":"source/_posts/cracking-the-coding-skill.md","hash":"ab06edc7a8245f3391f4620038fac07c3efbb2bb","modified":1503836908000},{"_id":"source/_posts/create-a-launch-agents-in-macOS.md","hash":"02a0df9107ca8f21a4a689cc99d156f075ece5b5","modified":1511006063000},{"_id":"source/_posts/elastic-basic-concepts.md","hash":"7f57da879323e427244587b9887668ef582fcf28","modified":1502679922000},{"_id":"source/_posts/general-pagination-for-mobile-app.md","hash":"231eda6e11de66452b452b174e232222afbd0e4a","modified":1502679922000},{"_id":"source/_posts/experiences-about-develop-dlog.md","hash":"665733432cf6e1e6696f90d759c295b85574eb32","modified":1502679922000},{"_id":"source/_posts/install-elasticsearch-on-ubuntu-14-04.md","hash":"a3d09ab0eb6ecae5947df32590be98400e22d327","modified":1502679922000},{"_id":"source/_posts/install-oracle-jdk-on-ubuntu-14-04.md","hash":"539bf770e649fa78cef2c78c32c645831b45a57a","modified":1502679922000},{"_id":"source/_posts/make-php-development-VM-using-Vagrant.md","hash":"31f8ca9bf24b22f43ade044abe1cf80eafabb29a","modified":1502679922000},{"_id":"source/_posts/product-design-vs-requirement-analysis.md","hash":"c521367fb053b9f9a3dae238ae896b535d6c3fb0","modified":1502679922000},{"_id":"source/_posts/study-php-and-symfony-on-mac-os.md","hash":"74de19d5dc05bb59c85db4e02b7b3454e47dc179","modified":1502679922000},{"_id":"source/categories/index.md","hash":"344157c3e9b54d9247f213e085e193030ff66def","modified":1502679922000},{"_id":"source/images/avatar.jpg","hash":"c4dd28a263439f83c15ddc069d97642fcf22065f","modified":1502679922000},{"_id":"source/samples/expvarsample.go","hash":"40e471129b2c9c1599977e73955d9ff19ea6f821","modified":1502679922000},{"_id":"source/tags/index.md","hash":"d32085ddec1214e036e7c7e8dbdb105455cf4332","modified":1502679922000},{"_id":"themes/hexo-theme-next/.github/CONTRIBUTING.md","hash":"5ab257af816986cd0e53f9527a92d5934ac70ae9","modified":1502679922000},{"_id":"themes/hexo-theme-next/.github/ISSUE_TEMPLATE.md","hash":"d6047c2afeabe9a329d92eb2a03490ff181616c2","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/de.yml","hash":"786afba25cfc98845a20d9901823ebeebcd1cbbf","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/default.yml","hash":"9db835c0543ade5a89bc80ec5a898203227cf3d8","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/en.yml","hash":"f03799cbdb5a33064ead080bcac4baca1f6bc5f9","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/fr-FR.yml","hash":"1a084623c39de74301f3e92f9388a3a815a542ca","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/ja.yml","hash":"a2c7b6301b5474aab798946fb700289df237c3cf","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/pt.yml","hash":"ca239b39bf65c9462e59d51b12f0fe566d453197","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/zh-Hans.yml","hash":"bea452bc49aed171a210d09bd6cddc4e846ea8ab","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/ru.yml","hash":"cc7b964a46587aea0e57b0a5269d8fd25570858e","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_layout.swig","hash":"b2bba2630b51ec27e3242859e8d4fe3b181742c2","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/zh-hk.yml","hash":"519ab3d817ec3bc5bfc91159c494b6b3c170bea7","modified":1502679922000},{"_id":"themes/hexo-theme-next/languages/zh-tw.yml","hash":"6b1f345aaefc13e6723dc8a6741b59ac05c20dfd","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/archive.swig","hash":"b5b59d70fc1563f482fa07afd435752774ad5981","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/category.swig","hash":"6422d196ceaff4220d54b8af770e7e957f3364ad","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/index.swig","hash":"427d0b95b854e311ae363088ab39a393bf8fdc8b","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/page.swig","hash":"8019d02232a6dd1a665b6a4d2daef8e5dd2f0049","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/post.swig","hash":"e2e512142961ddfe77eba29eaa88f4a2ee43ae18","modified":1502679922000},{"_id":"themes/hexo-theme-next/scripts/merge-configs.js","hash":"0c56be2e85c694247cfa327ea6d627b99ca265e8","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/tag.swig","hash":"07cf49c49c39a14dfbe9ce8e7d7eea3d4d0a4911","modified":1502679922000},{"_id":"themes/hexo-theme-next/test/.jshintrc","hash":"096ed6df627373edd820f24d46b8baf528dee61d","modified":1502679922000},{"_id":"themes/hexo-theme-next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1502679922000},{"_id":"themes/hexo-theme-next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1502679922000},{"_id":"source/_posts/assets/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"source/_posts/configure-smallest-elasticsearch-cluster/es-cluster.jpg","hash":"6d4286d8f7f5ec3b89a879c1cb2fed7fdc82a26c","modified":1502679922000},{"_id":"source/_posts/elastic-basic-concepts/logo-elastic.png","hash":"875e4b0539a8fa79d1b2fbcd8809170d2247a368","modified":1502679922000},{"_id":"source/_posts/experiences-about-develop-dlog/channel.png","hash":"07fa353dc547212f594f859c2dde0c217eff983b","modified":1502679922000},{"_id":"source/_posts/experiences-about-develop-dlog/use_channel.png","hash":"853e9b256bf1db8aee27f55ec881305eb52d1ab6","modified":1502679922000},{"_id":"source/_posts/install-elasticsearch-on-ubuntu-14-04/logo-elastic.png","hash":"875e4b0539a8fa79d1b2fbcd8809170d2247a368","modified":1502679922000},{"_id":"source/_posts/install-oracle-jdk-on-ubuntu-14-04/oracle-jdk8-on-Ubuntu.png","hash":"4b6b78a9766974984c5e4993c3dab7326b046f7b","modified":1502679922000},{"_id":"source/_posts/make-php-development-VM-using-Vagrant/make-php-development-VM-using-Vagrant-13489.png","hash":"8344e17e266e1f582e35f79cc62e0ccfbe723474","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_macro/post-collapse.swig","hash":"43c3433155ccd9abcbe7dce2e6bfa1f3a66af18b","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_macro/reward.swig","hash":"e8e9c986ce1a0b370afd36703d49f1818492cb64","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_macro/post.swig","hash":"379737761f44fb71de997a73192f35b8e568ac58","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_macro/sidebar.swig","hash":"0ff291b272808fd471747f66b621822ed1dc8abd","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/comments.swig","hash":"82a9bc2ba60ce68419128ff60624bd74b15dfb78","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/footer.swig","hash":"3003fda5a8af553451f7945f4e1ce006ca72e4c4","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/header.swig","hash":"7739068b69f87ae641dea19c3445169ae80d5df4","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/head.swig","hash":"a7084dcef03fa0d0c97962ec9828b77c9a73592f","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/search.swig","hash":"011b9d6c9f0a2f4654908ea20b9391f9b7981271","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/baidu-push.swig","hash":"82d060fe055d6e423bbc9199f82dfe5c68e74779","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/vendors.swig","hash":"21b055278a74f190571af67cfae03ae6c3fb295c","modified":1502679922000},{"_id":"themes/hexo-theme-next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1502679922000},{"_id":"themes/hexo-theme-next/scripts/tags/full-image.js","hash":"3acce36db0feb11a982c6c799aa6b6b47df2827c","modified":1502679922000},{"_id":"themes/hexo-theme-next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1502679922000},{"_id":"source/_drafts/Error-Handling-in-Go/2a73dea7a35b4a2057eec46b15c17133.png","hash":"428e4fbf2ec95c96a46ada22d479dc02ac2a963c","modified":1511005939000},{"_id":"source/_posts/create-a-launch-agents-in-macOS/2a73dea7a35b4a2057eec46b15c17133.png","hash":"428e4fbf2ec95c96a46ada22d479dc02ac2a963c","modified":1511006063000},{"_id":"source/_posts/experiences-about-develop-dlog/expvarmon_screen.png","hash":"3cf57a3f5a4de25e898ce566770f123a6efb8eb4","modified":1502679922000},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-0c6a2.png","hash":"9ea615b35732ba04502467bad76960b562e1820a","modified":1502679922000},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-2aa39.png","hash":"7f50b85cb43570f16dea32b7ffb2599169fd740a","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/search/localsearch.swig","hash":"ff5523d5dacaa77a55a24e50e6e6530c3b98bfad","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/share/baidushare.swig","hash":"7ca5cb4daa58b3504e17f3e02975e794bc634658","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/share/add-this.swig","hash":"c07f7b2f264e5215b8ed42d67e8cef2477558364","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_partials/share/jiathis.swig","hash":"63315fcf210799f894208c9f512737096df84962","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/pages/post-details.swig","hash":"ce88ec0557b6d765ae38dd5984b178c7fc4d376e","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/analytics.swig","hash":"0a89c04055bade7baa5962f1d5aefe438d83a244","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/comments.swig","hash":"907b931d775d32405d02a25b3b0a3ac03bf804d0","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/lean-analytics.swig","hash":"2fc4a0d2c825a512f39c0eadd78452e90615465a","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/mathjax.swig","hash":"df03220eb8526e17dc9c9f17780c2d6699367181","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/localsearch.swig","hash":"1561bd0c107d725252c6d746e9ac177fc18f93bf","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_mixins/base.styl","hash":"4e49707c99c8bbcfa0a607dfdaff0fbb7dffd2a3","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_mixins/Pisces.styl","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_variables/Mist.styl","hash":"c8d35a6b9e3bff6d8fdb66de853065af9d37562d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_variables/Pisces.styl","hash":"bcf8238cf842bbfc8f3ea733889bc4dacf59d3c4","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_variables/base.styl","hash":"23df0070bef4952cc0e669f20fc78a8abba9676e","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_variables/default.styl","hash":"8ec3307fe42d738b1bbda4b6419d0995f5560222","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/js/src/bootstrap.js","hash":"39bf93769d9080fa01a9a875183b43198f79bc19","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/js/src/motion.js","hash":"269414e84df544a4ccb88519f6abae4943db3c67","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/js/src/utils.js","hash":"19d36fa3874b088bc3514a15c2360b2d06318047","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/.bower.json","hash":"7da985a99674e54f514d4fd9fcd3bcea6e7e41d5","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/HELP-US-OUT.txt","hash":"69a4c537d167b68a0ccf1c6febd138aeffca60d6","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1502679922000},{"_id":"source/_posts/elastic-basic-concepts/Brueghel-tower-of-babel.jpg","hash":"0bc00e82207f52fff6831dbf01919b2a47547a80","modified":1502679922000},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-aec25.png","hash":"5e7ff9c57439256f6d11f197baf08acb1f21a9f7","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1502679922000},{"_id":"source/_posts/experiences-about-develop-dlog/2016-04-21_07-12-40.png","hash":"328e623a575da9a88b9a2cbb058d787e520ece1b","modified":1502679922000},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-6c7bd.png","hash":"3093bfb5bd3bff2f396c31160325c0bc73ad5204","modified":1502679922000},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-33b82.png","hash":"1c30145f84f4eb3c92e126acb6b0841689687292","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/analytics/baidu-analytics.swig","hash":"7c43d66da93cde65b473a7d6db2a86f9a42647d6","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/analytics/facebook-sdk.swig","hash":"334176d838ee528e58468d8bc74ff3a6d3f25b2b","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/analytics/cnzz-analytics.swig","hash":"44e761721e8ad787ef571a3cc57bbc12d318a2a3","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/analytics/google-analytics.swig","hash":"30a23fa7e816496fdec0e932aa42e2d13098a9c2","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/comments/disqus.swig","hash":"3491d3cebabc8a28857200db28a1be65aad6adc2","modified":1502679922000},{"_id":"themes/hexo-theme-next/layout/_scripts/third-party/comments/duoshuo.swig","hash":"fa2b7a0006b6c447fa025474f8e0af4e4e569a36","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/buttons.styl","hash":"0dfb4b3ba3180d7285e66f270e1d3fa0f132c3d2","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/back-to-top.styl","hash":"b49efc66bd055a2d0be7deabfcb02ee72a9a28c8","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/components.styl","hash":"10994990d6e0b4d965a728a22cf7f6ee29cae9f6","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/pagination.styl","hash":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/base.styl","hash":"5304f99581da3a31de3ecec959b7adf9002fde83","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/helpers.styl","hash":"2e829b0a7b6cbc4318672f3eeb7b26249038132d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/scaffolding.styl","hash":"013619c472c7e4b08311c464fcbe9fcf5edde603","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/tables.styl","hash":"04e6c5257814c65e638ab70c53030e8dfdb3f37d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"4303776991ef28f5742ca51c7dffe6f12f0acf34","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/index.styl","hash":"6cc10d943d92eac953e6978e46d27ae55584482c","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_layout.styl","hash":"6ed60cc621bac096c0ed7534fa25b1a52dc571d4","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_menu.styl","hash":"c2c6c4f6434b4f94aac2af5861cd769427f0ee10","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Muse/index.styl","hash":"8aca5d9f1df157ab27e699c1b3ba9438b9e039ad","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_brand.styl","hash":"9658d09de4fcc809a29d4b706a9621adfb3090ad","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_full-image.styl","hash":"938d39eedc6e3d33918c1145a5bf1e79991d3fcf","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_layout.styl","hash":"8d7cecde4933900c7df2db9d0a98f5f82f88dc93","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_menu.styl","hash":"d09280e5b79f3b573edb30f30c7a5f03ac640986","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/_sidebar.styl","hash":"5522ddf7df5c150d97804584840976daa0e12d63","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Pisces/index.styl","hash":"1b10ba2d3ad0c063c418dc94a0b7e0db4b342c53","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/js/src/schemes/pisces.js","hash":"94f935331995bfeadf1084fb8f0665ab39fd1c8d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.css","hash":"3b87c2560832748cd06f9bfd2fd6ea8edbdae8c7","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/css/font-awesome.min.css","hash":"05ea25bc9b3ac48993e1fee322d3bc94b49a6e22","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff2","hash":"574ea2698c03ae9477db2ea3baf460ee32f1a7ea","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.eot","hash":"b3c2f08e73320135b69c23a3908b87a12053a2f6","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/FontAwesome.otf","hash":"0112e96f327d413938d37c1693806f468ffdbace","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff","hash":"507970402e328b2baeb05bde73bf9ded4e2c3a2d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1502679922000},{"_id":"source/_posts/experiences-about-develop-dlog/2016-04-21_07-12-24.png","hash":"8b2db6e1b6c48cfdb7bf5d6f820d05bf1f5984ea","modified":1502679922000},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-a5831.png","hash":"609ec7c964afcc87ab56e993646eb96f7d03c410","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/footer/footer.styl","hash":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/menu.styl","hash":"c890ce7fe933abad7baf39764a01894924854e92","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/highlight/highlight.styl","hash":"4c0be672d977ef793c72cf838f1d920f2749dda0","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/header/site-meta.styl","hash":"61763d236029d2a4414be499d0e65d7dfb34605b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/highlight/theme.styl","hash":"ae19721ceee5ba460e131cb2427dae3c1ff39d6f","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/archive.styl","hash":"23dd966324937deeccc8f5fa16a6d32e4e46243b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-collapse.styl","hash":"fe71e9be08cb418cf68352fd6212ddd0d7150579","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/pages/pages.styl","hash":"3c46efd6601e268093ce6d7b1471d18501878f0d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-expand.styl","hash":"b25132fe6a7ad67059a2c3afc60feabb479bdd75","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-meta.styl","hash":"330a2ce52c5a5fefc1e85c473113a3bc58210c76","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-more-link.styl","hash":"15063d79b5befc21820baf05d6f20cc1c1787477","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-nav.styl","hash":"cbca4842a54950e2934b3b8f3cd940f122111aef","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-title.styl","hash":"99d994bd19895a4aaa2fa8d12801ec72dd3cf118","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/post/post.styl","hash":"4677ae612ff9c593ee17ab2ea82dbb995432d301","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"2e7ec9aaa3293941106b1bdd09055246aa3c3dc6","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"c44f6a553ec7ea5508f2054a13be33a62a15d3a9","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"89fef1caf94caf76ca09c643b83b0b4d4e417e08","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar.styl","hash":"12f703e5fea9d8a7ba65c8cea93a5cf5c2b78457","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"6533563b34241e5c73da68156aba89e880b93f53","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/site-state.styl","hash":"58fb7604b44e3f56d880bbbd95d0baface38c4ee","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"2d3abbc85b979a648e0e579e45f16a6eba49d1e7","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/full-image.styl","hash":"618f73450cf541f88a4fddc3d22898aee49d105d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/tags/tags.styl","hash":"8e66c2635d48e11de616bb29c4b1323698eebc0a","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/third-party.styl","hash":"f7ebd428f3058ec3ecc7648788712617bea520ba","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_common/components/third-party/localsearch.styl","hash":"795d94561888d31cb7a6ff4a125596809ea69b7d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.ttf","hash":"27cf1f2ec59aece6938c7bb2feb0e287ea778ff9","modified":1502679922000},{"_id":"source/_posts/cracking-the-coding-skill/cracking_the_coding_skills.png","hash":"322d5a91e01b49b528b87cb8ee079faa2a24ab56","modified":1502679922000},{"_id":"themes/hexo-theme-next/source/vendors/font-awesome/fonts/fontawesome-webfont.svg","hash":"2b3c8ba7008cc014d8fb37abc6f9f49aeda83824","modified":1502679922000},{"_id":"source/_drafts/Error-Handling-in-Go/d2a2d12e1a00f819d7fd7af4b536efa2.png","hash":"ae40aa7e6dcc2d443100f55eeebea79c3fa6b305","modified":1514476754000}],"Category":[{"name":"","_id":"cjbjgf24d0004v7e86jktnms3"},{"name":"","_id":"cjbjgf24u000nv7e8off0uv46"},{"name":"","_id":"cjbjgf24x000uv7e8acy8bfl7"},{"name":"","_id":"cjbjgf256001dv7e8c8q65c9i"}],"Data":[],"Page":[{"_content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\"\n        charset=\"utf-8\" homePageUrl=\"/\"\n        homePageName=\"\">\n</script>\n\n</body>\n</html>\n","source":"404.html","raw":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\"\n        charset=\"utf-8\" homePageUrl=\"/\"\n        homePageName=\"\">\n</script>\n\n</body>\n</html>\n","date":"2017-08-14T03:05:22.000Z","updated":"2017-08-14T03:05:22.000Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"cjbjgf2360000v7e8pyfopiv1","content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"\">\n</script>\n\n</body>\n</html>\n","site":{"data":{}},"excerpt":"","more":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n  <meta name=\"robots\" content=\"all\">\n  <meta name=\"robots\" content=\"index,follow\">\n</head>\n<body>\n\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"\">\n</script>\n\n</body>\n</html>\n"},{"title":"","date":"2016-04-23T12:10:41.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: \ndate: 2016-04-23 20:10:41\ntype: \"categories\"\ncomments: false\n---\n","updated":"2017-08-14T03:05:22.000Z","path":"categories/index.html","layout":"page","_id":"cjbjgf24b0002v7e8j5h288e1","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"","date":"2016-04-23T12:05:07.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: \ndate: 2016-04-23 20:05:07\ntype: \"tags\"\ncomments: false\n---\n","updated":"2017-08-14T03:05:22.000Z","path":"tags/index.html","layout":"page","_id":"cjbjgf28s002ev7e8fuaq7cbk","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"MongoDB","date":"2016-11-01T05:21:18.000Z","_content":"\n\n> `feed`\n\n# MongoDB\n\n## \n\nMongoDB\n\n![replica-set-primary-with-secondary-and-arbiter](https://cloud.githubusercontent.com/assets/286882/15322892/e004e45c-1c71-11e6-8255-c938c1c8e12a.png)\n\n## \n\n`sharding`\n\n![shardreplica](https://cloud.githubusercontent.com/assets/286882/15322822/80d4167e-1c71-11e6-996d-725800dd5531.jpg)\n\n## \n\nFeedMongoDB ClusterMongoDB\n\n![multiple_cluster](https://cloud.githubusercontent.com/assets/286882/15310929/c702c694-1c27-11e6-9d4e-f4fbfa4a5abb.jpg)\n\n- MongoDB Cluster\n    - \n        - clusterfeed\n    - Feed\n        - collectionfeed\n        - collectionuser_id\n- MongoDB ClusterFeedMongoDB Cluster\n- MongoDB Cluster\n\n# Feed DB\n\n`metadata`\n\n```json\n{\n    \"_id\": \"cluster_1\",\n    \"name\": \"cluster_1\",\n    \"start_date\": new Date(\"2016-05-01\"),\n    \"end_date\": new Date(\"2016-08-01\"),\n    \"creator_name\": \"ethan\",\n    \"created_at\": new Date(\"2016-05-01 00:00:00\")\n}\n```\n\n`feed`\n\n```json\n{\n    \"_id\": ObjectId(\"\"),\n    \"data_key\": \"e6755cfae343b6719cc2121e888b0a41\",\n    \"receiver_id\": 1000386,\n    \"sender_id\": 1000765,\n    \"event_time\": new Date(\"2016-05-01 10:00:00\"),\n    \"type\": 1,\n    \"data\": {\n        \"fabula_id\": 1000983\n    }\n}\n```\n\n`feed.data_key``feed`\n\n- `feed.data_key = MMH3Hash(\"fabula_\" + $fabulaId)`\n\n`feed._id`\n\n- `ObjectID``time`, `machine identifier`, `process id`, `counter``feed.event_time`\n- `ObjectID`: [https://github.com/go-mgo/mgo/blob/v2/bson/bson.go](https://github.com/go-mgo/mgo/blob/v2/bson/bson.go)\n\n# \n\n- [Feed](http://mp.weixin.qq.com/s?__biz=MzA5Nzc4OTA1Mw==&mid=2659597071&idx=1&sn=cd8df9f8c52dfbfb54e65adbe19fae27&scene=0#wechat_redirect)\n- [Feeds(Timeline)](http://www.tuicool.com/articles/BJRJja)\n- [feed](http://www.infoq.com/cn/presentations/feed-stream-architecture-in-big-data-era)\n- [Feed-](http://itindex.net/detail/52175-feed-%E6%9E%B6%E6%9E%84)\n- [Feed](http://timyang.net/data/feed-message-queue/)\n- [PinterestPinterestFeed](http://ju.outofmemory.cn/entry/223817)\n- [PinterestBuilding a smarter home feed](https://engineering.pinterest.com/blog/building-smarter-home-feed)\n- [PinterestBuilding a scalable and available home feed](https://engineering.pinterest.com/blog/building-scalable-and-available-home-feed)\n- [PinterestPinterest Smart Feed ](https://mp.weixin.qq.com/s?__biz=MzA4OTk5OTQzMg==&mid=2449231037&idx=1&sn=c2fc8a7d2832ea109e2abe4b773ff1f5&scene=1&srcid=0509fzQ02Jubcqnw7WPzp6IO)\n- [PinterestPinnability: Machine learning in the home feed](https://engineering.pinterest.com/blog/pinnability-machine-learning-home-feed)\n","source":"_posts/a-path-for-expand-mongodb-cluster.md","raw":"---\ntitle: MongoDB\ntags:\n  - mongodb\ncategories:\n  - \ndate: 2016-11-01 13:21:18\n---\n\n\n> `feed`\n\n# MongoDB\n\n## \n\nMongoDB\n\n![replica-set-primary-with-secondary-and-arbiter](https://cloud.githubusercontent.com/assets/286882/15322892/e004e45c-1c71-11e6-8255-c938c1c8e12a.png)\n\n## \n\n`sharding`\n\n![shardreplica](https://cloud.githubusercontent.com/assets/286882/15322822/80d4167e-1c71-11e6-996d-725800dd5531.jpg)\n\n## \n\nFeedMongoDB ClusterMongoDB\n\n![multiple_cluster](https://cloud.githubusercontent.com/assets/286882/15310929/c702c694-1c27-11e6-9d4e-f4fbfa4a5abb.jpg)\n\n- MongoDB Cluster\n    - \n        - clusterfeed\n    - Feed\n        - collectionfeed\n        - collectionuser_id\n- MongoDB ClusterFeedMongoDB Cluster\n- MongoDB Cluster\n\n# Feed DB\n\n`metadata`\n\n```json\n{\n    \"_id\": \"cluster_1\",\n    \"name\": \"cluster_1\",\n    \"start_date\": new Date(\"2016-05-01\"),\n    \"end_date\": new Date(\"2016-08-01\"),\n    \"creator_name\": \"ethan\",\n    \"created_at\": new Date(\"2016-05-01 00:00:00\")\n}\n```\n\n`feed`\n\n```json\n{\n    \"_id\": ObjectId(\"\"),\n    \"data_key\": \"e6755cfae343b6719cc2121e888b0a41\",\n    \"receiver_id\": 1000386,\n    \"sender_id\": 1000765,\n    \"event_time\": new Date(\"2016-05-01 10:00:00\"),\n    \"type\": 1,\n    \"data\": {\n        \"fabula_id\": 1000983\n    }\n}\n```\n\n`feed.data_key``feed`\n\n- `feed.data_key = MMH3Hash(\"fabula_\" + $fabulaId)`\n\n`feed._id`\n\n- `ObjectID``time`, `machine identifier`, `process id`, `counter``feed.event_time`\n- `ObjectID`: [https://github.com/go-mgo/mgo/blob/v2/bson/bson.go](https://github.com/go-mgo/mgo/blob/v2/bson/bson.go)\n\n# \n\n- [Feed](http://mp.weixin.qq.com/s?__biz=MzA5Nzc4OTA1Mw==&mid=2659597071&idx=1&sn=cd8df9f8c52dfbfb54e65adbe19fae27&scene=0#wechat_redirect)\n- [Feeds(Timeline)](http://www.tuicool.com/articles/BJRJja)\n- [feed](http://www.infoq.com/cn/presentations/feed-stream-architecture-in-big-data-era)\n- [Feed-](http://itindex.net/detail/52175-feed-%E6%9E%B6%E6%9E%84)\n- [Feed](http://timyang.net/data/feed-message-queue/)\n- [PinterestPinterestFeed](http://ju.outofmemory.cn/entry/223817)\n- [PinterestBuilding a smarter home feed](https://engineering.pinterest.com/blog/building-smarter-home-feed)\n- [PinterestBuilding a scalable and available home feed](https://engineering.pinterest.com/blog/building-scalable-and-available-home-feed)\n- [PinterestPinterest Smart Feed ](https://mp.weixin.qq.com/s?__biz=MzA4OTk5OTQzMg==&mid=2449231037&idx=1&sn=c2fc8a7d2832ea109e2abe4b773ff1f5&scene=1&srcid=0509fzQ02Jubcqnw7WPzp6IO)\n- [PinterestPinnability: Machine learning in the home feed](https://engineering.pinterest.com/blog/pinnability-machine-learning-home-feed)\n","slug":"a-path-for-expand-mongodb-cluster","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf2470001v7e8tqb9os2r","content":"<blockquote>\n<p><code>feed</code></p>\n</blockquote>\n<h1 id=\"MongoDB\"><a href=\"#MongoDB\" class=\"headerlink\" title=\"MongoDB\"></a>MongoDB</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>MongoDB</p>\n<p><img src=\"https://cloud.githubusercontent.com/assets/286882/15322892/e004e45c-1c71-11e6-8255-c938c1c8e12a.png\" alt=\"replica-set-primary-with-secondary-and-arbiter\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>sharding</code></p>\n<p><img src=\"https://cloud.githubusercontent.com/assets/286882/15322822/80d4167e-1c71-11e6-996d-725800dd5531.jpg\" alt=\"shardreplica\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>FeedMongoDB ClusterMongoDB</p>\n<p><img src=\"https://cloud.githubusercontent.com/assets/286882/15310929/c702c694-1c27-11e6-9d4e-f4fbfa4a5abb.jpg\" alt=\"multiple_cluster\"></p>\n<ul>\n<li>MongoDB Cluster<ul>\n<li><ul>\n<li>clusterfeed</li>\n</ul>\n</li>\n<li>Feed<ul>\n<li>collectionfeed</li>\n<li>collectionuser_id</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>MongoDB ClusterFeedMongoDB Cluster</li>\n<li>MongoDB Cluster</li>\n</ul>\n<h1 id=\"Feed-DB\"><a href=\"#Feed-DB\" class=\"headerlink\" title=\"Feed DB\"></a>Feed DB</h1><p><code>metadata</code></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"_id\"</span>: <span class=\"string\">\"cluster_1\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"cluster_1\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start_date\"</span>: new Date(<span class=\"string\">\"2016-05-01\"</span>),</span><br><span class=\"line\">    <span class=\"attr\">\"end_date\"</span>: new Date(<span class=\"string\">\"2016-08-01\"</span>),</span><br><span class=\"line\">    <span class=\"attr\">\"creator_name\"</span>: <span class=\"string\">\"ethan\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"created_at\"</span>: new Date(<span class=\"string\">\"2016-05-01 00:00:00\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>feed</code></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"_id\"</span>: ObjectId(<span class=\"string\">\"\"</span>),</span><br><span class=\"line\">    <span class=\"attr\">\"data_key\"</span>: <span class=\"string\">\"e6755cfae343b6719cc2121e888b0a41\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"receiver_id\"</span>: <span class=\"number\">1000386</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"sender_id\"</span>: <span class=\"number\">1000765</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"event_time\"</span>: new Date(<span class=\"string\">\"2016-05-01 10:00:00\"</span>),</span><br><span class=\"line\">    <span class=\"attr\">\"type\"</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"data\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"fabula_id\"</span>: <span class=\"number\">1000983</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>feed.data_key</code><code>feed</code></p>\n<ul>\n<li><code>feed.data_key = MMH3Hash(&quot;fabula_&quot; + $fabulaId)</code></li>\n</ul>\n<p><code>feed._id</code></p>\n<ul>\n<li><code>ObjectID</code><code>time</code>, <code>machine identifier</code>, <code>process id</code>, <code>counter</code><code>feed.event_time</code></li>\n<li><code>ObjectID</code>: <a href=\"https://github.com/go-mgo/mgo/blob/v2/bson/bson.go\" target=\"_blank\" rel=\"noopener\">https://github.com/go-mgo/mgo/blob/v2/bson/bson.go</a></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://mp.weixin.qq.com/s?__biz=MzA5Nzc4OTA1Mw==&amp;mid=2659597071&amp;idx=1&amp;sn=cd8df9f8c52dfbfb54e65adbe19fae27&amp;scene=0#wechat_redirect\" target=\"_blank\" rel=\"noopener\">Feed</a></li>\n<li><a href=\"http://www.tuicool.com/articles/BJRJja\" target=\"_blank\" rel=\"noopener\">Feeds(Timeline)</a></li>\n<li><a href=\"http://www.infoq.com/cn/presentations/feed-stream-architecture-in-big-data-era\" target=\"_blank\" rel=\"noopener\">feed</a></li>\n<li><a href=\"http://itindex.net/detail/52175-feed-%E6%9E%B6%E6%9E%84\" target=\"_blank\" rel=\"noopener\">Feed-</a></li>\n<li><a href=\"http://timyang.net/data/feed-message-queue/\" target=\"_blank\" rel=\"noopener\">Feed</a></li>\n<li><a href=\"http://ju.outofmemory.cn/entry/223817\" target=\"_blank\" rel=\"noopener\">PinterestPinterestFeed</a></li>\n<li><a href=\"https://engineering.pinterest.com/blog/building-smarter-home-feed\" target=\"_blank\" rel=\"noopener\">PinterestBuilding a smarter home feed</a></li>\n<li><a href=\"https://engineering.pinterest.com/blog/building-scalable-and-available-home-feed\" target=\"_blank\" rel=\"noopener\">PinterestBuilding a scalable and available home feed</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s?__biz=MzA4OTk5OTQzMg==&amp;mid=2449231037&amp;idx=1&amp;sn=c2fc8a7d2832ea109e2abe4b773ff1f5&amp;scene=1&amp;srcid=0509fzQ02Jubcqnw7WPzp6IO\" target=\"_blank\" rel=\"noopener\">PinterestPinterest  Smart Feed </a></li>\n<li><a href=\"https://engineering.pinterest.com/blog/pinnability-machine-learning-home-feed\" target=\"_blank\" rel=\"noopener\">PinterestPinnability: Machine learning in the home feed</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p><code>feed</code></p>\n</blockquote>\n<h1 id=\"MongoDB\"><a href=\"#MongoDB\" class=\"headerlink\" title=\"MongoDB\"></a>MongoDB</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>MongoDB</p>\n<p><img src=\"https://cloud.githubusercontent.com/assets/286882/15322892/e004e45c-1c71-11e6-8255-c938c1c8e12a.png\" alt=\"replica-set-primary-with-secondary-and-arbiter\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>sharding</code></p>\n<p><img src=\"https://cloud.githubusercontent.com/assets/286882/15322822/80d4167e-1c71-11e6-996d-725800dd5531.jpg\" alt=\"shardreplica\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>FeedMongoDB ClusterMongoDB</p>\n<p><img src=\"https://cloud.githubusercontent.com/assets/286882/15310929/c702c694-1c27-11e6-9d4e-f4fbfa4a5abb.jpg\" alt=\"multiple_cluster\"></p>\n<ul>\n<li>MongoDB Cluster<ul>\n<li><ul>\n<li>clusterfeed</li>\n</ul>\n</li>\n<li>Feed<ul>\n<li>collectionfeed</li>\n<li>collectionuser_id</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>MongoDB ClusterFeedMongoDB Cluster</li>\n<li>MongoDB Cluster</li>\n</ul>\n<h1 id=\"Feed-DB\"><a href=\"#Feed-DB\" class=\"headerlink\" title=\"Feed DB\"></a>Feed DB</h1><p><code>metadata</code></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"_id\"</span>: <span class=\"string\">\"cluster_1\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"cluster_1\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"start_date\"</span>: new Date(<span class=\"string\">\"2016-05-01\"</span>),</span><br><span class=\"line\">    <span class=\"attr\">\"end_date\"</span>: new Date(<span class=\"string\">\"2016-08-01\"</span>),</span><br><span class=\"line\">    <span class=\"attr\">\"creator_name\"</span>: <span class=\"string\">\"ethan\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"created_at\"</span>: new Date(<span class=\"string\">\"2016-05-01 00:00:00\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>feed</code></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"_id\"</span>: ObjectId(<span class=\"string\">\"\"</span>),</span><br><span class=\"line\">    <span class=\"attr\">\"data_key\"</span>: <span class=\"string\">\"e6755cfae343b6719cc2121e888b0a41\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"receiver_id\"</span>: <span class=\"number\">1000386</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"sender_id\"</span>: <span class=\"number\">1000765</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"event_time\"</span>: new Date(<span class=\"string\">\"2016-05-01 10:00:00\"</span>),</span><br><span class=\"line\">    <span class=\"attr\">\"type\"</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"data\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"fabula_id\"</span>: <span class=\"number\">1000983</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>feed.data_key</code><code>feed</code></p>\n<ul>\n<li><code>feed.data_key = MMH3Hash(&quot;fabula_&quot; + $fabulaId)</code></li>\n</ul>\n<p><code>feed._id</code></p>\n<ul>\n<li><code>ObjectID</code><code>time</code>, <code>machine identifier</code>, <code>process id</code>, <code>counter</code><code>feed.event_time</code></li>\n<li><code>ObjectID</code>: <a href=\"https://github.com/go-mgo/mgo/blob/v2/bson/bson.go\" target=\"_blank\" rel=\"noopener\">https://github.com/go-mgo/mgo/blob/v2/bson/bson.go</a></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://mp.weixin.qq.com/s?__biz=MzA5Nzc4OTA1Mw==&amp;mid=2659597071&amp;idx=1&amp;sn=cd8df9f8c52dfbfb54e65adbe19fae27&amp;scene=0#wechat_redirect\" target=\"_blank\" rel=\"noopener\">Feed</a></li>\n<li><a href=\"http://www.tuicool.com/articles/BJRJja\" target=\"_blank\" rel=\"noopener\">Feeds(Timeline)</a></li>\n<li><a href=\"http://www.infoq.com/cn/presentations/feed-stream-architecture-in-big-data-era\" target=\"_blank\" rel=\"noopener\">feed</a></li>\n<li><a href=\"http://itindex.net/detail/52175-feed-%E6%9E%B6%E6%9E%84\" target=\"_blank\" rel=\"noopener\">Feed-</a></li>\n<li><a href=\"http://timyang.net/data/feed-message-queue/\" target=\"_blank\" rel=\"noopener\">Feed</a></li>\n<li><a href=\"http://ju.outofmemory.cn/entry/223817\" target=\"_blank\" rel=\"noopener\">PinterestPinterestFeed</a></li>\n<li><a href=\"https://engineering.pinterest.com/blog/building-smarter-home-feed\" target=\"_blank\" rel=\"noopener\">PinterestBuilding a smarter home feed</a></li>\n<li><a href=\"https://engineering.pinterest.com/blog/building-scalable-and-available-home-feed\" target=\"_blank\" rel=\"noopener\">PinterestBuilding a scalable and available home feed</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s?__biz=MzA4OTk5OTQzMg==&amp;mid=2449231037&amp;idx=1&amp;sn=c2fc8a7d2832ea109e2abe4b773ff1f5&amp;scene=1&amp;srcid=0509fzQ02Jubcqnw7WPzp6IO\" target=\"_blank\" rel=\"noopener\">PinterestPinterest  Smart Feed </a></li>\n<li><a href=\"https://engineering.pinterest.com/blog/pinnability-machine-learning-home-feed\" target=\"_blank\" rel=\"noopener\">PinterestPinnability: Machine learning in the home feed</a></li>\n</ul>\n"},{"title":"Docker Swarm","_content":"\n# \n\n\n\nDocker Swarm\n\n\n\n# \n\n\n# \n\n\n# \n\n\n# \n\n\n# \n\n- Docker Engine\n  - Install Docker\n    - MacDocker: https://docs.docker.com/engine/installation/\n    - CentOSDocker Engine:\n      - https://docs.docker.com/engine/installation/linux/centos/\n      - https://docs.docker.com/v1.13/engine/installation/linux/centos/\n    - Config Registry Mirror: https://yq.aliyun.com/articles/29941\n  - User Guide\n    - Build and Manage Image\n      - Best Practices: https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/\n    - Network configuration\n      - Docker container networking: https://docs.docker.com/engine/userguide/networking/\n  - Admin Guide\n    - Limit a container's resources: https://docs.docker.com/engine/admin/resource_constraints/\n    - Logging: https://docs.docker.com/engine/admin/logging/view_container_logs/\n    - Using Ansible: https://docs.docker.com/engine/admin/ansible/\n    - Runtime Metrics: https://docs.docker.com/engine/admin/runmetrics/\n- Docker Registry\n  - https://docs.docker.com/v1.13/registry/deploying/\n  - https://hub.docker.com/r/h3nrik/registry-ldap-auth/\n  - https://github.com/kwk/docker-registry-setup\n  - \n    - http://www.akadia.com/services/ssh_test_certificate.html\n    - https://my.oschina.net/aiguozhe/blog/121764\n- Docker Swarm\n  - Guides - Manage a Swarm: https://docs.docker.com/engine/swarm/\n  - Superseded products and tools: https://docs.docker.com/swarm/overview/\n- Docker Compose\n  - Overview of Docker Compose: https://docs.docker.com/compose/overview/\n- Docker Machine\n  - Overview: https://docs.docker.com/machine/overview/\n- Docker Security\n","source":"_drafts/build-your-own-container-cluster-for-development-based-on-docker-swarm.md","raw":"---\ntitle: Docker Swarm\ntags:\n  - docker\ncategories:\n  - \n---\n\n# \n\n\n\nDocker Swarm\n\n\n\n# \n\n\n# \n\n\n# \n\n\n# \n\n\n# \n\n- Docker Engine\n  - Install Docker\n    - MacDocker: https://docs.docker.com/engine/installation/\n    - CentOSDocker Engine:\n      - https://docs.docker.com/engine/installation/linux/centos/\n      - https://docs.docker.com/v1.13/engine/installation/linux/centos/\n    - Config Registry Mirror: https://yq.aliyun.com/articles/29941\n  - User Guide\n    - Build and Manage Image\n      - Best Practices: https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/\n    - Network configuration\n      - Docker container networking: https://docs.docker.com/engine/userguide/networking/\n  - Admin Guide\n    - Limit a container's resources: https://docs.docker.com/engine/admin/resource_constraints/\n    - Logging: https://docs.docker.com/engine/admin/logging/view_container_logs/\n    - Using Ansible: https://docs.docker.com/engine/admin/ansible/\n    - Runtime Metrics: https://docs.docker.com/engine/admin/runmetrics/\n- Docker Registry\n  - https://docs.docker.com/v1.13/registry/deploying/\n  - https://hub.docker.com/r/h3nrik/registry-ldap-auth/\n  - https://github.com/kwk/docker-registry-setup\n  - \n    - http://www.akadia.com/services/ssh_test_certificate.html\n    - https://my.oschina.net/aiguozhe/blog/121764\n- Docker Swarm\n  - Guides - Manage a Swarm: https://docs.docker.com/engine/swarm/\n  - Superseded products and tools: https://docs.docker.com/swarm/overview/\n- Docker Compose\n  - Overview of Docker Compose: https://docs.docker.com/compose/overview/\n- Docker Machine\n  - Overview: https://docs.docker.com/machine/overview/\n- Docker Security\n","slug":"build-your-own-container-cluster-for-development-based-on-docker-swarm","published":0,"date":"2017-08-14T03:05:22.000Z","updated":"2017-11-18T10:24:14.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24b0003v7e8fl9j23vt","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>Docker Swarm</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>Docker Engine<ul>\n<li>Install Docker<ul>\n<li>MacDocker: <a href=\"https://docs.docker.com/engine/installation/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/installation/</a></li>\n<li>CentOSDocker Engine:<ul>\n<li><a href=\"https://docs.docker.com/engine/installation/linux/centos/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/installation/linux/centos/</a></li>\n<li><a href=\"https://docs.docker.com/v1.13/engine/installation/linux/centos/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/v1.13/engine/installation/linux/centos/</a></li>\n</ul>\n</li>\n<li>Config Registry Mirror: <a href=\"https://yq.aliyun.com/articles/29941\" target=\"_blank\" rel=\"noopener\">https://yq.aliyun.com/articles/29941</a></li>\n</ul>\n</li>\n<li>User Guide<ul>\n<li>Build and Manage Image<ul>\n<li>Best Practices: <a href=\"https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/</a></li>\n</ul>\n</li>\n<li>Network configuration<ul>\n<li>Docker container networking: <a href=\"https://docs.docker.com/engine/userguide/networking/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/userguide/networking/</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Admin Guide<ul>\n<li>Limit a containers resources: <a href=\"https://docs.docker.com/engine/admin/resource_constraints/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/admin/resource_constraints/</a></li>\n<li>Logging: <a href=\"https://docs.docker.com/engine/admin/logging/view_container_logs/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/admin/logging/view_container_logs/</a></li>\n<li>Using Ansible: <a href=\"https://docs.docker.com/engine/admin/ansible/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/admin/ansible/</a></li>\n<li>Runtime Metrics: <a href=\"https://docs.docker.com/engine/admin/runmetrics/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/admin/runmetrics/</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Docker Registry<ul>\n<li><a href=\"https://docs.docker.com/v1.13/registry/deploying/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/v1.13/registry/deploying/</a></li>\n<li><a href=\"https://hub.docker.com/r/h3nrik/registry-ldap-auth/\" target=\"_blank\" rel=\"noopener\">https://hub.docker.com/r/h3nrik/registry-ldap-auth/</a></li>\n<li><a href=\"https://github.com/kwk/docker-registry-setup\" target=\"_blank\" rel=\"noopener\">https://github.com/kwk/docker-registry-setup</a></li>\n<li><ul>\n<li><a href=\"http://www.akadia.com/services/ssh_test_certificate.html\" target=\"_blank\" rel=\"noopener\">http://www.akadia.com/services/ssh_test_certificate.html</a></li>\n<li><a href=\"https://my.oschina.net/aiguozhe/blog/121764\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/aiguozhe/blog/121764</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Docker Swarm<ul>\n<li>Guides - Manage a Swarm: <a href=\"https://docs.docker.com/engine/swarm/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/swarm/</a></li>\n<li>Superseded products and tools: <a href=\"https://docs.docker.com/swarm/overview/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/swarm/overview/</a></li>\n</ul>\n</li>\n<li>Docker Compose<ul>\n<li>Overview of Docker Compose: <a href=\"https://docs.docker.com/compose/overview/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/compose/overview/</a></li>\n</ul>\n</li>\n<li>Docker Machine<ul>\n<li>Overview: <a href=\"https://docs.docker.com/machine/overview/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/machine/overview/</a></li>\n</ul>\n</li>\n<li>Docker Security</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>Docker Swarm</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>Docker Engine<ul>\n<li>Install Docker<ul>\n<li>MacDocker: <a href=\"https://docs.docker.com/engine/installation/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/installation/</a></li>\n<li>CentOSDocker Engine:<ul>\n<li><a href=\"https://docs.docker.com/engine/installation/linux/centos/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/installation/linux/centos/</a></li>\n<li><a href=\"https://docs.docker.com/v1.13/engine/installation/linux/centos/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/v1.13/engine/installation/linux/centos/</a></li>\n</ul>\n</li>\n<li>Config Registry Mirror: <a href=\"https://yq.aliyun.com/articles/29941\" target=\"_blank\" rel=\"noopener\">https://yq.aliyun.com/articles/29941</a></li>\n</ul>\n</li>\n<li>User Guide<ul>\n<li>Build and Manage Image<ul>\n<li>Best Practices: <a href=\"https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/</a></li>\n</ul>\n</li>\n<li>Network configuration<ul>\n<li>Docker container networking: <a href=\"https://docs.docker.com/engine/userguide/networking/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/userguide/networking/</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Admin Guide<ul>\n<li>Limit a containers resources: <a href=\"https://docs.docker.com/engine/admin/resource_constraints/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/admin/resource_constraints/</a></li>\n<li>Logging: <a href=\"https://docs.docker.com/engine/admin/logging/view_container_logs/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/admin/logging/view_container_logs/</a></li>\n<li>Using Ansible: <a href=\"https://docs.docker.com/engine/admin/ansible/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/admin/ansible/</a></li>\n<li>Runtime Metrics: <a href=\"https://docs.docker.com/engine/admin/runmetrics/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/admin/runmetrics/</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Docker Registry<ul>\n<li><a href=\"https://docs.docker.com/v1.13/registry/deploying/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/v1.13/registry/deploying/</a></li>\n<li><a href=\"https://hub.docker.com/r/h3nrik/registry-ldap-auth/\" target=\"_blank\" rel=\"noopener\">https://hub.docker.com/r/h3nrik/registry-ldap-auth/</a></li>\n<li><a href=\"https://github.com/kwk/docker-registry-setup\" target=\"_blank\" rel=\"noopener\">https://github.com/kwk/docker-registry-setup</a></li>\n<li><ul>\n<li><a href=\"http://www.akadia.com/services/ssh_test_certificate.html\" target=\"_blank\" rel=\"noopener\">http://www.akadia.com/services/ssh_test_certificate.html</a></li>\n<li><a href=\"https://my.oschina.net/aiguozhe/blog/121764\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/aiguozhe/blog/121764</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Docker Swarm<ul>\n<li>Guides - Manage a Swarm: <a href=\"https://docs.docker.com/engine/swarm/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/swarm/</a></li>\n<li>Superseded products and tools: <a href=\"https://docs.docker.com/swarm/overview/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/swarm/overview/</a></li>\n</ul>\n</li>\n<li>Docker Compose<ul>\n<li>Overview of Docker Compose: <a href=\"https://docs.docker.com/compose/overview/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/compose/overview/</a></li>\n</ul>\n</li>\n<li>Docker Machine<ul>\n<li>Overview: <a href=\"https://docs.docker.com/machine/overview/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/machine/overview/</a></li>\n</ul>\n</li>\n<li>Docker Security</li>\n</ul>\n"},{"title":"GoError Handling in Go","_content":"\n\n{% asset_img d2a2d12e1a00f819d7fd7af4b536efa2.png %}\n\n# \n\n`Go``Java``C#``try...catch`\n\n\n# Go\n\n`error``interface`:\n\n```go\ntype error interface {\n    Error() string\n}\n```\n\n`error`:\n\n```go\n// example 1\nfunc Sqrt(f float64) (float64, error) {\n    if f < 0 {\n        return 0, errors.New(\"math: square root of negative number\")\n    }\n    // implementation\n}\n\n// example 2\nif f < 0 {\n    return 0, fmt.Errorf(\"math: square root of negative number %g\", f)\n}\n```\n\n`error`:\n\n```go\n// errorString is a trivial implementation of error.\ntype errorString struct {\n    s string\n}\n\nfunc (e *errorString) Error() string {\n    return e.s\n}\n```\n\n`error``net.Error`\n\n```go\npackage net\n\ntype Error interface {\n    error\n    Timeout() bool   // Is the error a timeout?\n    Temporary() bool // Is the error temporary?\n}\n```\n\n\n\n```go\nif nerr, ok := err.(net.Error); ok && nerr.Temporary() {\n    time.Sleep(1e9)\n    continue\n}\nif err != nil {\n    log.Fatal(err)\n}\n```\n\n# \n\ngo\n\n- \n- \n- \n- stack strace\n\n`Go``Go`\n\n> [Dave Cheney ](https://dave.cheney.net/paste/gocon-spring-2016.pdf)\n\n\n## Go\n\n`go`\n\n- `func`\n- \n- \n\n\n### \n\n[C Error Codes in Linux](http://www.virtsync.com/c-error-codes-include-errno)\n\ngo\n\n- `io.EOF`: [](https://github.com/golang/go/blob/master/src/io/io.go#L38)\n- `syscall.ENOENT`: [](https://github.com/golang/go/blob/master/src/syscall/zerrors_linux_amd64.go#L1280)\n- `go/build.NoGoError`: [](https://github.com/golang/go/blob/master/src/go/build/build.go#L446)\n- `path/filepath.SkipDir`: [](https://github.com/golang/go/blob/master/src/path/filepath/path.go#L331)\n\n\n\n```go\nbuf := make([]byte, 100)\nn, err := r.Read(buf)   //  r.Read error io.END io.EOF r.Read \nbuf = buf[:n]\nif err == io.EOF {\n    log.Fatal(\"read failed:\", err)\n}\n```\n\n`Error`\n\n```go\nfunc readfile(path string) error {\n    err := openfile(path)\n    if err != nil {\n        return fmt.Errorf(\"cannot open file: %v\", err)\n    }\n    //...\n}\n\nfunc main() {\n    err := readfile(\".bashrc\")\n    if strings.Contains(error.Error(), \"not found\") {\n        // handle error\n    }\n}\n```\n\n> **`error` interface  `Error` `Error``Error`**\n\nAPI`public`\n\n\n\n\n### \n\n\n\n```go\n// \ntype MyError struct {\n    Msg string\n    File string\n    Line int\n}\n\nfunc (e *MyError) Error() string {\n    return fmt.Sprintf(\"%s:%d: %s\", e.File, e.Line, e.Msg)\n}\n\n\n// \nfunc doSomething() {\n    // do something\n    return &MyError{\"Something happened\", \"server.go\", 42}\n}\n\n// \nerr := doSomething()\nif err, ok := err.(SomeType); ok {    //   \n    //...\n}\n```\n\n  `os.PathError`\n\n```go\n// PathError records an error and the operation\n// and file path that caused it.\ntype PathError struct {\n    Op string\n    Path string\n    Err error\n}\n\nfunc (e *PathError) Error() string\n```\n\n\n\n\n### \n\n\n\n**** \n\n```go\nimport github.com/quux/bar\n\nfunc fn() error {\n    x, err := bar.Foo()\n    if err != nil {\n        return err\n    }\n    // use x\n}\n```\n\n`Foo``Foo``Foo`\n\n\n## \n\n\n\n- `stack trace`\n- \n    - \n    - \n\n\n### \n\n```go\nfunc AuthenticateRequest(r *Request) error {\n    err := authenticate(r.User)\n    if err != nil {\n        return err  // No such file or directory\n    }\n    return nil\n}\n```\n\n\"No such file or directory\"\n\n\n\n```go\nfunc AuthenticateRequest(r *Request) error {\n    err := authenticate(r.User)\n    if err != nil {\n        return fmt.Errorf(\"authenticate failed: %v\", err)    // authenticate failed: No such file or directory\n    }\n    return nil\n}\n```\n\n`fmt.Errorf`\n\n`github.com/pkg/errors`API\n\n```go\n// Wrap annotates cause with a message.\nfunc Wrap(cause error, message string) error\n\n// Cause unwraps an annotated error.\nfunc Cause(err error) error\n```\n\n[goErrorHandlingSample](https://github.com/EthanCai/goErrorHandlingSample)repo\n\n```sh\n> go run sample1/main.go\n\nopen /Users/caichengyang/.settings.xml: no such file or directory\nexit status 1\n```\n\n```sh\n> go run sample2/main.go\n\ncould not read config: open failed: open /Users/caichengyang/.settings.xml: no such file or directory\nexit status 1\n```\n\n```sh\n> go run sample3/main.go\n\ncould not read config: open failed: open /Users/caichengyang/.settings.xml: no such file or directory\nexit status 1\n```\n\n```sh\n> go run sample4/main.go\n\nopen /Users/caichengyang/.settings.xml: no such file or directory\nopen failed\nmain.ReadFile\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:15\nmain.ReadConfig\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:27\nmain.main\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:32\nruntime.main\n        /usr/local/Cellar/go/1.9.2/libexec/src/runtime/proc.go:195\nruntime.goexit\n        /usr/local/Cellar/go/1.9.2/libexec/src/runtime/asm_amd64.s:2337\ncould not read config\nmain.ReadConfig\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:28\nmain.main\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:32\nruntime.main\n        /usr/local/Cellar/go/1.9.2/libexec/src/runtime/proc.go:195\nruntime.goexit\n        /usr/local/Cellar/go/1.9.2/libexec/src/runtime/asm_amd64.s:2337\nexit status 1\n\n```\n\n`sample4/main.go`\n\n\n### \n\n\n\n\n\n```go\ntype temporary interface {\n    Temporary() bool    // IsTemporary returns true if err is temporary.\n}\n\nfunc IsTemporary(err error) bool {\n    te, ok := err.(temporary)\n    return ok && te.Temporary()\n}\n```\n\n`package``error``error``package`\n\n\n\n\n### \n\n\n\n```go\nfunc Write(w io.Writer, buf []byte) {\n    w.Write(buf)    // Write(p []byte) (n int, err error)Write https://golang.org/pkg/io/#Writer\n}\n```\n\n\n\n```go\nfunc Write(w io.Writer, buf []byte) error {\n    _, err := w.Write(buf)\n    if err != nil {\n        log.Println(\"unable to write:\", err)    // 1\n\n        return err\n    }\n    return nil\n}\n\nfunc main() {\n    // create writer and read data into buf\n\n    err := Write(w, buf)\n    if err != nil {\n        log.Println(\"Write error:\", err)        // 2\n        os.Exit(1)\n    }\n\n    os.Exit(0)\n}\n```\n\n# \n\n- \n    - `errors.Wrap``error`\n    - `errors.Cause``error`\n- \n- \n\n\n# \n\n- The Go Blog\n    - [Error handling in Go](https://blog.golang.org/error-handling-and-go)\n    - [Defer, Panic, and Recover](https://blog.golang.org/defer-panic-and-recover)\n- Dave Cheney\n    - [presentation on my philosophy for error handling](https://dave.cheney.net/paste/gocon-spring-2016.pdf)\n    - [Dont just check errors, handle them gracefully](https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully)\n    - [Stack traces and the errors package](https://dave.cheney.net/2016/06/12/stack-traces-and-the-errors-package)\n- Go Packages\n    - [errors](https://golang.org/pkg/errors/)\n    - [runtime](https://golang.org/pkg/runtime/)\n- pkg: Artisanal, hand crafted, barrel aged, Go packages\n    - [github.com/pkg/errors](https://godoc.org/github.com/pkg/errors)\n","source":"_drafts/Error-Handling-in-Go.md","raw":"---\ntitle: GoError Handling in Go\ntags:\n  - coding\n  - go\ncategories:\n  - \n---\n\n\n{% asset_img d2a2d12e1a00f819d7fd7af4b536efa2.png %}\n\n# \n\n`Go``Java``C#``try...catch`\n\n\n# Go\n\n`error``interface`:\n\n```go\ntype error interface {\n    Error() string\n}\n```\n\n`error`:\n\n```go\n// example 1\nfunc Sqrt(f float64) (float64, error) {\n    if f < 0 {\n        return 0, errors.New(\"math: square root of negative number\")\n    }\n    // implementation\n}\n\n// example 2\nif f < 0 {\n    return 0, fmt.Errorf(\"math: square root of negative number %g\", f)\n}\n```\n\n`error`:\n\n```go\n// errorString is a trivial implementation of error.\ntype errorString struct {\n    s string\n}\n\nfunc (e *errorString) Error() string {\n    return e.s\n}\n```\n\n`error``net.Error`\n\n```go\npackage net\n\ntype Error interface {\n    error\n    Timeout() bool   // Is the error a timeout?\n    Temporary() bool // Is the error temporary?\n}\n```\n\n\n\n```go\nif nerr, ok := err.(net.Error); ok && nerr.Temporary() {\n    time.Sleep(1e9)\n    continue\n}\nif err != nil {\n    log.Fatal(err)\n}\n```\n\n# \n\ngo\n\n- \n- \n- \n- stack strace\n\n`Go``Go`\n\n> [Dave Cheney ](https://dave.cheney.net/paste/gocon-spring-2016.pdf)\n\n\n## Go\n\n`go`\n\n- `func`\n- \n- \n\n\n### \n\n[C Error Codes in Linux](http://www.virtsync.com/c-error-codes-include-errno)\n\ngo\n\n- `io.EOF`: [](https://github.com/golang/go/blob/master/src/io/io.go#L38)\n- `syscall.ENOENT`: [](https://github.com/golang/go/blob/master/src/syscall/zerrors_linux_amd64.go#L1280)\n- `go/build.NoGoError`: [](https://github.com/golang/go/blob/master/src/go/build/build.go#L446)\n- `path/filepath.SkipDir`: [](https://github.com/golang/go/blob/master/src/path/filepath/path.go#L331)\n\n\n\n```go\nbuf := make([]byte, 100)\nn, err := r.Read(buf)   //  r.Read error io.END io.EOF r.Read \nbuf = buf[:n]\nif err == io.EOF {\n    log.Fatal(\"read failed:\", err)\n}\n```\n\n`Error`\n\n```go\nfunc readfile(path string) error {\n    err := openfile(path)\n    if err != nil {\n        return fmt.Errorf(\"cannot open file: %v\", err)\n    }\n    //...\n}\n\nfunc main() {\n    err := readfile(\".bashrc\")\n    if strings.Contains(error.Error(), \"not found\") {\n        // handle error\n    }\n}\n```\n\n> **`error` interface  `Error` `Error``Error`**\n\nAPI`public`\n\n\n\n\n### \n\n\n\n```go\n// \ntype MyError struct {\n    Msg string\n    File string\n    Line int\n}\n\nfunc (e *MyError) Error() string {\n    return fmt.Sprintf(\"%s:%d: %s\", e.File, e.Line, e.Msg)\n}\n\n\n// \nfunc doSomething() {\n    // do something\n    return &MyError{\"Something happened\", \"server.go\", 42}\n}\n\n// \nerr := doSomething()\nif err, ok := err.(SomeType); ok {    //   \n    //...\n}\n```\n\n  `os.PathError`\n\n```go\n// PathError records an error and the operation\n// and file path that caused it.\ntype PathError struct {\n    Op string\n    Path string\n    Err error\n}\n\nfunc (e *PathError) Error() string\n```\n\n\n\n\n### \n\n\n\n**** \n\n```go\nimport github.com/quux/bar\n\nfunc fn() error {\n    x, err := bar.Foo()\n    if err != nil {\n        return err\n    }\n    // use x\n}\n```\n\n`Foo``Foo``Foo`\n\n\n## \n\n\n\n- `stack trace`\n- \n    - \n    - \n\n\n### \n\n```go\nfunc AuthenticateRequest(r *Request) error {\n    err := authenticate(r.User)\n    if err != nil {\n        return err  // No such file or directory\n    }\n    return nil\n}\n```\n\n\"No such file or directory\"\n\n\n\n```go\nfunc AuthenticateRequest(r *Request) error {\n    err := authenticate(r.User)\n    if err != nil {\n        return fmt.Errorf(\"authenticate failed: %v\", err)    // authenticate failed: No such file or directory\n    }\n    return nil\n}\n```\n\n`fmt.Errorf`\n\n`github.com/pkg/errors`API\n\n```go\n// Wrap annotates cause with a message.\nfunc Wrap(cause error, message string) error\n\n// Cause unwraps an annotated error.\nfunc Cause(err error) error\n```\n\n[goErrorHandlingSample](https://github.com/EthanCai/goErrorHandlingSample)repo\n\n```sh\n> go run sample1/main.go\n\nopen /Users/caichengyang/.settings.xml: no such file or directory\nexit status 1\n```\n\n```sh\n> go run sample2/main.go\n\ncould not read config: open failed: open /Users/caichengyang/.settings.xml: no such file or directory\nexit status 1\n```\n\n```sh\n> go run sample3/main.go\n\ncould not read config: open failed: open /Users/caichengyang/.settings.xml: no such file or directory\nexit status 1\n```\n\n```sh\n> go run sample4/main.go\n\nopen /Users/caichengyang/.settings.xml: no such file or directory\nopen failed\nmain.ReadFile\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:15\nmain.ReadConfig\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:27\nmain.main\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:32\nruntime.main\n        /usr/local/Cellar/go/1.9.2/libexec/src/runtime/proc.go:195\nruntime.goexit\n        /usr/local/Cellar/go/1.9.2/libexec/src/runtime/asm_amd64.s:2337\ncould not read config\nmain.ReadConfig\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:28\nmain.main\n        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:32\nruntime.main\n        /usr/local/Cellar/go/1.9.2/libexec/src/runtime/proc.go:195\nruntime.goexit\n        /usr/local/Cellar/go/1.9.2/libexec/src/runtime/asm_amd64.s:2337\nexit status 1\n\n```\n\n`sample4/main.go`\n\n\n### \n\n\n\n\n\n```go\ntype temporary interface {\n    Temporary() bool    // IsTemporary returns true if err is temporary.\n}\n\nfunc IsTemporary(err error) bool {\n    te, ok := err.(temporary)\n    return ok && te.Temporary()\n}\n```\n\n`package``error``error``package`\n\n\n\n\n### \n\n\n\n```go\nfunc Write(w io.Writer, buf []byte) {\n    w.Write(buf)    // Write(p []byte) (n int, err error)Write https://golang.org/pkg/io/#Writer\n}\n```\n\n\n\n```go\nfunc Write(w io.Writer, buf []byte) error {\n    _, err := w.Write(buf)\n    if err != nil {\n        log.Println(\"unable to write:\", err)    // 1\n\n        return err\n    }\n    return nil\n}\n\nfunc main() {\n    // create writer and read data into buf\n\n    err := Write(w, buf)\n    if err != nil {\n        log.Println(\"Write error:\", err)        // 2\n        os.Exit(1)\n    }\n\n    os.Exit(0)\n}\n```\n\n# \n\n- \n    - `errors.Wrap``error`\n    - `errors.Cause``error`\n- \n- \n\n\n# \n\n- The Go Blog\n    - [Error handling in Go](https://blog.golang.org/error-handling-and-go)\n    - [Defer, Panic, and Recover](https://blog.golang.org/defer-panic-and-recover)\n- Dave Cheney\n    - [presentation on my philosophy for error handling](https://dave.cheney.net/paste/gocon-spring-2016.pdf)\n    - [Dont just check errors, handle them gracefully](https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully)\n    - [Stack traces and the errors package](https://dave.cheney.net/2016/06/12/stack-traces-and-the-errors-package)\n- Go Packages\n    - [errors](https://golang.org/pkg/errors/)\n    - [runtime](https://golang.org/pkg/runtime/)\n- pkg: Artisanal, hand crafted, barrel aged, Go packages\n    - [github.com/pkg/errors](https://godoc.org/github.com/pkg/errors)\n","slug":"Error-Handling-in-Go","published":0,"date":"2017-12-17T03:53:06.000Z","updated":"2017-12-28T16:11:31.000Z","_id":"cjbjgf24g0006v7e81cgx4byq","comments":1,"layout":"post","photos":[],"link":"","content":"<img src=\"/2017/12/17/Error-Handling-in-Go/d2a2d12e1a00f819d7fd7af4b536efa2.png\">\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>Go</code><code>Java</code><code>C#</code><code>try...catch</code></p>\n<h1 id=\"Go\"><a href=\"#Go\" class=\"headerlink\" title=\"Go\"></a>Go</h1><p><code>error</code><code>interface</code>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> error <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Error() <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>error</code>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// example 1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sqrt</span><span class=\"params\">(f <span class=\"keyword\">float64</span>)</span> <span class=\"params\">(<span class=\"keyword\">float64</span>, error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> f &lt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>, errors.New(<span class=\"string\">\"math: square root of negative number\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// implementation</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// example 2</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> f &lt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>, fmt.Errorf(<span class=\"string\">\"math: square root of negative number %g\"</span>, f)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>error</code>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// errorString is a trivial implementation of error.</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> errorString <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    s <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(e *errorString)</span> <span class=\"title\">Error</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> e.s</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>error</code><code>net.Error</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> net</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Error <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    error</span><br><span class=\"line\">    Timeout() <span class=\"keyword\">bool</span>   <span class=\"comment\">// Is the error a timeout?</span></span><br><span class=\"line\">    Temporary() <span class=\"keyword\">bool</span> <span class=\"comment\">// Is the error temporary?</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> nerr, ok := err.(net.Error); ok &amp;&amp; nerr.Temporary() &#123;</span><br><span class=\"line\">    time.Sleep(<span class=\"number\">1e9</span>)</span><br><span class=\"line\">    <span class=\"keyword\">continue</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    log.Fatal(err)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>go</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li>stack strace</li>\n</ul>\n<p><code>Go</code><code>Go</code></p>\n<blockquote>\n<p><a href=\"https://dave.cheney.net/paste/gocon-spring-2016.pdf\" target=\"_blank\" rel=\"noopener\">Dave Cheney </a></p>\n</blockquote>\n<h2 id=\"Go\"><a href=\"#Go\" class=\"headerlink\" title=\"Go\"></a>Go</h2><p><code>go</code></p>\n<ul>\n<li><code>func</code></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://www.virtsync.com/c-error-codes-include-errno\" target=\"_blank\" rel=\"noopener\">C Error Codes in Linux</a></p>\n<p>go</p>\n<ul>\n<li><code>io.EOF</code>: <a href=\"https://github.com/golang/go/blob/master/src/io/io.go#L38\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><code>syscall.ENOENT</code>: <a href=\"https://github.com/golang/go/blob/master/src/syscall/zerrors_linux_amd64.go#L1280\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><code>go/build.NoGoError</code>: <a href=\"https://github.com/golang/go/blob/master/src/go/build/build.go#L446\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><code>path/filepath.SkipDir</code>: <a href=\"https://github.com/golang/go/blob/master/src/path/filepath/path.go#L331\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">buf := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">100</span>)</span><br><span class=\"line\">n, err := r.Read(buf)   <span class=\"comment\">//  r.Read error io.END io.EOF r.Read </span></span><br><span class=\"line\">buf = buf[:n]</span><br><span class=\"line\"><span class=\"keyword\">if</span> err == io.EOF &#123;</span><br><span class=\"line\">    log.Fatal(<span class=\"string\">\"read failed:\"</span>, err)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Error</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">readfile</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    err := openfile(path)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fmt.Errorf(<span class=\"string\">\"cannot open file: %v\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    err := readfile(<span class=\"string\">\".bashrc\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> strings.Contains(error.Error(), <span class=\"string\">\"not found\"</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle error</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><strong><code>error</code> interface  <code>Error</code> <code>Error</code><code>Error</code></strong></p>\n</blockquote>\n<p>API<code>public</code></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> MyError <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Msg <span class=\"keyword\">string</span></span><br><span class=\"line\">    File <span class=\"keyword\">string</span></span><br><span class=\"line\">    Line <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(e *MyError)</span> <span class=\"title\">Error</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fmt.Sprintf(<span class=\"string\">\"%s:%d: %s\"</span>, e.File, e.Line, e.Msg)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> &amp;MyError&#123;<span class=\"string\">\"Something happened\"</span>, <span class=\"string\">\"server.go\"</span>, <span class=\"number\">42</span>&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">err := doSomething()</span><br><span class=\"line\"><span class=\"keyword\">if</span> err, ok := err.(SomeType); ok &#123;    <span class=\"comment\">//   </span></span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>  <code>os.PathError</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// PathError records an error and the operation</span></span><br><span class=\"line\"><span class=\"comment\">// and file path that caused it.</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PathError <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Op <span class=\"keyword\">string</span></span><br><span class=\"line\">    Path <span class=\"keyword\">string</span></span><br><span class=\"line\">    Err error</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(e *PathError)</span> <span class=\"title\">Error</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><strong></strong> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> github.com/quux/bar</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">fn</span><span class=\"params\">()</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    x, err := bar.Foo()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// use x</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Foo</code><code>Foo</code><code>Foo</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li><code>stack trace</code></li>\n<li><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AuthenticateRequest</span><span class=\"params\">(r *Request)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    err := authenticate(r.User)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err  <span class=\"comment\">// No such file or directory</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>No such file or directory</p>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AuthenticateRequest</span><span class=\"params\">(r *Request)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    err := authenticate(r.User)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fmt.Errorf(<span class=\"string\">\"authenticate failed: %v\"</span>, err)    <span class=\"comment\">// authenticate failed: No such file or directory</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>fmt.Errorf</code></p>\n<p><code>github.com/pkg/errors</code>API</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Wrap annotates cause with a message.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Wrap</span><span class=\"params\">(cause error, message <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">// <span class=\"title\">Cause</span> <span class=\"title\">unwraps</span> <span class=\"title\">an</span> <span class=\"title\">annotated</span> <span class=\"title\">error</span>.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">func</span> <span class=\"title\">Cause</span><span class=\"params\">(err error)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/EthanCai/goErrorHandlingSample\" target=\"_blank\" rel=\"noopener\">goErrorHandlingSample</a>repo</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; go run sample1/main.go</span><br><span class=\"line\"></span><br><span class=\"line\">open /Users/caichengyang/.settings.xml: no such file or directory</span><br><span class=\"line\"><span class=\"built_in\">exit</span> status 1</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; go run sample2/main.go</span><br><span class=\"line\"></span><br><span class=\"line\">could not <span class=\"built_in\">read</span> config: open failed: open /Users/caichengyang/.settings.xml: no such file or directory</span><br><span class=\"line\"><span class=\"built_in\">exit</span> status 1</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; go run sample3/main.go</span><br><span class=\"line\"></span><br><span class=\"line\">could not <span class=\"built_in\">read</span> config: open failed: open /Users/caichengyang/.settings.xml: no such file or directory</span><br><span class=\"line\"><span class=\"built_in\">exit</span> status 1</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; go run sample4/main.go</span><br><span class=\"line\"></span><br><span class=\"line\">open /Users/caichengyang/.settings.xml: no such file or directory</span><br><span class=\"line\">open failed</span><br><span class=\"line\">main.ReadFile</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:15</span><br><span class=\"line\">main.ReadConfig</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:27</span><br><span class=\"line\">main.main</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:32</span><br><span class=\"line\">runtime.main</span><br><span class=\"line\">        /usr/<span class=\"built_in\">local</span>/Cellar/go/1.9.2/libexec/src/runtime/proc.go:195</span><br><span class=\"line\">runtime.goexit</span><br><span class=\"line\">        /usr/<span class=\"built_in\">local</span>/Cellar/go/1.9.2/libexec/src/runtime/asm_amd64.s:2337</span><br><span class=\"line\">could not <span class=\"built_in\">read</span> config</span><br><span class=\"line\">main.ReadConfig</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:28</span><br><span class=\"line\">main.main</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:32</span><br><span class=\"line\">runtime.main</span><br><span class=\"line\">        /usr/<span class=\"built_in\">local</span>/Cellar/go/1.9.2/libexec/src/runtime/proc.go:195</span><br><span class=\"line\">runtime.goexit</span><br><span class=\"line\">        /usr/<span class=\"built_in\">local</span>/Cellar/go/1.9.2/libexec/src/runtime/asm_amd64.s:2337</span><br><span class=\"line\"><span class=\"built_in\">exit</span> status 1</span><br></pre></td></tr></table></figure>\n<p><code>sample4/main.go</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> temporary <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Temporary() <span class=\"keyword\">bool</span>    <span class=\"comment\">// IsTemporary returns true if err is temporary.</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsTemporary</span><span class=\"params\">(err error)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">    te, ok := err.(temporary)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ok &amp;&amp; te.Temporary()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>package</code><code>error</code><code>error</code><code>package</code></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Write</span><span class=\"params\">(w io.Writer, buf []<span class=\"keyword\">byte</span>)</span></span> &#123;</span><br><span class=\"line\">    w.Write(buf)    <span class=\"comment\">// Write(p []byte) (n int, err error)Write https://golang.org/pkg/io/#Writer</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Write</span><span class=\"params\">(w io.Writer, buf []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    _, err := w.Write(buf)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Println(<span class=\"string\">\"unable to write:\"</span>, err)    <span class=\"comment\">// 1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> err</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// create writer and read data into buf</span></span><br><span class=\"line\"></span><br><span class=\"line\">    err := Write(w, buf)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Println(<span class=\"string\">\"Write error:\"</span>, err)        <span class=\"comment\">// 2</span></span><br><span class=\"line\">        os.Exit(<span class=\"number\">1</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    os.Exit(<span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><ul>\n<li><code>errors.Wrap</code><code>error</code></li>\n<li><code>errors.Cause</code><code>error</code></li>\n</ul>\n</li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>The Go Blog<ul>\n<li><a href=\"https://blog.golang.org/error-handling-and-go\" target=\"_blank\" rel=\"noopener\">Error handling in Go</a></li>\n<li><a href=\"https://blog.golang.org/defer-panic-and-recover\" target=\"_blank\" rel=\"noopener\">Defer, Panic, and Recover</a></li>\n</ul>\n</li>\n<li>Dave Cheney<ul>\n<li><a href=\"https://dave.cheney.net/paste/gocon-spring-2016.pdf\" target=\"_blank\" rel=\"noopener\">presentation on my philosophy for error handling</a></li>\n<li><a href=\"https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully\" target=\"_blank\" rel=\"noopener\">Dont just check errors, handle them gracefully</a></li>\n<li><a href=\"https://dave.cheney.net/2016/06/12/stack-traces-and-the-errors-package\" target=\"_blank\" rel=\"noopener\">Stack traces and the errors package</a></li>\n</ul>\n</li>\n<li>Go Packages<ul>\n<li><a href=\"https://golang.org/pkg/errors/\" target=\"_blank\" rel=\"noopener\">errors</a></li>\n<li><a href=\"https://golang.org/pkg/runtime/\" target=\"_blank\" rel=\"noopener\">runtime</a></li>\n</ul>\n</li>\n<li>pkg: Artisanal, hand crafted, barrel aged, Go packages<ul>\n<li><a href=\"https://godoc.org/github.com/pkg/errors\" target=\"_blank\" rel=\"noopener\">github.com/pkg/errors</a></li>\n</ul>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<img src=\"/2017/12/17/Error-Handling-in-Go/d2a2d12e1a00f819d7fd7af4b536efa2.png\">\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>Go</code><code>Java</code><code>C#</code><code>try...catch</code></p>\n<h1 id=\"Go\"><a href=\"#Go\" class=\"headerlink\" title=\"Go\"></a>Go</h1><p><code>error</code><code>interface</code>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> error <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Error() <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>error</code>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// example 1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Sqrt</span><span class=\"params\">(f <span class=\"keyword\">float64</span>)</span> <span class=\"params\">(<span class=\"keyword\">float64</span>, error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> f &lt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>, errors.New(<span class=\"string\">\"math: square root of negative number\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// implementation</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// example 2</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> f &lt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>, fmt.Errorf(<span class=\"string\">\"math: square root of negative number %g\"</span>, f)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>error</code>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// errorString is a trivial implementation of error.</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> errorString <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    s <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(e *errorString)</span> <span class=\"title\">Error</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> e.s</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>error</code><code>net.Error</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> net</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Error <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    error</span><br><span class=\"line\">    Timeout() <span class=\"keyword\">bool</span>   <span class=\"comment\">// Is the error a timeout?</span></span><br><span class=\"line\">    Temporary() <span class=\"keyword\">bool</span> <span class=\"comment\">// Is the error temporary?</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> nerr, ok := err.(net.Error); ok &amp;&amp; nerr.Temporary() &#123;</span><br><span class=\"line\">    time.Sleep(<span class=\"number\">1e9</span>)</span><br><span class=\"line\">    <span class=\"keyword\">continue</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    log.Fatal(err)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>go</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li>stack strace</li>\n</ul>\n<p><code>Go</code><code>Go</code></p>\n<blockquote>\n<p><a href=\"https://dave.cheney.net/paste/gocon-spring-2016.pdf\" target=\"_blank\" rel=\"noopener\">Dave Cheney </a></p>\n</blockquote>\n<h2 id=\"Go\"><a href=\"#Go\" class=\"headerlink\" title=\"Go\"></a>Go</h2><p><code>go</code></p>\n<ul>\n<li><code>func</code></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://www.virtsync.com/c-error-codes-include-errno\" target=\"_blank\" rel=\"noopener\">C Error Codes in Linux</a></p>\n<p>go</p>\n<ul>\n<li><code>io.EOF</code>: <a href=\"https://github.com/golang/go/blob/master/src/io/io.go#L38\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><code>syscall.ENOENT</code>: <a href=\"https://github.com/golang/go/blob/master/src/syscall/zerrors_linux_amd64.go#L1280\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><code>go/build.NoGoError</code>: <a href=\"https://github.com/golang/go/blob/master/src/go/build/build.go#L446\" target=\"_blank\" rel=\"noopener\"></a></li>\n<li><code>path/filepath.SkipDir</code>: <a href=\"https://github.com/golang/go/blob/master/src/path/filepath/path.go#L331\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">buf := <span class=\"built_in\">make</span>([]<span class=\"keyword\">byte</span>, <span class=\"number\">100</span>)</span><br><span class=\"line\">n, err := r.Read(buf)   <span class=\"comment\">//  r.Read error io.END io.EOF r.Read </span></span><br><span class=\"line\">buf = buf[:n]</span><br><span class=\"line\"><span class=\"keyword\">if</span> err == io.EOF &#123;</span><br><span class=\"line\">    log.Fatal(<span class=\"string\">\"read failed:\"</span>, err)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Error</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">readfile</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    err := openfile(path)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fmt.Errorf(<span class=\"string\">\"cannot open file: %v\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    err := readfile(<span class=\"string\">\".bashrc\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> strings.Contains(error.Error(), <span class=\"string\">\"not found\"</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle error</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><strong><code>error</code> interface  <code>Error</code> <code>Error</code><code>Error</code></strong></p>\n</blockquote>\n<p>API<code>public</code></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">type</span> MyError <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Msg <span class=\"keyword\">string</span></span><br><span class=\"line\">    File <span class=\"keyword\">string</span></span><br><span class=\"line\">    Line <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(e *MyError)</span> <span class=\"title\">Error</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fmt.Sprintf(<span class=\"string\">\"%s:%d: %s\"</span>, e.File, e.Line, e.Msg)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// do something</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> &amp;MyError&#123;<span class=\"string\">\"Something happened\"</span>, <span class=\"string\">\"server.go\"</span>, <span class=\"number\">42</span>&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">err := doSomething()</span><br><span class=\"line\"><span class=\"keyword\">if</span> err, ok := err.(SomeType); ok &#123;    <span class=\"comment\">//   </span></span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>  <code>os.PathError</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// PathError records an error and the operation</span></span><br><span class=\"line\"><span class=\"comment\">// and file path that caused it.</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> PathError <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Op <span class=\"keyword\">string</span></span><br><span class=\"line\">    Path <span class=\"keyword\">string</span></span><br><span class=\"line\">    Err error</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(e *PathError)</span> <span class=\"title\">Error</span><span class=\"params\">()</span> <span class=\"title\">string</span></span></span><br></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><strong></strong> </p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> github.com/quux/bar</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">fn</span><span class=\"params\">()</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    x, err := bar.Foo()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// use x</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Foo</code><code>Foo</code><code>Foo</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li><code>stack trace</code></li>\n<li><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AuthenticateRequest</span><span class=\"params\">(r *Request)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    err := authenticate(r.User)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err  <span class=\"comment\">// No such file or directory</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>No such file or directory</p>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">AuthenticateRequest</span><span class=\"params\">(r *Request)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    err := authenticate(r.User)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fmt.Errorf(<span class=\"string\">\"authenticate failed: %v\"</span>, err)    <span class=\"comment\">// authenticate failed: No such file or directory</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>fmt.Errorf</code></p>\n<p><code>github.com/pkg/errors</code>API</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Wrap annotates cause with a message.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Wrap</span><span class=\"params\">(cause error, message <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">// <span class=\"title\">Cause</span> <span class=\"title\">unwraps</span> <span class=\"title\">an</span> <span class=\"title\">annotated</span> <span class=\"title\">error</span>.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">func</span> <span class=\"title\">Cause</span><span class=\"params\">(err error)</span> <span class=\"title\">error</span></span></span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/EthanCai/goErrorHandlingSample\" target=\"_blank\" rel=\"noopener\">goErrorHandlingSample</a>repo</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; go run sample1/main.go</span><br><span class=\"line\"></span><br><span class=\"line\">open /Users/caichengyang/.settings.xml: no such file or directory</span><br><span class=\"line\"><span class=\"built_in\">exit</span> status 1</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; go run sample2/main.go</span><br><span class=\"line\"></span><br><span class=\"line\">could not <span class=\"built_in\">read</span> config: open failed: open /Users/caichengyang/.settings.xml: no such file or directory</span><br><span class=\"line\"><span class=\"built_in\">exit</span> status 1</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; go run sample3/main.go</span><br><span class=\"line\"></span><br><span class=\"line\">could not <span class=\"built_in\">read</span> config: open failed: open /Users/caichengyang/.settings.xml: no such file or directory</span><br><span class=\"line\"><span class=\"built_in\">exit</span> status 1</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; go run sample4/main.go</span><br><span class=\"line\"></span><br><span class=\"line\">open /Users/caichengyang/.settings.xml: no such file or directory</span><br><span class=\"line\">open failed</span><br><span class=\"line\">main.ReadFile</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:15</span><br><span class=\"line\">main.ReadConfig</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:27</span><br><span class=\"line\">main.main</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:32</span><br><span class=\"line\">runtime.main</span><br><span class=\"line\">        /usr/<span class=\"built_in\">local</span>/Cellar/go/1.9.2/libexec/src/runtime/proc.go:195</span><br><span class=\"line\">runtime.goexit</span><br><span class=\"line\">        /usr/<span class=\"built_in\">local</span>/Cellar/go/1.9.2/libexec/src/runtime/asm_amd64.s:2337</span><br><span class=\"line\">could not <span class=\"built_in\">read</span> config</span><br><span class=\"line\">main.ReadConfig</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:28</span><br><span class=\"line\">main.main</span><br><span class=\"line\">        /Users/caichengyang/go/src/github.com/ethancai/goErrorHandlingSample/sample4/main.go:32</span><br><span class=\"line\">runtime.main</span><br><span class=\"line\">        /usr/<span class=\"built_in\">local</span>/Cellar/go/1.9.2/libexec/src/runtime/proc.go:195</span><br><span class=\"line\">runtime.goexit</span><br><span class=\"line\">        /usr/<span class=\"built_in\">local</span>/Cellar/go/1.9.2/libexec/src/runtime/asm_amd64.s:2337</span><br><span class=\"line\"><span class=\"built_in\">exit</span> status 1</span><br></pre></td></tr></table></figure>\n<p><code>sample4/main.go</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> temporary <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    Temporary() <span class=\"keyword\">bool</span>    <span class=\"comment\">// IsTemporary returns true if err is temporary.</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">IsTemporary</span><span class=\"params\">(err error)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">    te, ok := err.(temporary)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ok &amp;&amp; te.Temporary()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>package</code><code>error</code><code>error</code><code>package</code></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Write</span><span class=\"params\">(w io.Writer, buf []<span class=\"keyword\">byte</span>)</span></span> &#123;</span><br><span class=\"line\">    w.Write(buf)    <span class=\"comment\">// Write(p []byte) (n int, err error)Write https://golang.org/pkg/io/#Writer</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Write</span><span class=\"params\">(w io.Writer, buf []<span class=\"keyword\">byte</span>)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    _, err := w.Write(buf)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Println(<span class=\"string\">\"unable to write:\"</span>, err)    <span class=\"comment\">// 1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> err</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// create writer and read data into buf</span></span><br><span class=\"line\"></span><br><span class=\"line\">    err := Write(w, buf)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Println(<span class=\"string\">\"Write error:\"</span>, err)        <span class=\"comment\">// 2</span></span><br><span class=\"line\">        os.Exit(<span class=\"number\">1</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    os.Exit(<span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><ul>\n<li><code>errors.Wrap</code><code>error</code></li>\n<li><code>errors.Cause</code><code>error</code></li>\n</ul>\n</li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>The Go Blog<ul>\n<li><a href=\"https://blog.golang.org/error-handling-and-go\" target=\"_blank\" rel=\"noopener\">Error handling in Go</a></li>\n<li><a href=\"https://blog.golang.org/defer-panic-and-recover\" target=\"_blank\" rel=\"noopener\">Defer, Panic, and Recover</a></li>\n</ul>\n</li>\n<li>Dave Cheney<ul>\n<li><a href=\"https://dave.cheney.net/paste/gocon-spring-2016.pdf\" target=\"_blank\" rel=\"noopener\">presentation on my philosophy for error handling</a></li>\n<li><a href=\"https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully\" target=\"_blank\" rel=\"noopener\">Dont just check errors, handle them gracefully</a></li>\n<li><a href=\"https://dave.cheney.net/2016/06/12/stack-traces-and-the-errors-package\" target=\"_blank\" rel=\"noopener\">Stack traces and the errors package</a></li>\n</ul>\n</li>\n<li>Go Packages<ul>\n<li><a href=\"https://golang.org/pkg/errors/\" target=\"_blank\" rel=\"noopener\">errors</a></li>\n<li><a href=\"https://golang.org/pkg/runtime/\" target=\"_blank\" rel=\"noopener\">runtime</a></li>\n</ul>\n</li>\n<li>pkg: Artisanal, hand crafted, barrel aged, Go packages<ul>\n<li><a href=\"https://godoc.org/github.com/pkg/errors\" target=\"_blank\" rel=\"noopener\">github.com/pkg/errors</a></li>\n</ul>\n</li>\n</ul>\n"},{"title":"GolangJSON","date":"2016-06-23T00:09:39.000Z","_content":"\n\n# \n\n\n\nGolangJSON\n\n# \n\n## 1`omitempty`\n\nC#JSON`Newtonsoft.Json`JSONJSON`property annotation``ShouldSerialize method`\n\n```c#\n// ShouldSerialize methodObsoleteSetting\nclass Config\n{\n    public Fizz ObsoleteSetting { get; set; }\n\n    public bool ShouldSerializeObsoleteSetting()\n    {\n        return false;\n    }\n}\n\n// JsonIgnoreannotationObsoleteSetting\nclass Config\n{\n    [JsonIgnore]\n    public Fizz ObsoleteSetting { get; set; }\n\n    public Bang ReplacementSetting { get; set; }\n}\n```\n\n`Newtonsoft.Json`Conditional Property Serialization\n\n- [Conditional Property Serialization](http://www.newtonsoft.com/json/help/html/ConditionalProperties.htm)\n- [Making a property deserialize but not serialize with json.net](http://stackoverflow.com/questions/11564091/making-a-property-deserialize-but-not-serialize-with-json-net)\n\nGolang`omitempty`C#[encoding/json package](http://docs.studygolang.com/pkg/encoding/json/#Marshal)`omitempty`\n\n> Struct values encode as JSON objects. Each exported struct field becomes a member of the object unless\n>\n> - the field's tag is \"-\", or\n> - the field is empty and its tag specifies the \"omitempty\" option.\n>\n> The empty values are false, 0, any nil pointer or interface value, and any array, slice, map, or string of length zero. The object's default key string is the struct field name but can be specified in the struct field's tag value. The \"json\" key in the struct field's tag value is the key name, followed by an optional comma and options. Examples:\n>\n> ```go\n> // Field is ignored by this package.\n> Field int `json:\"-\"`\n>\n> // Field appears in JSON as key \"myName\".\n> Field int `json:\"myName\"`\n>\n> // Field appears in JSON as key \"myName\" and\n> // the field is omitted from the object if its value is empty,\n> // as defined above.\n> Field int `json:\"myName,omitempty\"`\n>\n> // Field appears in JSON as key \"Field\" (the default), but\n> // the field is skipped if empty.\n> // Note the leading comma.\n> Field int `json:\",omitempty\"`\n> ```\n\nGolang`field`JSON`-``field``JsonIgnore`\n\n`omitempty``field``empty`JSON`field``Newtonsoft.Json`[](http://stackoverflow.com/questions/6507889/how-to-ignore-a-property-in-class-if-null-using-json-net)[](https://dotnetfiddle.net/VXqRnm)`emtpty`\n\n> The empty values are false, 0, any nil pointer or interface value, and any array, slice, map, or string of length zero.\n\n`empty values`\n\n```go\npackage main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"log\"\n    \"os\"\n)\n\ntype S1 struct {\n    I1 int\n    I2 int `json:\",omitempty\"`\n\n    F1 float64\n    F2 float64 `json:\",omitempty\"`\n\n    S1 string\n    S2 string `json:\",omitempty\"`\n\n    B1 bool\n    B2 bool `json:\",omitempty\"`\n\n    Slice1 []int\n    Slice2 []int `json:\",omitempty\"`\n    Slice3 []int `json:\",omitempty\"`\n\n    Map1 map[string]string\n    Map2 map[string]string `json:\",omitempty\"`\n    Map3 map[string]string `json:\",omitempty\"`\n\n    O1 interface{}\n    O2 interface{} `json:\",omitempty\"`\n    O3 interface{} `json:\",omitempty\"`\n    O4 interface{} `json:\",omitempty\"`\n    O5 interface{} `json:\",omitempty\"`\n    O6 interface{} `json:\",omitempty\"`\n    O7 interface{} `json:\",omitempty\"`\n    O8 interface{} `json:\",omitempty\"`\n\n    P1 *int\n    P2 *int               `json:\",omitempty\"`\n    P3 *int               `json:\",omitempty\"`\n    P4 *float64           `json:\",omitempty\"`\n    P5 *string            `json:\",omitempty\"`\n    P6 *bool              `json:\",omitempty\"`\n    P7 *[]int             `json:\",omitempty\"`\n    P8 *map[string]string `json:\",omitempty\"`\n}\n\nfunc main() {\n\n    p3 := 0\n    p4 := float64(0)\n    p5 := \"\"\n    p6 := false\n    p7 := []int{}\n    p8 := map[string]string{}\n\n    s1 := S1{\n        I1: 0,\n        I2: 0,\n\n        F1: 0,\n        F2: 0,\n\n        S1: \"\",\n        S2: \"\",\n\n        B1: false,\n        B2: false,\n\n        Slice1: []int{},\n        Slice2: nil,\n        Slice3: []int{},\n\n        Map1: map[string]string{},\n        Map2: nil,\n        Map3: map[string]string{},\n\n        O1: nil,\n        O2: nil,\n        O3: int(0),\n        O4: float64(0),\n        O5: \"\",\n        O6: false,\n        O7: []int{},\n        O8: map[string]string{},\n\n        P1: nil,\n        P2: nil,\n        P3: &p3,\n        P4: &p4,\n        P5: &p5,\n        P6: &p6,\n        P7: &p7,\n        P8: &p8,\n    }\n\n    b, err := json.Marshal(s1)\n    if err != nil {\n        log.Printf(\"marshal error: %v\", err)\n        return\n    }\n\n    var out bytes.Buffer\n    json.Indent(&out, b, \"\", \"\\t\")\n    out.WriteTo(os.Stdout)\n    //Output:\n    //{\n    //\t\"I1\": 0,\n    //\t\"F1\": 0,\n    //\t\"S1\": \"\",\n    //\t\"B1\": false,\n    //\t\"Slice1\": [],\n    //\t\"Map1\": {},\n    //\t\"O1\": null,\n    //\t\"O3\": 0,\n    //\t\"O4\": 0,\n    //\t\"O5\": \"\",\n    //\t\"O6\": false,\n    //\t\"O7\": [],\n    //\t\"O8\": {},\n    //\t\"P1\": null,\n    //\t\"P2\": 0\n    //}%\n}\n```\n\n*[](https://play.golang.org/p/6y_m27r8EO)*\n\n`empty value`\n\nAppRestful APIResponse`User`\n\n```go\ntype User struct {\n    ID        int `json:\"id\"`                  // id\n    // field\n    FansCount int `json:\"fansCount,omitempty\"` // \n}\n```\n\nAppRestful APIResponse\n\n```json\n{\n    \"id\": 1000386,\n    ...\n}\n```\n\nResponseUser`fansCount``fansCount``int`0`User``fansCount`********\n\n********`User`\n\n```go\ntype User struct {\n    ID        int  `json:\"id\"`                  // id\n    // field\n    FansCount *int `json:\"fansCount,omitempty\"` // \n}\n```\n\n`FansCount``nil`0\n\n`FansCount``FansCount`\n\n```go\n// FansCountint\nuser := dataAccess.GetUserInfo(userId)\nuser.FansCount = dataAccess.GetFansCount(userId)\n\n// FansCount*int\nuser := dataAccess.GetUserInfo(userId)\nfansCount := dataAccess.GetFansCount(userId)\nuser.FansCount = &fansCount\n```\n\n## 2JSONinterface{}Number\n\n[JSON](http://json.org/)\n\n![](http://json.org/value.gif)\n\nJSON:\n\n```json\n{\n    \"name\": \"ethancai\",\n    \"fansCount\": 9223372036854775807\n}\n```\n\n\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype User struct {\n    Name      string\n    FansCount int64\n}\n\nfunc main() {\n    const jsonStream = `\n        {\"name\":\"ethancai\", \"fansCount\": 9223372036854775807}\n    `\n    var user User  // User\n    err := json.Unmarshal([]byte(jsonStream), &user)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n\n    fmt.Printf(\"%+v \\n\", user)\n}\n// Output:\n//  {Name:ethancai FansCount:9223372036854775807}\n```\n\n*[](https://play.golang.org/p/203egccrea)*\n\nJSON`float64`\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    const jsonStream = `\n        {\"name\":\"ethancai\", \"fansCount\": 9223372036854775807}\n    `\n    var user interface{}  // \n    err := json.Unmarshal([]byte(jsonStream), &user)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    m := user.(map[string]interface{})\n\n    fansCount := m[\"fansCount\"]\n\n    fmt.Printf(\"%+v \\n\", reflect.TypeOf(fansCount).Name())\n    fmt.Printf(\"%+v \\n\", fansCount.(float64))\n}\n\n// Output:\n// \tfloat64\n//  \t9.223372036854776e+18\n```\n\n*[](https://play.golang.org/p/l4GzgA4WDA)*\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype User struct {\n    Name      string\n    FansCount interface{}  // FansCount\n}\n\nfunc main() {\n    const jsonStream = `\n        {\"name\":\"ethancai\", \"fansCount\": 9223372036854775807}\n    `\n    var user User\n    err := json.Unmarshal([]byte(jsonStream), &user)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n\n    fmt.Printf(\"%+v \\n\", user)\n}\n\n// Output:\n// \t{Name:ethancai FansCount:9.223372036854776e+18}\n```\n\n*[](https://play.golang.org/p/SoD6SOGuCM)*\n\n`fansCount``float64`\n\n\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n    \"strings\"\n)\n\nfunc main() {\n    const jsonStream = `\n        {\"name\":\"ethancai\", \"fansCount\": 9223372036854775807}\n    `\n\n    decoder := json.NewDecoder(strings.NewReader(jsonStream))\n    decoder.UseNumber()    // UseNumber causes the Decoder to unmarshal a number into an interface{} as a Number instead of as a float64.\n\n    var user interface{}\n    if err := decoder.Decode(&user); err != nil {\n        fmt.Println(\"error:\", err)\n            return\n        }\n\n    m := user.(map[string]interface{})\n    fansCount := m[\"fansCount\"]\n    fmt.Printf(\"%+v \\n\", reflect.TypeOf(fansCount).PkgPath() + \".\" + reflect.TypeOf(fansCount).Name())\n\n     v, err := fansCount.(json.Number).Int64()\n    if err != nil {\n        fmt.Println(\"error:\", err)\n            return\n    }\n    fmt.Printf(\"%+v \\n\", v)\n}\n\n// Output:\n// \tencoding/json.Number\n// \t9223372036854775807\n```\n*[](https://play.golang.org/p/KYrFshVMFD)*\n\n`func (*Decoder) UseNumber`JSON`float64``json.Number``json.Number`\n\n```go\n// A Number represents a JSON number literal.\ntype Number string\n\n// String returns the literal text of the number.\nfunc (n Number) String() string { return string(n) }\n\n// Float64 returns the number as a float64.\nfunc (n Number) Float64() (float64, error) {\n    return strconv.ParseFloat(string(n), 64)\n}\n\n// Int64 returns the number as an int64.\nfunc (n Number) Int64() (int64, error) {\n    return strconv.ParseInt(string(n), 10, 64)\n}\n```\n\n`json.Number`JSON`json.Number``json.Number``float64``int64`\n\nGolangJSON\n\nJavaScript[](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Numbers_and_dates)JSONJSONJavaScript Object NotationJavaScriptDouglas CrockfordJavaScript[Douglas Crockford](http://www.infoq.com/cn/news/2010/02/qconbeijing2010-douglas)\n\nC#JSONlibrary [Json.NET](http://www.newtonsoft.com/json)JSONGolang\n\n```c#\nusing System;\nusing Newtonsoft.Json;\n\npublic class Program\n{\n    public static void Main()\n    {\n        string json = @\"{\n  'Name': 'Ethan',\n  'FansCount': 121211,\n  'Price': 99.99\n}\";\n\n        Product m = JsonConvert.DeserializeObject<Product>(json);\n\n        Console.WriteLine(m.FansCount);\n        Console.WriteLine(m.FansCount.GetType().FullName);\n\n        Console.WriteLine(m.Price);\n        Console.WriteLine(m.Price.GetType().FullName);\n\n    }\n}\n\npublic class Product\n{\n    public string Name\n    {\n        get;\n        set;\n    }\n\n    public object FansCount\n    {\n        get;\n        set;\n    }\n\n    public object Price\n    {\n        get;\n        set;\n    }\n}\n\n// Output:\n//      121211\n//      System.Int64\n//      99.99\n//      System.Double\n```\n\n*[](https://dotnetfiddle.net/IrlMae)*\n\n`Json.NET`\n\n## 3\n\nJSONlibrary\n\nGo\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    type Product struct {\n        Name      string\n        CreatedAt time.Time\n    }\n    pdt := Product{\n        Name:      \"Reds\",\n        CreatedAt: time.Now(),\n    }\n    b, err := json.Marshal(pdt)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    os.Stdout.Write(b)\n}\n// Output\n//      {\"Name\":\"Reds\",\"CreatedAt\":\"2016-06-27T07:40:54.69292134+08:00\"}\n```\n\nJavaScript\n\n```sh\n  ~ node\n> var jo = { name: \"ethan\", createdAt: Date.now() };\nundefined\n> JSON.stringify(jo)\n'{\"name\":\"ethan\",\"createdAt\":1466984665633}'\n```\n\nC#\n\n```c#\nusing System;\nusing Newtonsoft.Json;\n\npublic class Program\n{\n    public static void Main()\n    {\n        Product product = new Product();\n        product.Name = \"Apple\";\n        product.CreatedAt = DateTime.Now;\n\n        string json = JsonConvert.SerializeObject(product,\n                            Newtonsoft.Json.Formatting.Indented,\n                            new JsonSerializerSettings {\n                                NullValueHandling = NullValueHandling.Ignore\n                            });\n        Console.WriteLine(json);\n    }\n}\n\npublic class Product\n{\n    public string Name\n    {\n        get;\n        set;\n    }\n\n    public DateTime CreatedAt\n    {\n        get;\n        set;\n    }\n}\n// Output:\n//      {\n//        \"Name\": \"Apple\",\n//        \"CreatedAt\": \"2016-06-26T23:46:57.3244307+00:00\"\n//      }\n```\n\nGo`encoding/json` packageC#Json.NET[ISO 8601](http://www.w3.org/TR/NOTE-datetime)JavaScript`Date`197011000JavaScript[`dateObj.toISOString()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString)ISO[`Date.parse(dateString)`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/parse)ISO\n\nISOGo`time.Time`\n\n```go\ntype Time struct {\n    // sec gives the number of seconds elapsed since\n    // January 1, year 1 00:00:00 UTC.\n    sec int64\n\n    // nsec specifies a non-negative nanosecond\n    // offset within the second named by Seconds.\n    // It must be in the range [0, 999999999].\n    nsec int32\n\n    // loc specifies the Location that should be used to\n    // determine the minute, hour, month, day, and year\n    // that correspond to this Time.\n    // Only the zero Time has a nil Location.\n    // In that case it is interpreted to mean UTC.\n    loc *Location\n}\n```\n\nJSON\n\n- .NET FrameworkJSON`\"\\/Date(1343660352227+0530)\\/\"`\n- ISO\n- `1970-1-1 00:00:00 UTC``1970-1-1 00:00:00`\n\n\n# \n\n\n\n- [package encoding/json in Go](http://docs.studygolang.com/pkg/encoding/json/)\n- [http://docs.studygolang.com/src/encoding/json/example_test.go](http://docs.studygolang.com/src/encoding/json/example_test.go)\n- [The Go Blog: JSON and Go](https://blog.golang.org/json-and-go)\n- [Go by example: JSON](https://gobyexample.com/json)\n- [JSON decoding in Go](http://attilaolah.eu/2013/11/29/json-decoding-in-go/)\n- [go and json](https://eager.io/blog/go-and-json/)\n- [Decode JSON Documents In Go](https://www.goinggo.net/2014/01/decode-json-documents-in-go.html)\n- [ffjson: faster JSON serialization for Golang](https://journal.paul.querna.org/articles/2014/03/31/ffjson-faster-json-in-go/)\n- [Serialization in Go](http://www.slideshare.net/albertstrasheim/serialization-in-go)\n\n\n\n- [ffjson](https://github.com/pquerna/ffjson): faster JSON serialization for Go\n- [go-simplejson](https://github.com/bitly/go-simplejson): a Go package to interact with arbitrary JSON\n- [Jason](https://github.com/antonholmquist/jason): Easy-to-use JSON Library for Go\n- [easyjson](https://github.com/mailru/easyjson)\n- [gabs](https://github.com/Jeffail/gabs)\n- [jsonparser](https://github.com/buger/jsonparser)\n\n\n\n- [JSON-to-Go](https://mholt.github.io/json-to-go/): instantly converts JSON into a Go type definition\n","source":"_posts/bad-parts-about-json-serialization-in-Golang.md","raw":"---\ntitle: GolangJSON\ntags:\n  - golang\n  - json\ncategories:\n  - \ndate: 2016-06-23 08:09:39\n---\n\n\n# \n\n\n\nGolangJSON\n\n# \n\n## 1`omitempty`\n\nC#JSON`Newtonsoft.Json`JSONJSON`property annotation``ShouldSerialize method`\n\n```c#\n// ShouldSerialize methodObsoleteSetting\nclass Config\n{\n    public Fizz ObsoleteSetting { get; set; }\n\n    public bool ShouldSerializeObsoleteSetting()\n    {\n        return false;\n    }\n}\n\n// JsonIgnoreannotationObsoleteSetting\nclass Config\n{\n    [JsonIgnore]\n    public Fizz ObsoleteSetting { get; set; }\n\n    public Bang ReplacementSetting { get; set; }\n}\n```\n\n`Newtonsoft.Json`Conditional Property Serialization\n\n- [Conditional Property Serialization](http://www.newtonsoft.com/json/help/html/ConditionalProperties.htm)\n- [Making a property deserialize but not serialize with json.net](http://stackoverflow.com/questions/11564091/making-a-property-deserialize-but-not-serialize-with-json-net)\n\nGolang`omitempty`C#[encoding/json package](http://docs.studygolang.com/pkg/encoding/json/#Marshal)`omitempty`\n\n> Struct values encode as JSON objects. Each exported struct field becomes a member of the object unless\n>\n> - the field's tag is \"-\", or\n> - the field is empty and its tag specifies the \"omitempty\" option.\n>\n> The empty values are false, 0, any nil pointer or interface value, and any array, slice, map, or string of length zero. The object's default key string is the struct field name but can be specified in the struct field's tag value. The \"json\" key in the struct field's tag value is the key name, followed by an optional comma and options. Examples:\n>\n> ```go\n> // Field is ignored by this package.\n> Field int `json:\"-\"`\n>\n> // Field appears in JSON as key \"myName\".\n> Field int `json:\"myName\"`\n>\n> // Field appears in JSON as key \"myName\" and\n> // the field is omitted from the object if its value is empty,\n> // as defined above.\n> Field int `json:\"myName,omitempty\"`\n>\n> // Field appears in JSON as key \"Field\" (the default), but\n> // the field is skipped if empty.\n> // Note the leading comma.\n> Field int `json:\",omitempty\"`\n> ```\n\nGolang`field`JSON`-``field``JsonIgnore`\n\n`omitempty``field``empty`JSON`field``Newtonsoft.Json`[](http://stackoverflow.com/questions/6507889/how-to-ignore-a-property-in-class-if-null-using-json-net)[](https://dotnetfiddle.net/VXqRnm)`emtpty`\n\n> The empty values are false, 0, any nil pointer or interface value, and any array, slice, map, or string of length zero.\n\n`empty values`\n\n```go\npackage main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"log\"\n    \"os\"\n)\n\ntype S1 struct {\n    I1 int\n    I2 int `json:\",omitempty\"`\n\n    F1 float64\n    F2 float64 `json:\",omitempty\"`\n\n    S1 string\n    S2 string `json:\",omitempty\"`\n\n    B1 bool\n    B2 bool `json:\",omitempty\"`\n\n    Slice1 []int\n    Slice2 []int `json:\",omitempty\"`\n    Slice3 []int `json:\",omitempty\"`\n\n    Map1 map[string]string\n    Map2 map[string]string `json:\",omitempty\"`\n    Map3 map[string]string `json:\",omitempty\"`\n\n    O1 interface{}\n    O2 interface{} `json:\",omitempty\"`\n    O3 interface{} `json:\",omitempty\"`\n    O4 interface{} `json:\",omitempty\"`\n    O5 interface{} `json:\",omitempty\"`\n    O6 interface{} `json:\",omitempty\"`\n    O7 interface{} `json:\",omitempty\"`\n    O8 interface{} `json:\",omitempty\"`\n\n    P1 *int\n    P2 *int               `json:\",omitempty\"`\n    P3 *int               `json:\",omitempty\"`\n    P4 *float64           `json:\",omitempty\"`\n    P5 *string            `json:\",omitempty\"`\n    P6 *bool              `json:\",omitempty\"`\n    P7 *[]int             `json:\",omitempty\"`\n    P8 *map[string]string `json:\",omitempty\"`\n}\n\nfunc main() {\n\n    p3 := 0\n    p4 := float64(0)\n    p5 := \"\"\n    p6 := false\n    p7 := []int{}\n    p8 := map[string]string{}\n\n    s1 := S1{\n        I1: 0,\n        I2: 0,\n\n        F1: 0,\n        F2: 0,\n\n        S1: \"\",\n        S2: \"\",\n\n        B1: false,\n        B2: false,\n\n        Slice1: []int{},\n        Slice2: nil,\n        Slice3: []int{},\n\n        Map1: map[string]string{},\n        Map2: nil,\n        Map3: map[string]string{},\n\n        O1: nil,\n        O2: nil,\n        O3: int(0),\n        O4: float64(0),\n        O5: \"\",\n        O6: false,\n        O7: []int{},\n        O8: map[string]string{},\n\n        P1: nil,\n        P2: nil,\n        P3: &p3,\n        P4: &p4,\n        P5: &p5,\n        P6: &p6,\n        P7: &p7,\n        P8: &p8,\n    }\n\n    b, err := json.Marshal(s1)\n    if err != nil {\n        log.Printf(\"marshal error: %v\", err)\n        return\n    }\n\n    var out bytes.Buffer\n    json.Indent(&out, b, \"\", \"\\t\")\n    out.WriteTo(os.Stdout)\n    //Output:\n    //{\n    //\t\"I1\": 0,\n    //\t\"F1\": 0,\n    //\t\"S1\": \"\",\n    //\t\"B1\": false,\n    //\t\"Slice1\": [],\n    //\t\"Map1\": {},\n    //\t\"O1\": null,\n    //\t\"O3\": 0,\n    //\t\"O4\": 0,\n    //\t\"O5\": \"\",\n    //\t\"O6\": false,\n    //\t\"O7\": [],\n    //\t\"O8\": {},\n    //\t\"P1\": null,\n    //\t\"P2\": 0\n    //}%\n}\n```\n\n*[](https://play.golang.org/p/6y_m27r8EO)*\n\n`empty value`\n\nAppRestful APIResponse`User`\n\n```go\ntype User struct {\n    ID        int `json:\"id\"`                  // id\n    // field\n    FansCount int `json:\"fansCount,omitempty\"` // \n}\n```\n\nAppRestful APIResponse\n\n```json\n{\n    \"id\": 1000386,\n    ...\n}\n```\n\nResponseUser`fansCount``fansCount``int`0`User``fansCount`********\n\n********`User`\n\n```go\ntype User struct {\n    ID        int  `json:\"id\"`                  // id\n    // field\n    FansCount *int `json:\"fansCount,omitempty\"` // \n}\n```\n\n`FansCount``nil`0\n\n`FansCount``FansCount`\n\n```go\n// FansCountint\nuser := dataAccess.GetUserInfo(userId)\nuser.FansCount = dataAccess.GetFansCount(userId)\n\n// FansCount*int\nuser := dataAccess.GetUserInfo(userId)\nfansCount := dataAccess.GetFansCount(userId)\nuser.FansCount = &fansCount\n```\n\n## 2JSONinterface{}Number\n\n[JSON](http://json.org/)\n\n![](http://json.org/value.gif)\n\nJSON:\n\n```json\n{\n    \"name\": \"ethancai\",\n    \"fansCount\": 9223372036854775807\n}\n```\n\n\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype User struct {\n    Name      string\n    FansCount int64\n}\n\nfunc main() {\n    const jsonStream = `\n        {\"name\":\"ethancai\", \"fansCount\": 9223372036854775807}\n    `\n    var user User  // User\n    err := json.Unmarshal([]byte(jsonStream), &user)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n\n    fmt.Printf(\"%+v \\n\", user)\n}\n// Output:\n//  {Name:ethancai FansCount:9223372036854775807}\n```\n\n*[](https://play.golang.org/p/203egccrea)*\n\nJSON`float64`\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    const jsonStream = `\n        {\"name\":\"ethancai\", \"fansCount\": 9223372036854775807}\n    `\n    var user interface{}  // \n    err := json.Unmarshal([]byte(jsonStream), &user)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    m := user.(map[string]interface{})\n\n    fansCount := m[\"fansCount\"]\n\n    fmt.Printf(\"%+v \\n\", reflect.TypeOf(fansCount).Name())\n    fmt.Printf(\"%+v \\n\", fansCount.(float64))\n}\n\n// Output:\n// \tfloat64\n//  \t9.223372036854776e+18\n```\n\n*[](https://play.golang.org/p/l4GzgA4WDA)*\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype User struct {\n    Name      string\n    FansCount interface{}  // FansCount\n}\n\nfunc main() {\n    const jsonStream = `\n        {\"name\":\"ethancai\", \"fansCount\": 9223372036854775807}\n    `\n    var user User\n    err := json.Unmarshal([]byte(jsonStream), &user)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n\n    fmt.Printf(\"%+v \\n\", user)\n}\n\n// Output:\n// \t{Name:ethancai FansCount:9.223372036854776e+18}\n```\n\n*[](https://play.golang.org/p/SoD6SOGuCM)*\n\n`fansCount``float64`\n\n\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n    \"strings\"\n)\n\nfunc main() {\n    const jsonStream = `\n        {\"name\":\"ethancai\", \"fansCount\": 9223372036854775807}\n    `\n\n    decoder := json.NewDecoder(strings.NewReader(jsonStream))\n    decoder.UseNumber()    // UseNumber causes the Decoder to unmarshal a number into an interface{} as a Number instead of as a float64.\n\n    var user interface{}\n    if err := decoder.Decode(&user); err != nil {\n        fmt.Println(\"error:\", err)\n            return\n        }\n\n    m := user.(map[string]interface{})\n    fansCount := m[\"fansCount\"]\n    fmt.Printf(\"%+v \\n\", reflect.TypeOf(fansCount).PkgPath() + \".\" + reflect.TypeOf(fansCount).Name())\n\n     v, err := fansCount.(json.Number).Int64()\n    if err != nil {\n        fmt.Println(\"error:\", err)\n            return\n    }\n    fmt.Printf(\"%+v \\n\", v)\n}\n\n// Output:\n// \tencoding/json.Number\n// \t9223372036854775807\n```\n*[](https://play.golang.org/p/KYrFshVMFD)*\n\n`func (*Decoder) UseNumber`JSON`float64``json.Number``json.Number`\n\n```go\n// A Number represents a JSON number literal.\ntype Number string\n\n// String returns the literal text of the number.\nfunc (n Number) String() string { return string(n) }\n\n// Float64 returns the number as a float64.\nfunc (n Number) Float64() (float64, error) {\n    return strconv.ParseFloat(string(n), 64)\n}\n\n// Int64 returns the number as an int64.\nfunc (n Number) Int64() (int64, error) {\n    return strconv.ParseInt(string(n), 10, 64)\n}\n```\n\n`json.Number`JSON`json.Number``json.Number``float64``int64`\n\nGolangJSON\n\nJavaScript[](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Numbers_and_dates)JSONJSONJavaScript Object NotationJavaScriptDouglas CrockfordJavaScript[Douglas Crockford](http://www.infoq.com/cn/news/2010/02/qconbeijing2010-douglas)\n\nC#JSONlibrary [Json.NET](http://www.newtonsoft.com/json)JSONGolang\n\n```c#\nusing System;\nusing Newtonsoft.Json;\n\npublic class Program\n{\n    public static void Main()\n    {\n        string json = @\"{\n  'Name': 'Ethan',\n  'FansCount': 121211,\n  'Price': 99.99\n}\";\n\n        Product m = JsonConvert.DeserializeObject<Product>(json);\n\n        Console.WriteLine(m.FansCount);\n        Console.WriteLine(m.FansCount.GetType().FullName);\n\n        Console.WriteLine(m.Price);\n        Console.WriteLine(m.Price.GetType().FullName);\n\n    }\n}\n\npublic class Product\n{\n    public string Name\n    {\n        get;\n        set;\n    }\n\n    public object FansCount\n    {\n        get;\n        set;\n    }\n\n    public object Price\n    {\n        get;\n        set;\n    }\n}\n\n// Output:\n//      121211\n//      System.Int64\n//      99.99\n//      System.Double\n```\n\n*[](https://dotnetfiddle.net/IrlMae)*\n\n`Json.NET`\n\n## 3\n\nJSONlibrary\n\nGo\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    type Product struct {\n        Name      string\n        CreatedAt time.Time\n    }\n    pdt := Product{\n        Name:      \"Reds\",\n        CreatedAt: time.Now(),\n    }\n    b, err := json.Marshal(pdt)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    os.Stdout.Write(b)\n}\n// Output\n//      {\"Name\":\"Reds\",\"CreatedAt\":\"2016-06-27T07:40:54.69292134+08:00\"}\n```\n\nJavaScript\n\n```sh\n  ~ node\n> var jo = { name: \"ethan\", createdAt: Date.now() };\nundefined\n> JSON.stringify(jo)\n'{\"name\":\"ethan\",\"createdAt\":1466984665633}'\n```\n\nC#\n\n```c#\nusing System;\nusing Newtonsoft.Json;\n\npublic class Program\n{\n    public static void Main()\n    {\n        Product product = new Product();\n        product.Name = \"Apple\";\n        product.CreatedAt = DateTime.Now;\n\n        string json = JsonConvert.SerializeObject(product,\n                            Newtonsoft.Json.Formatting.Indented,\n                            new JsonSerializerSettings {\n                                NullValueHandling = NullValueHandling.Ignore\n                            });\n        Console.WriteLine(json);\n    }\n}\n\npublic class Product\n{\n    public string Name\n    {\n        get;\n        set;\n    }\n\n    public DateTime CreatedAt\n    {\n        get;\n        set;\n    }\n}\n// Output:\n//      {\n//        \"Name\": \"Apple\",\n//        \"CreatedAt\": \"2016-06-26T23:46:57.3244307+00:00\"\n//      }\n```\n\nGo`encoding/json` packageC#Json.NET[ISO 8601](http://www.w3.org/TR/NOTE-datetime)JavaScript`Date`197011000JavaScript[`dateObj.toISOString()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString)ISO[`Date.parse(dateString)`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/parse)ISO\n\nISOGo`time.Time`\n\n```go\ntype Time struct {\n    // sec gives the number of seconds elapsed since\n    // January 1, year 1 00:00:00 UTC.\n    sec int64\n\n    // nsec specifies a non-negative nanosecond\n    // offset within the second named by Seconds.\n    // It must be in the range [0, 999999999].\n    nsec int32\n\n    // loc specifies the Location that should be used to\n    // determine the minute, hour, month, day, and year\n    // that correspond to this Time.\n    // Only the zero Time has a nil Location.\n    // In that case it is interpreted to mean UTC.\n    loc *Location\n}\n```\n\nJSON\n\n- .NET FrameworkJSON`\"\\/Date(1343660352227+0530)\\/\"`\n- ISO\n- `1970-1-1 00:00:00 UTC``1970-1-1 00:00:00`\n\n\n# \n\n\n\n- [package encoding/json in Go](http://docs.studygolang.com/pkg/encoding/json/)\n- [http://docs.studygolang.com/src/encoding/json/example_test.go](http://docs.studygolang.com/src/encoding/json/example_test.go)\n- [The Go Blog: JSON and Go](https://blog.golang.org/json-and-go)\n- [Go by example: JSON](https://gobyexample.com/json)\n- [JSON decoding in Go](http://attilaolah.eu/2013/11/29/json-decoding-in-go/)\n- [go and json](https://eager.io/blog/go-and-json/)\n- [Decode JSON Documents In Go](https://www.goinggo.net/2014/01/decode-json-documents-in-go.html)\n- [ffjson: faster JSON serialization for Golang](https://journal.paul.querna.org/articles/2014/03/31/ffjson-faster-json-in-go/)\n- [Serialization in Go](http://www.slideshare.net/albertstrasheim/serialization-in-go)\n\n\n\n- [ffjson](https://github.com/pquerna/ffjson): faster JSON serialization for Go\n- [go-simplejson](https://github.com/bitly/go-simplejson): a Go package to interact with arbitrary JSON\n- [Jason](https://github.com/antonholmquist/jason): Easy-to-use JSON Library for Go\n- [easyjson](https://github.com/mailru/easyjson)\n- [gabs](https://github.com/Jeffail/gabs)\n- [jsonparser](https://github.com/buger/jsonparser)\n\n\n\n- [JSON-to-Go](https://mholt.github.io/json-to-go/): instantly converts JSON into a Go type definition\n","slug":"bad-parts-about-json-serialization-in-Golang","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24h0007v7e8cj2cop42","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>GolangJSON</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1omitempty\"><a href=\"#1omitempty\" class=\"headerlink\" title=\"1omitempty\"></a>1<code>omitempty</code></h2><p>C#JSON<code>Newtonsoft.Json</code>JSONJSON<code>property annotation</code><code>ShouldSerialize method</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ShouldSerialize methodObsoleteSetting</span><br><span class=\"line\">class Config</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public Fizz ObsoleteSetting &#123; get; set; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public bool ShouldSerializeObsoleteSetting()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// JsonIgnoreannotationObsoleteSetting</span><br><span class=\"line\">class Config</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    [JsonIgnore]</span><br><span class=\"line\">    public Fizz ObsoleteSetting &#123; get; set; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Bang ReplacementSetting &#123; get; set; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Newtonsoft.Json</code>Conditional Property Serialization</p>\n<ul>\n<li><a href=\"http://www.newtonsoft.com/json/help/html/ConditionalProperties.htm\" target=\"_blank\" rel=\"noopener\">Conditional Property Serialization</a></li>\n<li><a href=\"http://stackoverflow.com/questions/11564091/making-a-property-deserialize-but-not-serialize-with-json-net\" target=\"_blank\" rel=\"noopener\">Making a property deserialize but not serialize with json.net</a></li>\n</ul>\n<p>Golang<code>omitempty</code>C#<a href=\"http://docs.studygolang.com/pkg/encoding/json/#Marshal\" target=\"_blank\" rel=\"noopener\">encoding/json package</a><code>omitempty</code></p>\n<blockquote>\n<p>Struct values encode as JSON objects. Each exported struct field becomes a member of the object unless</p>\n<ul>\n<li>the fields tag is -, or</li>\n<li>the field is empty and its tag specifies the omitempty option.</li>\n</ul>\n<p>The empty values are false, 0, any nil pointer or interface value, and any array, slice, map, or string of length zero. The objects default key string is the struct field name but can be specified in the struct fields tag value. The json key in the struct fields tag value is the key name, followed by an optional comma and options. Examples:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"comment\">// Field is ignored by this package.</span></span><br><span class=\"line\">&gt; Field <span class=\"keyword\">int</span> <span class=\"string\">`json:\"-\"`</span></span><br><span class=\"line\">&gt;</span><br><span class=\"line\">&gt; <span class=\"comment\">// Field appears in JSON as key \"myName\".</span></span><br><span class=\"line\">&gt; Field <span class=\"keyword\">int</span> <span class=\"string\">`json:\"myName\"`</span></span><br><span class=\"line\">&gt;</span><br><span class=\"line\">&gt; <span class=\"comment\">// Field appears in JSON as key \"myName\" and</span></span><br><span class=\"line\">&gt; <span class=\"comment\">// the field is omitted from the object if its value is empty,</span></span><br><span class=\"line\">&gt; <span class=\"comment\">// as defined above.</span></span><br><span class=\"line\">&gt; Field <span class=\"keyword\">int</span> <span class=\"string\">`json:\"myName,omitempty\"`</span></span><br><span class=\"line\">&gt;</span><br><span class=\"line\">&gt; <span class=\"comment\">// Field appears in JSON as key \"Field\" (the default), but</span></span><br><span class=\"line\">&gt; <span class=\"comment\">// the field is skipped if empty.</span></span><br><span class=\"line\">&gt; <span class=\"comment\">// Note the leading comma.</span></span><br><span class=\"line\">&gt; Field <span class=\"keyword\">int</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>Golang<code>field</code>JSON<code>-</code><code>field</code><code>JsonIgnore</code></p>\n<p><code>omitempty</code><code>field</code><code>empty</code>JSON<code>field</code><code>Newtonsoft.Json</code><a href=\"http://stackoverflow.com/questions/6507889/how-to-ignore-a-property-in-class-if-null-using-json-net\" target=\"_blank\" rel=\"noopener\"></a><a href=\"https://dotnetfiddle.net/VXqRnm\" target=\"_blank\" rel=\"noopener\"></a><code>emtpty</code></p>\n<blockquote>\n<p>The empty values are false, 0, any nil pointer or interface value, and any array, slice, map, or string of length zero.</p>\n</blockquote>\n<p><code>empty values</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bytes\"</span></span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> S1 <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    I1 <span class=\"keyword\">int</span></span><br><span class=\"line\">    I2 <span class=\"keyword\">int</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    F1 <span class=\"keyword\">float64</span></span><br><span class=\"line\">    F2 <span class=\"keyword\">float64</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    S1 <span class=\"keyword\">string</span></span><br><span class=\"line\">    S2 <span class=\"keyword\">string</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    B1 <span class=\"keyword\">bool</span></span><br><span class=\"line\">    B2 <span class=\"keyword\">bool</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    Slice1 []<span class=\"keyword\">int</span></span><br><span class=\"line\">    Slice2 []<span class=\"keyword\">int</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    Slice3 []<span class=\"keyword\">int</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    Map1 <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span></span><br><span class=\"line\">    Map2 <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    Map3 <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    O1 <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\">    O2 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O3 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O4 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O5 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O6 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O7 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O8 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    P1 *<span class=\"keyword\">int</span></span><br><span class=\"line\">    P2 *<span class=\"keyword\">int</span>               <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P3 *<span class=\"keyword\">int</span>               <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P4 *<span class=\"keyword\">float64</span>           <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P5 *<span class=\"keyword\">string</span>            <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P6 *<span class=\"keyword\">bool</span>              <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P7 *[]<span class=\"keyword\">int</span>             <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P8 *<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    p3 := <span class=\"number\">0</span></span><br><span class=\"line\">    p4 := <span class=\"keyword\">float64</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">    p5 := <span class=\"string\">\"\"</span></span><br><span class=\"line\">    p6 := <span class=\"literal\">false</span></span><br><span class=\"line\">    p7 := []<span class=\"keyword\">int</span>&#123;&#125;</span><br><span class=\"line\">    p8 := <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    s1 := S1&#123;</span><br><span class=\"line\">        I1: <span class=\"number\">0</span>,</span><br><span class=\"line\">        I2: <span class=\"number\">0</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        F1: <span class=\"number\">0</span>,</span><br><span class=\"line\">        F2: <span class=\"number\">0</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        S1: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        S2: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        B1: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        B2: <span class=\"literal\">false</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        Slice1: []<span class=\"keyword\">int</span>&#123;&#125;,</span><br><span class=\"line\">        Slice2: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        Slice3: []<span class=\"keyword\">int</span>&#123;&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">        Map1: <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span>&#123;&#125;,</span><br><span class=\"line\">        Map2: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        Map3: <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span>&#123;&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">        O1: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        O2: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        O3: <span class=\"keyword\">int</span>(<span class=\"number\">0</span>),</span><br><span class=\"line\">        O4: <span class=\"keyword\">float64</span>(<span class=\"number\">0</span>),</span><br><span class=\"line\">        O5: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        O6: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        O7: []<span class=\"keyword\">int</span>&#123;&#125;,</span><br><span class=\"line\">        O8: <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span>&#123;&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">        P1: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        P2: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        P3: &amp;p3,</span><br><span class=\"line\">        P4: &amp;p4,</span><br><span class=\"line\">        P5: &amp;p5,</span><br><span class=\"line\">        P6: &amp;p6,</span><br><span class=\"line\">        P7: &amp;p7,</span><br><span class=\"line\">        P8: &amp;p8,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    b, err := json.Marshal(s1)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Printf(<span class=\"string\">\"marshal error: %v\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> out bytes.Buffer</span><br><span class=\"line\">    json.Indent(&amp;out, b, <span class=\"string\">\"\"</span>, <span class=\"string\">\"\\t\"</span>)</span><br><span class=\"line\">    out.WriteTo(os.Stdout)</span><br><span class=\"line\">    <span class=\"comment\">//Output:</span></span><br><span class=\"line\">    <span class=\"comment\">//&#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"I1\": 0,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"F1\": 0,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"S1\": \"\",</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"B1\": false,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"Slice1\": [],</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"Map1\": &#123;&#125;,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O1\": null,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O3\": 0,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O4\": 0,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O5\": \"\",</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O6\": false,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O7\": [],</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O8\": &#123;&#125;,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"P1\": null,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"P2\": 0</span></span><br><span class=\"line\">    <span class=\"comment\">//&#125;%</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/6y_m27r8EO\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>empty value</code></p>\n<p>AppRestful APIResponse<code>User</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    ID        <span class=\"keyword\">int</span> <span class=\"string\">`json:\"id\"`</span>                  <span class=\"comment\">// id</span></span><br><span class=\"line\">    <span class=\"comment\">// field</span></span><br><span class=\"line\">    FansCount <span class=\"keyword\">int</span> <span class=\"string\">`json:\"fansCount,omitempty\"`</span> <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>AppRestful APIResponse</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"id\"</span>: <span class=\"number\">1000386</span>,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ResponseUser<code>fansCount</code><code>fansCount</code><code>int</code>0<code>User</code><code>fansCount</code><strong></strong><strong></strong></p>\n<p><strong></strong><strong></strong><code>User</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    ID        <span class=\"keyword\">int</span>  <span class=\"string\">`json:\"id\"`</span>                  <span class=\"comment\">// id</span></span><br><span class=\"line\">    <span class=\"comment\">// field</span></span><br><span class=\"line\">    FansCount *<span class=\"keyword\">int</span> <span class=\"string\">`json:\"fansCount,omitempty\"`</span> <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>FansCount</code><code>nil</code>0</p>\n<p><code>FansCount</code><code>FansCount</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// FansCountint</span></span><br><span class=\"line\">user := dataAccess.GetUserInfo(userId)</span><br><span class=\"line\">user.FansCount = dataAccess.GetFansCount(userId)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// FansCount*int</span></span><br><span class=\"line\">user := dataAccess.GetUserInfo(userId)</span><br><span class=\"line\">fansCount := dataAccess.GetFansCount(userId)</span><br><span class=\"line\">user.FansCount = &amp;fansCount</span><br></pre></td></tr></table></figure>\n<h2 id=\"2JSONinterface-Number\"><a href=\"#2JSONinterface-Number\" class=\"headerlink\" title=\"2JSONinterface{}Number\"></a>2JSONinterface{}Number</h2><p><a href=\"http://json.org/\" target=\"_blank\" rel=\"noopener\">JSON</a></p>\n<p><img src=\"http://json.org/value.gif\" alt=\"\"></p>\n<p>JSON:</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"ethancai\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"fansCount\"</span>: <span class=\"number\">9223372036854775807</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Name      <span class=\"keyword\">string</span></span><br><span class=\"line\">    FansCount <span class=\"keyword\">int64</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> jsonStream = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        &#123;\"name\":\"ethancai\", \"fansCount\": 9223372036854775807&#125;</span></span><br><span class=\"line\"><span class=\"string\">    `</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user User  <span class=\"comment\">// User</span></span><br><span class=\"line\">    err := json.Unmarshal([]<span class=\"keyword\">byte</span>(jsonStream), &amp;user)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, user)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// Output:</span></span><br><span class=\"line\"><span class=\"comment\">//  &#123;Name:ethancai FansCount:9223372036854775807&#125;</span></span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/203egccrea\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p>JSON<code>float64</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> jsonStream = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        &#123;\"name\":\"ethancai\", \"fansCount\": 9223372036854775807&#125;</span></span><br><span class=\"line\"><span class=\"string\">    `</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user <span class=\"keyword\">interface</span>&#123;&#125;  <span class=\"comment\">// </span></span><br><span class=\"line\">    err := json.Unmarshal([]<span class=\"keyword\">byte</span>(jsonStream), &amp;user)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    m := user.(<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">interface</span>&#123;&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    fansCount := m[<span class=\"string\">\"fansCount\"</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, reflect.TypeOf(fansCount).Name())</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, fansCount.(<span class=\"keyword\">float64</span>))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output:</span></span><br><span class=\"line\"><span class=\"comment\">// \tfloat64</span></span><br><span class=\"line\"><span class=\"comment\">//  \t9.223372036854776e+18</span></span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/l4GzgA4WDA\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Name      <span class=\"keyword\">string</span></span><br><span class=\"line\">    FansCount <span class=\"keyword\">interface</span>&#123;&#125;  <span class=\"comment\">// FansCount</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> jsonStream = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        &#123;\"name\":\"ethancai\", \"fansCount\": 9223372036854775807&#125;</span></span><br><span class=\"line\"><span class=\"string\">    `</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user User</span><br><span class=\"line\">    err := json.Unmarshal([]<span class=\"keyword\">byte</span>(jsonStream), &amp;user)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, user)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output:</span></span><br><span class=\"line\"><span class=\"comment\">// \t&#123;Name:ethancai FansCount:9.223372036854776e+18&#125;</span></span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/SoD6SOGuCM\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>fansCount</code><code>float64</code></p>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strings\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> jsonStream = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        &#123;\"name\":\"ethancai\", \"fansCount\": 9223372036854775807&#125;</span></span><br><span class=\"line\"><span class=\"string\">    `</span></span><br><span class=\"line\"></span><br><span class=\"line\">    decoder := json.NewDecoder(strings.NewReader(jsonStream))</span><br><span class=\"line\">    decoder.UseNumber()    <span class=\"comment\">// UseNumber causes the Decoder to unmarshal a number into an interface&#123;&#125; as a Number instead of as a float64.</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err := decoder.Decode(&amp;user); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    m := user.(<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">interface</span>&#123;&#125;)</span><br><span class=\"line\">    fansCount := m[<span class=\"string\">\"fansCount\"</span>]</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, reflect.TypeOf(fansCount).PkgPath() + <span class=\"string\">\".\"</span> + reflect.TypeOf(fansCount).Name())</span><br><span class=\"line\"></span><br><span class=\"line\">     v, err := fansCount.(json.Number).Int64()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, v)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output:</span></span><br><span class=\"line\"><span class=\"comment\">// \tencoding/json.Number</span></span><br><span class=\"line\"><span class=\"comment\">// \t9223372036854775807</span></span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/KYrFshVMFD\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>func (*Decoder) UseNumber</code>JSON<code>float64</code><code>json.Number</code><code>json.Number</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// A Number represents a JSON number literal.</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Number <span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// String returns the literal text of the number.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n Number)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123; <span class=\"keyword\">return</span> <span class=\"keyword\">string</span>(n) &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Float64 returns the number as a float64.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n Number)</span> <span class=\"title\">Float64</span><span class=\"params\">()</span> <span class=\"params\">(<span class=\"keyword\">float64</span>, error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> strconv.ParseFloat(<span class=\"keyword\">string</span>(n), <span class=\"number\">64</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Int64 returns the number as an int64.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n Number)</span> <span class=\"title\">Int64</span><span class=\"params\">()</span> <span class=\"params\">(<span class=\"keyword\">int64</span>, error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> strconv.ParseInt(<span class=\"keyword\">string</span>(n), <span class=\"number\">10</span>, <span class=\"number\">64</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>json.Number</code>JSON<code>json.Number</code><code>json.Number</code><code>float64</code><code>int64</code></p>\n<p>GolangJSON</p>\n<p>JavaScript<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Numbers_and_dates\" target=\"_blank\" rel=\"noopener\"></a>JSONJSONJavaScript Object NotationJavaScriptDouglas CrockfordJavaScript<a href=\"http://www.infoq.com/cn/news/2010/02/qconbeijing2010-douglas\" target=\"_blank\" rel=\"noopener\">Douglas Crockford</a></p>\n<p>C#JSONlibrary <a href=\"http://www.newtonsoft.com/json\" target=\"_blank\" rel=\"noopener\">Json.NET</a>JSONGolang</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">using System;</span><br><span class=\"line\">using Newtonsoft.Json;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Program</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static void Main()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        string json = @&quot;&#123;</span><br><span class=\"line\">  &apos;Name&apos;: &apos;Ethan&apos;,</span><br><span class=\"line\">  &apos;FansCount&apos;: 121211,</span><br><span class=\"line\">  &apos;Price&apos;: 99.99</span><br><span class=\"line\">&#125;&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">        Product m = JsonConvert.DeserializeObject&lt;Product&gt;(json);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(m.FansCount);</span><br><span class=\"line\">        Console.WriteLine(m.FansCount.GetType().FullName);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(m.Price);</span><br><span class=\"line\">        Console.WriteLine(m.Price.GetType().FullName);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Product</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public string Name</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public object FansCount</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public object Price</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// Output:</span><br><span class=\"line\">//      121211</span><br><span class=\"line\">//      System.Int64</span><br><span class=\"line\">//      99.99</span><br><span class=\"line\">//      System.Double</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://dotnetfiddle.net/IrlMae\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>Json.NET</code></p>\n<h2 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h2><p>JSONlibrary</p>\n<p>Go</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">type</span> Product <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        Name      <span class=\"keyword\">string</span></span><br><span class=\"line\">        CreatedAt time.Time</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    pdt := Product&#123;</span><br><span class=\"line\">        Name:      <span class=\"string\">\"Reds\"</span>,</span><br><span class=\"line\">        CreatedAt: time.Now(),</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    b, err := json.Marshal(pdt)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    os.Stdout.Write(b)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// Output</span></span><br><span class=\"line\"><span class=\"comment\">//      &#123;\"Name\":\"Reds\",\"CreatedAt\":\"2016-06-27T07:40:54.69292134+08:00\"&#125;</span></span><br></pre></td></tr></table></figure>\n<p>JavaScript</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  ~ node</span><br><span class=\"line\">&gt; var jo = &#123; name: <span class=\"string\">\"ethan\"</span>, createdAt: Date.now() &#125;;</span><br><span class=\"line\">undefined</span><br><span class=\"line\">&gt; JSON.stringify(jo)</span><br><span class=\"line\"><span class=\"string\">'&#123;\"name\":\"ethan\",\"createdAt\":1466984665633&#125;'</span></span><br></pre></td></tr></table></figure>\n<p>C#</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">using System;</span><br><span class=\"line\">using Newtonsoft.Json;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Program</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static void Main()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Product product = new Product();</span><br><span class=\"line\">        product.Name = &quot;Apple&quot;;</span><br><span class=\"line\">        product.CreatedAt = DateTime.Now;</span><br><span class=\"line\"></span><br><span class=\"line\">        string json = JsonConvert.SerializeObject(product,</span><br><span class=\"line\">                            Newtonsoft.Json.Formatting.Indented,</span><br><span class=\"line\">                            new JsonSerializerSettings &#123;</span><br><span class=\"line\">                                NullValueHandling = NullValueHandling.Ignore</span><br><span class=\"line\">                            &#125;);</span><br><span class=\"line\">        Console.WriteLine(json);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Product</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public string Name</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public DateTime CreatedAt</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// Output:</span><br><span class=\"line\">//      &#123;</span><br><span class=\"line\">//        &quot;Name&quot;: &quot;Apple&quot;,</span><br><span class=\"line\">//        &quot;CreatedAt&quot;: &quot;2016-06-26T23:46:57.3244307+00:00&quot;</span><br><span class=\"line\">//      &#125;</span><br></pre></td></tr></table></figure>\n<p>Go<code>encoding/json</code> packageC#Json.NET<a href=\"http://www.w3.org/TR/NOTE-datetime\" target=\"_blank\" rel=\"noopener\">ISO 8601</a>JavaScript<code>Date</code>197011000JavaScript<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString\" target=\"_blank\" rel=\"noopener\"><code>dateObj.toISOString()</code></a>ISO<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/parse\" target=\"_blank\" rel=\"noopener\"><code>Date.parse(dateString)</code></a>ISO</p>\n<p>ISOGo<code>time.Time</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Time <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// sec gives the number of seconds elapsed since</span></span><br><span class=\"line\">    <span class=\"comment\">// January 1, year 1 00:00:00 UTC.</span></span><br><span class=\"line\">    sec <span class=\"keyword\">int64</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// nsec specifies a non-negative nanosecond</span></span><br><span class=\"line\">    <span class=\"comment\">// offset within the second named by Seconds.</span></span><br><span class=\"line\">    <span class=\"comment\">// It must be in the range [0, 999999999].</span></span><br><span class=\"line\">    nsec <span class=\"keyword\">int32</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// loc specifies the Location that should be used to</span></span><br><span class=\"line\">    <span class=\"comment\">// determine the minute, hour, month, day, and year</span></span><br><span class=\"line\">    <span class=\"comment\">// that correspond to this Time.</span></span><br><span class=\"line\">    <span class=\"comment\">// Only the zero Time has a nil Location.</span></span><br><span class=\"line\">    <span class=\"comment\">// In that case it is interpreted to mean UTC.</span></span><br><span class=\"line\">    loc *Location</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>JSON</p>\n<ul>\n<li>.NET FrameworkJSON<code>&quot;\\/Date(1343660352227+0530)\\/&quot;</code></li>\n<li>ISO</li>\n<li><code>1970-1-1 00:00:00 UTC</code><code>1970-1-1 00:00:00</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li><a href=\"http://docs.studygolang.com/pkg/encoding/json/\" target=\"_blank\" rel=\"noopener\">package encoding/json in Go</a></li>\n<li><a href=\"http://docs.studygolang.com/src/encoding/json/example_test.go\" target=\"_blank\" rel=\"noopener\">http://docs.studygolang.com/src/encoding/json/example_test.go</a></li>\n<li><a href=\"https://blog.golang.org/json-and-go\" target=\"_blank\" rel=\"noopener\">The Go Blog: JSON and Go</a></li>\n<li><a href=\"https://gobyexample.com/json\" target=\"_blank\" rel=\"noopener\">Go by example: JSON</a></li>\n<li><a href=\"http://attilaolah.eu/2013/11/29/json-decoding-in-go/\" target=\"_blank\" rel=\"noopener\">JSON decoding in Go</a></li>\n<li><a href=\"https://eager.io/blog/go-and-json/\" target=\"_blank\" rel=\"noopener\">go and json</a></li>\n<li><a href=\"https://www.goinggo.net/2014/01/decode-json-documents-in-go.html\" target=\"_blank\" rel=\"noopener\">Decode JSON Documents In Go</a></li>\n<li><a href=\"https://journal.paul.querna.org/articles/2014/03/31/ffjson-faster-json-in-go/\" target=\"_blank\" rel=\"noopener\">ffjson: faster JSON serialization for Golang</a></li>\n<li><a href=\"http://www.slideshare.net/albertstrasheim/serialization-in-go\" target=\"_blank\" rel=\"noopener\">Serialization in Go</a></li>\n</ul>\n<p></p>\n<ul>\n<li><a href=\"https://github.com/pquerna/ffjson\" target=\"_blank\" rel=\"noopener\">ffjson</a>: faster JSON serialization for Go</li>\n<li><a href=\"https://github.com/bitly/go-simplejson\" target=\"_blank\" rel=\"noopener\">go-simplejson</a>: a Go package to interact with arbitrary JSON</li>\n<li><a href=\"https://github.com/antonholmquist/jason\" target=\"_blank\" rel=\"noopener\">Jason</a>: Easy-to-use JSON Library for Go</li>\n<li><a href=\"https://github.com/mailru/easyjson\" target=\"_blank\" rel=\"noopener\">easyjson</a></li>\n<li><a href=\"https://github.com/Jeffail/gabs\" target=\"_blank\" rel=\"noopener\">gabs</a></li>\n<li><a href=\"https://github.com/buger/jsonparser\" target=\"_blank\" rel=\"noopener\">jsonparser</a></li>\n</ul>\n<p></p>\n<ul>\n<li><a href=\"https://mholt.github.io/json-to-go/\" target=\"_blank\" rel=\"noopener\">JSON-to-Go</a>: instantly converts JSON into a Go type definition</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>GolangJSON</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1omitempty\"><a href=\"#1omitempty\" class=\"headerlink\" title=\"1omitempty\"></a>1<code>omitempty</code></h2><p>C#JSON<code>Newtonsoft.Json</code>JSONJSON<code>property annotation</code><code>ShouldSerialize method</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ShouldSerialize methodObsoleteSetting</span><br><span class=\"line\">class Config</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public Fizz ObsoleteSetting &#123; get; set; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public bool ShouldSerializeObsoleteSetting()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// JsonIgnoreannotationObsoleteSetting</span><br><span class=\"line\">class Config</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    [JsonIgnore]</span><br><span class=\"line\">    public Fizz ObsoleteSetting &#123; get; set; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Bang ReplacementSetting &#123; get; set; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Newtonsoft.Json</code>Conditional Property Serialization</p>\n<ul>\n<li><a href=\"http://www.newtonsoft.com/json/help/html/ConditionalProperties.htm\" target=\"_blank\" rel=\"noopener\">Conditional Property Serialization</a></li>\n<li><a href=\"http://stackoverflow.com/questions/11564091/making-a-property-deserialize-but-not-serialize-with-json-net\" target=\"_blank\" rel=\"noopener\">Making a property deserialize but not serialize with json.net</a></li>\n</ul>\n<p>Golang<code>omitempty</code>C#<a href=\"http://docs.studygolang.com/pkg/encoding/json/#Marshal\" target=\"_blank\" rel=\"noopener\">encoding/json package</a><code>omitempty</code></p>\n<blockquote>\n<p>Struct values encode as JSON objects. Each exported struct field becomes a member of the object unless</p>\n<ul>\n<li>the fields tag is -, or</li>\n<li>the field is empty and its tag specifies the omitempty option.</li>\n</ul>\n<p>The empty values are false, 0, any nil pointer or interface value, and any array, slice, map, or string of length zero. The objects default key string is the struct field name but can be specified in the struct fields tag value. The json key in the struct fields tag value is the key name, followed by an optional comma and options. Examples:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"comment\">// Field is ignored by this package.</span></span><br><span class=\"line\">&gt; Field <span class=\"keyword\">int</span> <span class=\"string\">`json:\"-\"`</span></span><br><span class=\"line\">&gt;</span><br><span class=\"line\">&gt; <span class=\"comment\">// Field appears in JSON as key \"myName\".</span></span><br><span class=\"line\">&gt; Field <span class=\"keyword\">int</span> <span class=\"string\">`json:\"myName\"`</span></span><br><span class=\"line\">&gt;</span><br><span class=\"line\">&gt; <span class=\"comment\">// Field appears in JSON as key \"myName\" and</span></span><br><span class=\"line\">&gt; <span class=\"comment\">// the field is omitted from the object if its value is empty,</span></span><br><span class=\"line\">&gt; <span class=\"comment\">// as defined above.</span></span><br><span class=\"line\">&gt; Field <span class=\"keyword\">int</span> <span class=\"string\">`json:\"myName,omitempty\"`</span></span><br><span class=\"line\">&gt;</span><br><span class=\"line\">&gt; <span class=\"comment\">// Field appears in JSON as key \"Field\" (the default), but</span></span><br><span class=\"line\">&gt; <span class=\"comment\">// the field is skipped if empty.</span></span><br><span class=\"line\">&gt; <span class=\"comment\">// Note the leading comma.</span></span><br><span class=\"line\">&gt; Field <span class=\"keyword\">int</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>Golang<code>field</code>JSON<code>-</code><code>field</code><code>JsonIgnore</code></p>\n<p><code>omitempty</code><code>field</code><code>empty</code>JSON<code>field</code><code>Newtonsoft.Json</code><a href=\"http://stackoverflow.com/questions/6507889/how-to-ignore-a-property-in-class-if-null-using-json-net\" target=\"_blank\" rel=\"noopener\"></a><a href=\"https://dotnetfiddle.net/VXqRnm\" target=\"_blank\" rel=\"noopener\"></a><code>emtpty</code></p>\n<blockquote>\n<p>The empty values are false, 0, any nil pointer or interface value, and any array, slice, map, or string of length zero.</p>\n</blockquote>\n<p><code>empty values</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"bytes\"</span></span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> S1 <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    I1 <span class=\"keyword\">int</span></span><br><span class=\"line\">    I2 <span class=\"keyword\">int</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    F1 <span class=\"keyword\">float64</span></span><br><span class=\"line\">    F2 <span class=\"keyword\">float64</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    S1 <span class=\"keyword\">string</span></span><br><span class=\"line\">    S2 <span class=\"keyword\">string</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    B1 <span class=\"keyword\">bool</span></span><br><span class=\"line\">    B2 <span class=\"keyword\">bool</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    Slice1 []<span class=\"keyword\">int</span></span><br><span class=\"line\">    Slice2 []<span class=\"keyword\">int</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    Slice3 []<span class=\"keyword\">int</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    Map1 <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span></span><br><span class=\"line\">    Map2 <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    Map3 <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    O1 <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\">    O2 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O3 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O4 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O5 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O6 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O7 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    O8 <span class=\"keyword\">interface</span>&#123;&#125; <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\"></span><br><span class=\"line\">    P1 *<span class=\"keyword\">int</span></span><br><span class=\"line\">    P2 *<span class=\"keyword\">int</span>               <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P3 *<span class=\"keyword\">int</span>               <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P4 *<span class=\"keyword\">float64</span>           <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P5 *<span class=\"keyword\">string</span>            <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P6 *<span class=\"keyword\">bool</span>              <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P7 *[]<span class=\"keyword\">int</span>             <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">    P8 *<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span> <span class=\"string\">`json:\",omitempty\"`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    p3 := <span class=\"number\">0</span></span><br><span class=\"line\">    p4 := <span class=\"keyword\">float64</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">    p5 := <span class=\"string\">\"\"</span></span><br><span class=\"line\">    p6 := <span class=\"literal\">false</span></span><br><span class=\"line\">    p7 := []<span class=\"keyword\">int</span>&#123;&#125;</span><br><span class=\"line\">    p8 := <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    s1 := S1&#123;</span><br><span class=\"line\">        I1: <span class=\"number\">0</span>,</span><br><span class=\"line\">        I2: <span class=\"number\">0</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        F1: <span class=\"number\">0</span>,</span><br><span class=\"line\">        F2: <span class=\"number\">0</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        S1: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        S2: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        B1: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        B2: <span class=\"literal\">false</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">        Slice1: []<span class=\"keyword\">int</span>&#123;&#125;,</span><br><span class=\"line\">        Slice2: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        Slice3: []<span class=\"keyword\">int</span>&#123;&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">        Map1: <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span>&#123;&#125;,</span><br><span class=\"line\">        Map2: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        Map3: <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span>&#123;&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">        O1: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        O2: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        O3: <span class=\"keyword\">int</span>(<span class=\"number\">0</span>),</span><br><span class=\"line\">        O4: <span class=\"keyword\">float64</span>(<span class=\"number\">0</span>),</span><br><span class=\"line\">        O5: <span class=\"string\">\"\"</span>,</span><br><span class=\"line\">        O6: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        O7: []<span class=\"keyword\">int</span>&#123;&#125;,</span><br><span class=\"line\">        O8: <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">string</span>&#123;&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">        P1: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        P2: <span class=\"literal\">nil</span>,</span><br><span class=\"line\">        P3: &amp;p3,</span><br><span class=\"line\">        P4: &amp;p4,</span><br><span class=\"line\">        P5: &amp;p5,</span><br><span class=\"line\">        P6: &amp;p6,</span><br><span class=\"line\">        P7: &amp;p7,</span><br><span class=\"line\">        P8: &amp;p8,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    b, err := json.Marshal(s1)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Printf(<span class=\"string\">\"marshal error: %v\"</span>, err)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> out bytes.Buffer</span><br><span class=\"line\">    json.Indent(&amp;out, b, <span class=\"string\">\"\"</span>, <span class=\"string\">\"\\t\"</span>)</span><br><span class=\"line\">    out.WriteTo(os.Stdout)</span><br><span class=\"line\">    <span class=\"comment\">//Output:</span></span><br><span class=\"line\">    <span class=\"comment\">//&#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"I1\": 0,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"F1\": 0,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"S1\": \"\",</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"B1\": false,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"Slice1\": [],</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"Map1\": &#123;&#125;,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O1\": null,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O3\": 0,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O4\": 0,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O5\": \"\",</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O6\": false,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O7\": [],</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"O8\": &#123;&#125;,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"P1\": null,</span></span><br><span class=\"line\">    <span class=\"comment\">//\t\"P2\": 0</span></span><br><span class=\"line\">    <span class=\"comment\">//&#125;%</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/6y_m27r8EO\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>empty value</code></p>\n<p>AppRestful APIResponse<code>User</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    ID        <span class=\"keyword\">int</span> <span class=\"string\">`json:\"id\"`</span>                  <span class=\"comment\">// id</span></span><br><span class=\"line\">    <span class=\"comment\">// field</span></span><br><span class=\"line\">    FansCount <span class=\"keyword\">int</span> <span class=\"string\">`json:\"fansCount,omitempty\"`</span> <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>AppRestful APIResponse</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"id\"</span>: <span class=\"number\">1000386</span>,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ResponseUser<code>fansCount</code><code>fansCount</code><code>int</code>0<code>User</code><code>fansCount</code><strong></strong><strong></strong></p>\n<p><strong></strong><strong></strong><code>User</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    ID        <span class=\"keyword\">int</span>  <span class=\"string\">`json:\"id\"`</span>                  <span class=\"comment\">// id</span></span><br><span class=\"line\">    <span class=\"comment\">// field</span></span><br><span class=\"line\">    FansCount *<span class=\"keyword\">int</span> <span class=\"string\">`json:\"fansCount,omitempty\"`</span> <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>FansCount</code><code>nil</code>0</p>\n<p><code>FansCount</code><code>FansCount</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// FansCountint</span></span><br><span class=\"line\">user := dataAccess.GetUserInfo(userId)</span><br><span class=\"line\">user.FansCount = dataAccess.GetFansCount(userId)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// FansCount*int</span></span><br><span class=\"line\">user := dataAccess.GetUserInfo(userId)</span><br><span class=\"line\">fansCount := dataAccess.GetFansCount(userId)</span><br><span class=\"line\">user.FansCount = &amp;fansCount</span><br></pre></td></tr></table></figure>\n<h2 id=\"2JSONinterface-Number\"><a href=\"#2JSONinterface-Number\" class=\"headerlink\" title=\"2JSONinterface{}Number\"></a>2JSONinterface{}Number</h2><p><a href=\"http://json.org/\" target=\"_blank\" rel=\"noopener\">JSON</a></p>\n<p><img src=\"http://json.org/value.gif\" alt=\"\"></p>\n<p>JSON:</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"ethancai\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"fansCount\"</span>: <span class=\"number\">9223372036854775807</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Name      <span class=\"keyword\">string</span></span><br><span class=\"line\">    FansCount <span class=\"keyword\">int64</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> jsonStream = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        &#123;\"name\":\"ethancai\", \"fansCount\": 9223372036854775807&#125;</span></span><br><span class=\"line\"><span class=\"string\">    `</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user User  <span class=\"comment\">// User</span></span><br><span class=\"line\">    err := json.Unmarshal([]<span class=\"keyword\">byte</span>(jsonStream), &amp;user)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, user)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// Output:</span></span><br><span class=\"line\"><span class=\"comment\">//  &#123;Name:ethancai FansCount:9223372036854775807&#125;</span></span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/203egccrea\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p>JSON<code>float64</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> jsonStream = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        &#123;\"name\":\"ethancai\", \"fansCount\": 9223372036854775807&#125;</span></span><br><span class=\"line\"><span class=\"string\">    `</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user <span class=\"keyword\">interface</span>&#123;&#125;  <span class=\"comment\">// </span></span><br><span class=\"line\">    err := json.Unmarshal([]<span class=\"keyword\">byte</span>(jsonStream), &amp;user)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    m := user.(<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">interface</span>&#123;&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    fansCount := m[<span class=\"string\">\"fansCount\"</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, reflect.TypeOf(fansCount).Name())</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, fansCount.(<span class=\"keyword\">float64</span>))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output:</span></span><br><span class=\"line\"><span class=\"comment\">// \tfloat64</span></span><br><span class=\"line\"><span class=\"comment\">//  \t9.223372036854776e+18</span></span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/l4GzgA4WDA\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    Name      <span class=\"keyword\">string</span></span><br><span class=\"line\">    FansCount <span class=\"keyword\">interface</span>&#123;&#125;  <span class=\"comment\">// FansCount</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> jsonStream = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        &#123;\"name\":\"ethancai\", \"fansCount\": 9223372036854775807&#125;</span></span><br><span class=\"line\"><span class=\"string\">    `</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user User</span><br><span class=\"line\">    err := json.Unmarshal([]<span class=\"keyword\">byte</span>(jsonStream), &amp;user)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, user)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output:</span></span><br><span class=\"line\"><span class=\"comment\">// \t&#123;Name:ethancai FansCount:9.223372036854776e+18&#125;</span></span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/SoD6SOGuCM\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>fansCount</code><code>float64</code></p>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">    <span class=\"string\">\"strings\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> jsonStream = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        &#123;\"name\":\"ethancai\", \"fansCount\": 9223372036854775807&#125;</span></span><br><span class=\"line\"><span class=\"string\">    `</span></span><br><span class=\"line\"></span><br><span class=\"line\">    decoder := json.NewDecoder(strings.NewReader(jsonStream))</span><br><span class=\"line\">    decoder.UseNumber()    <span class=\"comment\">// UseNumber causes the Decoder to unmarshal a number into an interface&#123;&#125; as a Number instead of as a float64.</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user <span class=\"keyword\">interface</span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err := decoder.Decode(&amp;user); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    m := user.(<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>]<span class=\"keyword\">interface</span>&#123;&#125;)</span><br><span class=\"line\">    fansCount := m[<span class=\"string\">\"fansCount\"</span>]</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, reflect.TypeOf(fansCount).PkgPath() + <span class=\"string\">\".\"</span> + reflect.TypeOf(fansCount).Name())</span><br><span class=\"line\"></span><br><span class=\"line\">     v, err := fansCount.(json.Number).Int64()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%+v \\n\"</span>, v)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Output:</span></span><br><span class=\"line\"><span class=\"comment\">// \tencoding/json.Number</span></span><br><span class=\"line\"><span class=\"comment\">// \t9223372036854775807</span></span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/KYrFshVMFD\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>func (*Decoder) UseNumber</code>JSON<code>float64</code><code>json.Number</code><code>json.Number</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// A Number represents a JSON number literal.</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Number <span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// String returns the literal text of the number.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n Number)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123; <span class=\"keyword\">return</span> <span class=\"keyword\">string</span>(n) &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Float64 returns the number as a float64.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n Number)</span> <span class=\"title\">Float64</span><span class=\"params\">()</span> <span class=\"params\">(<span class=\"keyword\">float64</span>, error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> strconv.ParseFloat(<span class=\"keyword\">string</span>(n), <span class=\"number\">64</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Int64 returns the number as an int64.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(n Number)</span> <span class=\"title\">Int64</span><span class=\"params\">()</span> <span class=\"params\">(<span class=\"keyword\">int64</span>, error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> strconv.ParseInt(<span class=\"keyword\">string</span>(n), <span class=\"number\">10</span>, <span class=\"number\">64</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>json.Number</code>JSON<code>json.Number</code><code>json.Number</code><code>float64</code><code>int64</code></p>\n<p>GolangJSON</p>\n<p>JavaScript<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Numbers_and_dates\" target=\"_blank\" rel=\"noopener\"></a>JSONJSONJavaScript Object NotationJavaScriptDouglas CrockfordJavaScript<a href=\"http://www.infoq.com/cn/news/2010/02/qconbeijing2010-douglas\" target=\"_blank\" rel=\"noopener\">Douglas Crockford</a></p>\n<p>C#JSONlibrary <a href=\"http://www.newtonsoft.com/json\" target=\"_blank\" rel=\"noopener\">Json.NET</a>JSONGolang</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">using System;</span><br><span class=\"line\">using Newtonsoft.Json;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Program</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static void Main()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        string json = @&quot;&#123;</span><br><span class=\"line\">  &apos;Name&apos;: &apos;Ethan&apos;,</span><br><span class=\"line\">  &apos;FansCount&apos;: 121211,</span><br><span class=\"line\">  &apos;Price&apos;: 99.99</span><br><span class=\"line\">&#125;&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">        Product m = JsonConvert.DeserializeObject&lt;Product&gt;(json);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(m.FansCount);</span><br><span class=\"line\">        Console.WriteLine(m.FansCount.GetType().FullName);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(m.Price);</span><br><span class=\"line\">        Console.WriteLine(m.Price.GetType().FullName);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Product</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public string Name</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public object FansCount</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public object Price</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// Output:</span><br><span class=\"line\">//      121211</span><br><span class=\"line\">//      System.Int64</span><br><span class=\"line\">//      99.99</span><br><span class=\"line\">//      System.Double</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://dotnetfiddle.net/IrlMae\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>Json.NET</code></p>\n<h2 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h2><p>JSONlibrary</p>\n<p>Go</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"os\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">type</span> Product <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        Name      <span class=\"keyword\">string</span></span><br><span class=\"line\">        CreatedAt time.Time</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    pdt := Product&#123;</span><br><span class=\"line\">        Name:      <span class=\"string\">\"Reds\"</span>,</span><br><span class=\"line\">        CreatedAt: time.Now(),</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    b, err := json.Marshal(pdt)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"error:\"</span>, err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    os.Stdout.Write(b)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// Output</span></span><br><span class=\"line\"><span class=\"comment\">//      &#123;\"Name\":\"Reds\",\"CreatedAt\":\"2016-06-27T07:40:54.69292134+08:00\"&#125;</span></span><br></pre></td></tr></table></figure>\n<p>JavaScript</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  ~ node</span><br><span class=\"line\">&gt; var jo = &#123; name: <span class=\"string\">\"ethan\"</span>, createdAt: Date.now() &#125;;</span><br><span class=\"line\">undefined</span><br><span class=\"line\">&gt; JSON.stringify(jo)</span><br><span class=\"line\"><span class=\"string\">'&#123;\"name\":\"ethan\",\"createdAt\":1466984665633&#125;'</span></span><br></pre></td></tr></table></figure>\n<p>C#</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">using System;</span><br><span class=\"line\">using Newtonsoft.Json;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Program</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static void Main()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Product product = new Product();</span><br><span class=\"line\">        product.Name = &quot;Apple&quot;;</span><br><span class=\"line\">        product.CreatedAt = DateTime.Now;</span><br><span class=\"line\"></span><br><span class=\"line\">        string json = JsonConvert.SerializeObject(product,</span><br><span class=\"line\">                            Newtonsoft.Json.Formatting.Indented,</span><br><span class=\"line\">                            new JsonSerializerSettings &#123;</span><br><span class=\"line\">                                NullValueHandling = NullValueHandling.Ignore</span><br><span class=\"line\">                            &#125;);</span><br><span class=\"line\">        Console.WriteLine(json);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Product</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public string Name</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public DateTime CreatedAt</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        get;</span><br><span class=\"line\">        set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// Output:</span><br><span class=\"line\">//      &#123;</span><br><span class=\"line\">//        &quot;Name&quot;: &quot;Apple&quot;,</span><br><span class=\"line\">//        &quot;CreatedAt&quot;: &quot;2016-06-26T23:46:57.3244307+00:00&quot;</span><br><span class=\"line\">//      &#125;</span><br></pre></td></tr></table></figure>\n<p>Go<code>encoding/json</code> packageC#Json.NET<a href=\"http://www.w3.org/TR/NOTE-datetime\" target=\"_blank\" rel=\"noopener\">ISO 8601</a>JavaScript<code>Date</code>197011000JavaScript<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString\" target=\"_blank\" rel=\"noopener\"><code>dateObj.toISOString()</code></a>ISO<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/parse\" target=\"_blank\" rel=\"noopener\"><code>Date.parse(dateString)</code></a>ISO</p>\n<p>ISOGo<code>time.Time</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Time <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// sec gives the number of seconds elapsed since</span></span><br><span class=\"line\">    <span class=\"comment\">// January 1, year 1 00:00:00 UTC.</span></span><br><span class=\"line\">    sec <span class=\"keyword\">int64</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// nsec specifies a non-negative nanosecond</span></span><br><span class=\"line\">    <span class=\"comment\">// offset within the second named by Seconds.</span></span><br><span class=\"line\">    <span class=\"comment\">// It must be in the range [0, 999999999].</span></span><br><span class=\"line\">    nsec <span class=\"keyword\">int32</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// loc specifies the Location that should be used to</span></span><br><span class=\"line\">    <span class=\"comment\">// determine the minute, hour, month, day, and year</span></span><br><span class=\"line\">    <span class=\"comment\">// that correspond to this Time.</span></span><br><span class=\"line\">    <span class=\"comment\">// Only the zero Time has a nil Location.</span></span><br><span class=\"line\">    <span class=\"comment\">// In that case it is interpreted to mean UTC.</span></span><br><span class=\"line\">    loc *Location</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>JSON</p>\n<ul>\n<li>.NET FrameworkJSON<code>&quot;\\/Date(1343660352227+0530)\\/&quot;</code></li>\n<li>ISO</li>\n<li><code>1970-1-1 00:00:00 UTC</code><code>1970-1-1 00:00:00</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li><a href=\"http://docs.studygolang.com/pkg/encoding/json/\" target=\"_blank\" rel=\"noopener\">package encoding/json in Go</a></li>\n<li><a href=\"http://docs.studygolang.com/src/encoding/json/example_test.go\" target=\"_blank\" rel=\"noopener\">http://docs.studygolang.com/src/encoding/json/example_test.go</a></li>\n<li><a href=\"https://blog.golang.org/json-and-go\" target=\"_blank\" rel=\"noopener\">The Go Blog: JSON and Go</a></li>\n<li><a href=\"https://gobyexample.com/json\" target=\"_blank\" rel=\"noopener\">Go by example: JSON</a></li>\n<li><a href=\"http://attilaolah.eu/2013/11/29/json-decoding-in-go/\" target=\"_blank\" rel=\"noopener\">JSON decoding in Go</a></li>\n<li><a href=\"https://eager.io/blog/go-and-json/\" target=\"_blank\" rel=\"noopener\">go and json</a></li>\n<li><a href=\"https://www.goinggo.net/2014/01/decode-json-documents-in-go.html\" target=\"_blank\" rel=\"noopener\">Decode JSON Documents In Go</a></li>\n<li><a href=\"https://journal.paul.querna.org/articles/2014/03/31/ffjson-faster-json-in-go/\" target=\"_blank\" rel=\"noopener\">ffjson: faster JSON serialization for Golang</a></li>\n<li><a href=\"http://www.slideshare.net/albertstrasheim/serialization-in-go\" target=\"_blank\" rel=\"noopener\">Serialization in Go</a></li>\n</ul>\n<p></p>\n<ul>\n<li><a href=\"https://github.com/pquerna/ffjson\" target=\"_blank\" rel=\"noopener\">ffjson</a>: faster JSON serialization for Go</li>\n<li><a href=\"https://github.com/bitly/go-simplejson\" target=\"_blank\" rel=\"noopener\">go-simplejson</a>: a Go package to interact with arbitrary JSON</li>\n<li><a href=\"https://github.com/antonholmquist/jason\" target=\"_blank\" rel=\"noopener\">Jason</a>: Easy-to-use JSON Library for Go</li>\n<li><a href=\"https://github.com/mailru/easyjson\" target=\"_blank\" rel=\"noopener\">easyjson</a></li>\n<li><a href=\"https://github.com/Jeffail/gabs\" target=\"_blank\" rel=\"noopener\">gabs</a></li>\n<li><a href=\"https://github.com/buger/jsonparser\" target=\"_blank\" rel=\"noopener\">jsonparser</a></li>\n</ul>\n<p></p>\n<ul>\n<li><a href=\"https://mholt.github.io/json-to-go/\" target=\"_blank\" rel=\"noopener\">JSON-to-Go</a>: instantly converts JSON into a Go type definition</li>\n</ul>\n"},{"title":"","date":"2016-08-16T15:49:25.000Z","_content":"\n_..._\n\n# (Security)\n\n- **** [Green Lights Forever: Analyzing the Security of Traffic Infrastructure](https://www.usenix.org/system/files/conference/woot14/woot14-ghena.pdf)\n","source":"_posts/collected-papers.md","raw":"---\ntitle: \ntags:\n  - \ncategories:\n  - \ndate: 2016-08-16 23:49:25\n---\n\n_..._\n\n# (Security)\n\n- **** [Green Lights Forever: Analyzing the Security of Traffic Infrastructure](https://www.usenix.org/system/files/conference/woot14/woot14-ghena.pdf)\n","slug":"collected-papers","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24i0008v7e8j5sqe4zb","content":"<p><em></em></p>\n<h1 id=\"-Security\"><a href=\"#-Security\" class=\"headerlink\" title=\"(Security)\"></a>(Security)</h1><ul>\n<li><strong></strong> <a href=\"https://www.usenix.org/system/files/conference/woot14/woot14-ghena.pdf\" target=\"_blank\" rel=\"noopener\">Green Lights Forever: Analyzing the Security of Traffic Infrastructure</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><em></em></p>\n<h1 id=\"-Security\"><a href=\"#-Security\" class=\"headerlink\" title=\"(Security)\"></a>(Security)</h1><ul>\n<li><strong></strong> <a href=\"https://www.usenix.org/system/files/conference/woot14/woot14-ghena.pdf\" target=\"_blank\" rel=\"noopener\">Green Lights Forever: Analyzing the Security of Traffic Infrastructure</a></li>\n</ul>\n"},{"title":"Ubuntu Server 14.04MongoDB","date":"2016-11-01T04:59:40.000Z","_content":"\n\n# Ubuntu Server 14.04MongoDB 3.2.6\n\n- Import the public key used by the package management system\n    - `sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927`\n- Create a list file for MongoDB\n    - `echo \"deb http://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.2 multiverse\" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list`\n- Reload local package database\n    - `sudo apt-get update`\n- Install the MongoDB packages\n    - `sudo apt-get install -y mongodb-org=3.2.6 mongodb-org-server=3.2.6 mongodb-org-shell=3.2.6 mongodb-org-mongos=3.2.6 mongodb-org-tools=3.2.6`\n- Pin a specific version of MongoDB\n```sh\necho \"mongodb-org hold\" | sudo dpkg --set-selections\necho \"mongodb-org-server hold\" | sudo dpkg --set-selections\necho \"mongodb-org-shell hold\" | sudo dpkg --set-selections\necho \"mongodb-org-mongos hold\" | sudo dpkg --set-selections\necho \"mongodb-org-tools hold\" | sudo dpkg --set-selections\n```\n- MongoDB`/etc/mongod.conf`\n    - `net.bindIp``0.0.0.0`\n    - \n    ```yaml\n    storage:\n      directoryPerDB: true\n    ```\n- MongoDB\n    - `sudo service mongod restart`\n    - `mongo`\n- Disable Transparent Huge Pages[](https://docs.mongodb.com/manual/tutorial/transparent-huge-pages/)\n    - Create the init.d script\n    ```sh\n    #!/bin/sh\n    ### BEGIN INIT INFO\n    # Provides:          disable-transparent-hugepages\n    # Required-Start:    $local_fs\n    # Required-Stop:\n    # X-Start-Before:    mongod mongodb-mms-automation-agent\n    # Default-Start:     2 3 4 5\n    # Default-Stop:      0 1 6\n    # Short-Description: Disable Linux transparent huge pages\n    # Description:       Disable Linux transparent huge pages, to improve\n    #                    database performance.\n    ### END INIT INFO\n\n    case $1 in\n      start)\n        if [ -d /sys/kernel/mm/transparent_hugepage ]; then\n          thp_path=/sys/kernel/mm/transparent_hugepage\n        elif [ -d /sys/kernel/mm/redhat_transparent_hugepage ]; then\n          thp_path=/sys/kernel/mm/redhat_transparent_hugepage\n        else\n          return 0\n        fi\n\n        echo 'never' > ${thp_path}/enabled\n        echo 'never' > ${thp_path}/defrag\n\n        unset thp_path\n        ;;\n    esac\n    ```\n    - Make it executable\n    ```sh\n    sudo chmod 755 /etc/init.d/disable-transparent-hugepages\n    ```\n    - Configure your operating system to run it on boot\n    ```sh\n    sudo update-rc.d disable-transparent-hugepages defaults\n    ```\n    - OS\n\n# MongoDB ReplicaSet\n\n\n\n![](https://docs.mongodb.com/manual/_images/replica-set-primary-with-secondary-and-arbiter.png)\n\n- 21\n\n## \n\n- 2ec2AB1ec2C\n- ABCMongoDB\n- AShell`mongo`\n```javascript\n$ mongo\n> admin = db.getSiblingDB(\"admin\");\n> admin.createUser({ user: \"ethan\", pwd: \"{ethan}\", roles: [{ role: \"root\", db: \"admin\" }] });\n```\n- keyfile\n    - keyfile\n        - `openssl rand -base64 755 > rs0.key`\n    - `rs0.key`ABC`/etc`\n    - `rs0.key`\n        - `chmod 400 rs0.key`\n        - `chown mongodb:mongodb /etc/rs0.key`\n- AB`/etc/mongod.conf`\n    - \n    ```yaml\n    security:\n      keyFile: \"/etc/rs0.key\"\n      authorization: enabled\n\n    replication:\n      replSetName: rs0\n    ```\n- C`/etc/mongod.conf`\n    - \n    ```yaml\n    security:\n      keyFile: \"/etc/rs0.key\"\n      authorization: enabled\n\n    replication:\n      replSetName: rs0\n    ```\n    - \n    ```yaml\n    storage:\n      journal:\n        enabled: false\n    ```\n- ABC`mongod`\n- \n    - A`mongod`\n    ```sh\n    $ mongo -u ethan -p {ethan} --authenticationDatabase admin\n    ```\n    - ReplicaSet\n    ```javascript\n    > rs.initiate()\n    > cfg = rs.conf()\n    > cfg.members[0].host = \"{AIP}:27017\"\n    > rs.reconfig(cfg)\n    > rs.add(\"{BIP}\")\n    > rs.addArb(\"{CIP}\")\n\n    // ...\n    > rs.status()  // \n    ```\n- \n```javascript\n> use {dbname};\n> db.createUser({ user: \"{}\", pwd: \"{}\", roles: [{ role: \"readWrite\", db: \"{dbname}\" }] });\n```\n\n# \n\n- [Install MongoDB on Ubuntu](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/) \n    - MongoDB\n    - MongoDB`apt-get`MongoDB\n- [Enforce Keyfile Access Control in a Replica Set](https://docs.mongodb.com/manual/tutorial/enforce-keyfile-access-control-in-existing-replica-set/)\n    - Security between members of the replica set using Internal Authentication\n    - Security between connecting clients and the replica set using User Access Controls\n- [MongoDB configuration file options](https://docs.mongodb.com/manual/reference/configuration-options/#core-options)\n","source":"_posts/config-smallest-mongodb-cluster-on-ubuntu-14-04.md","raw":"---\ntitle: Ubuntu Server 14.04MongoDB\ntags:\n  - mongodb\ncategories:\n  - \ndate: 2016-11-01 12:59:40\n---\n\n\n# Ubuntu Server 14.04MongoDB 3.2.6\n\n- Import the public key used by the package management system\n    - `sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927`\n- Create a list file for MongoDB\n    - `echo \"deb http://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.2 multiverse\" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list`\n- Reload local package database\n    - `sudo apt-get update`\n- Install the MongoDB packages\n    - `sudo apt-get install -y mongodb-org=3.2.6 mongodb-org-server=3.2.6 mongodb-org-shell=3.2.6 mongodb-org-mongos=3.2.6 mongodb-org-tools=3.2.6`\n- Pin a specific version of MongoDB\n```sh\necho \"mongodb-org hold\" | sudo dpkg --set-selections\necho \"mongodb-org-server hold\" | sudo dpkg --set-selections\necho \"mongodb-org-shell hold\" | sudo dpkg --set-selections\necho \"mongodb-org-mongos hold\" | sudo dpkg --set-selections\necho \"mongodb-org-tools hold\" | sudo dpkg --set-selections\n```\n- MongoDB`/etc/mongod.conf`\n    - `net.bindIp``0.0.0.0`\n    - \n    ```yaml\n    storage:\n      directoryPerDB: true\n    ```\n- MongoDB\n    - `sudo service mongod restart`\n    - `mongo`\n- Disable Transparent Huge Pages[](https://docs.mongodb.com/manual/tutorial/transparent-huge-pages/)\n    - Create the init.d script\n    ```sh\n    #!/bin/sh\n    ### BEGIN INIT INFO\n    # Provides:          disable-transparent-hugepages\n    # Required-Start:    $local_fs\n    # Required-Stop:\n    # X-Start-Before:    mongod mongodb-mms-automation-agent\n    # Default-Start:     2 3 4 5\n    # Default-Stop:      0 1 6\n    # Short-Description: Disable Linux transparent huge pages\n    # Description:       Disable Linux transparent huge pages, to improve\n    #                    database performance.\n    ### END INIT INFO\n\n    case $1 in\n      start)\n        if [ -d /sys/kernel/mm/transparent_hugepage ]; then\n          thp_path=/sys/kernel/mm/transparent_hugepage\n        elif [ -d /sys/kernel/mm/redhat_transparent_hugepage ]; then\n          thp_path=/sys/kernel/mm/redhat_transparent_hugepage\n        else\n          return 0\n        fi\n\n        echo 'never' > ${thp_path}/enabled\n        echo 'never' > ${thp_path}/defrag\n\n        unset thp_path\n        ;;\n    esac\n    ```\n    - Make it executable\n    ```sh\n    sudo chmod 755 /etc/init.d/disable-transparent-hugepages\n    ```\n    - Configure your operating system to run it on boot\n    ```sh\n    sudo update-rc.d disable-transparent-hugepages defaults\n    ```\n    - OS\n\n# MongoDB ReplicaSet\n\n\n\n![](https://docs.mongodb.com/manual/_images/replica-set-primary-with-secondary-and-arbiter.png)\n\n- 21\n\n## \n\n- 2ec2AB1ec2C\n- ABCMongoDB\n- AShell`mongo`\n```javascript\n$ mongo\n> admin = db.getSiblingDB(\"admin\");\n> admin.createUser({ user: \"ethan\", pwd: \"{ethan}\", roles: [{ role: \"root\", db: \"admin\" }] });\n```\n- keyfile\n    - keyfile\n        - `openssl rand -base64 755 > rs0.key`\n    - `rs0.key`ABC`/etc`\n    - `rs0.key`\n        - `chmod 400 rs0.key`\n        - `chown mongodb:mongodb /etc/rs0.key`\n- AB`/etc/mongod.conf`\n    - \n    ```yaml\n    security:\n      keyFile: \"/etc/rs0.key\"\n      authorization: enabled\n\n    replication:\n      replSetName: rs0\n    ```\n- C`/etc/mongod.conf`\n    - \n    ```yaml\n    security:\n      keyFile: \"/etc/rs0.key\"\n      authorization: enabled\n\n    replication:\n      replSetName: rs0\n    ```\n    - \n    ```yaml\n    storage:\n      journal:\n        enabled: false\n    ```\n- ABC`mongod`\n- \n    - A`mongod`\n    ```sh\n    $ mongo -u ethan -p {ethan} --authenticationDatabase admin\n    ```\n    - ReplicaSet\n    ```javascript\n    > rs.initiate()\n    > cfg = rs.conf()\n    > cfg.members[0].host = \"{AIP}:27017\"\n    > rs.reconfig(cfg)\n    > rs.add(\"{BIP}\")\n    > rs.addArb(\"{CIP}\")\n\n    // ...\n    > rs.status()  // \n    ```\n- \n```javascript\n> use {dbname};\n> db.createUser({ user: \"{}\", pwd: \"{}\", roles: [{ role: \"readWrite\", db: \"{dbname}\" }] });\n```\n\n# \n\n- [Install MongoDB on Ubuntu](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/) \n    - MongoDB\n    - MongoDB`apt-get`MongoDB\n- [Enforce Keyfile Access Control in a Replica Set](https://docs.mongodb.com/manual/tutorial/enforce-keyfile-access-control-in-existing-replica-set/)\n    - Security between members of the replica set using Internal Authentication\n    - Security between connecting clients and the replica set using User Access Controls\n- [MongoDB configuration file options](https://docs.mongodb.com/manual/reference/configuration-options/#core-options)\n","slug":"config-smallest-mongodb-cluster-on-ubuntu-14-04","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24l000cv7e8zr4vypkf","content":"<h1 id=\"Ubuntu-Server-14-04MongoDB-3-2-6\"><a href=\"#Ubuntu-Server-14-04MongoDB-3-2-6\" class=\"headerlink\" title=\"Ubuntu Server 14.04MongoDB 3.2.6\"></a>Ubuntu Server 14.04MongoDB 3.2.6</h1><ul>\n<li>Import the public key used by the package management system<ul>\n<li><code>sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927</code></li>\n</ul>\n</li>\n<li>Create a list file for MongoDB<ul>\n<li><code>echo &quot;deb http://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.2 multiverse&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list</code></li>\n</ul>\n</li>\n<li>Reload local package database<ul>\n<li><code>sudo apt-get update</code></li>\n</ul>\n</li>\n<li>Install the MongoDB packages<ul>\n<li><code>sudo apt-get install -y mongodb-org=3.2.6 mongodb-org-server=3.2.6 mongodb-org-shell=3.2.6 mongodb-org-mongos=3.2.6 mongodb-org-tools=3.2.6</code></li>\n</ul>\n</li>\n<li><p>Pin a specific version of MongoDB</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org-server hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org-shell hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org-mongos hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org-tools hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>MongoDB<code>/etc/mongod.conf</code></p>\n<ul>\n<li><code>net.bindIp</code><code>0.0.0.0</code></li>\n<li><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">storage:</span></span><br><span class=\"line\"><span class=\"attr\">  directoryPerDB:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>MongoDB</p>\n<ul>\n<li><code>sudo service mongod restart</code></li>\n<li><code>mongo</code></li>\n</ul>\n</li>\n<li><p>Disable Transparent Huge Pages<a href=\"https://docs.mongodb.com/manual/tutorial/transparent-huge-pages/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<ul>\n<li><p>Create the init.d script</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/sh</span></span><br><span class=\"line\"><span class=\"comment\">### BEGIN INIT INFO</span></span><br><span class=\"line\"><span class=\"comment\"># Provides:          disable-transparent-hugepages</span></span><br><span class=\"line\"><span class=\"comment\"># Required-Start:    $local_fs</span></span><br><span class=\"line\"><span class=\"comment\"># Required-Stop:</span></span><br><span class=\"line\"><span class=\"comment\"># X-Start-Before:    mongod mongodb-mms-automation-agent</span></span><br><span class=\"line\"><span class=\"comment\"># Default-Start:     2 3 4 5</span></span><br><span class=\"line\"><span class=\"comment\"># Default-Stop:      0 1 6</span></span><br><span class=\"line\"><span class=\"comment\"># Short-Description: Disable Linux transparent huge pages</span></span><br><span class=\"line\"><span class=\"comment\"># Description:       Disable Linux transparent huge pages, to improve</span></span><br><span class=\"line\"><span class=\"comment\">#                    database performance.</span></span><br><span class=\"line\"><span class=\"comment\">### END INIT INFO</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"variable\">$1</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">  start)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [ -d /sys/kernel/mm/transparent_hugepage ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">      thp_path=/sys/kernel/mm/transparent_hugepage</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> [ -d /sys/kernel/mm/redhat_transparent_hugepage ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">      thp_path=/sys/kernel/mm/redhat_transparent_hugepage</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">      <span class=\"built_in\">return</span> 0</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">'never'</span> &gt; <span class=\"variable\">$&#123;thp_path&#125;</span>/enabled</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">'never'</span> &gt; <span class=\"variable\">$&#123;thp_path&#125;</span>/defrag</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">unset</span> thp_path</span><br><span class=\"line\">    ;;</span><br><span class=\"line\"><span class=\"keyword\">esac</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Make it executable</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo chmod 755 /etc/init.d/<span class=\"built_in\">disable</span>-transparent-hugepages</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Configure your operating system to run it on boot</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo update-rc.d <span class=\"built_in\">disable</span>-transparent-hugepages defaults</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>OS</p>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"MongoDB-ReplicaSet\"><a href=\"#MongoDB-ReplicaSet\" class=\"headerlink\" title=\"MongoDB ReplicaSet\"></a>MongoDB ReplicaSet</h1><p></p>\n<p><img src=\"https://docs.mongodb.com/manual/_images/replica-set-primary-with-secondary-and-arbiter.png\" alt=\"\"></p>\n<ul>\n<li>21</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>2ec2AB1ec2C</li>\n<li>ABCMongoDB</li>\n<li><p>AShell<code>mongo</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ mongo</span><br><span class=\"line\">&gt; admin = db.getSiblingDB(<span class=\"string\">\"admin\"</span>);</span><br><span class=\"line\">&gt; admin.createUser(&#123; <span class=\"attr\">user</span>: <span class=\"string\">\"ethan\"</span>, <span class=\"attr\">pwd</span>: <span class=\"string\">\"&#123;ethan&#125;\"</span>, <span class=\"attr\">roles</span>: [&#123; <span class=\"attr\">role</span>: <span class=\"string\">\"root\"</span>, <span class=\"attr\">db</span>: <span class=\"string\">\"admin\"</span> &#125;] &#125;);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>keyfile</p>\n<ul>\n<li>keyfile<ul>\n<li><code>openssl rand -base64 755 &gt; rs0.key</code></li>\n</ul>\n</li>\n<li><code>rs0.key</code>ABC<code>/etc</code></li>\n<li><code>rs0.key</code><ul>\n<li><code>chmod 400 rs0.key</code></li>\n<li><code>chown mongodb:mongodb /etc/rs0.key</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>AB<code>/etc/mongod.conf</code></p>\n<ul>\n<li><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">security:</span></span><br><span class=\"line\"><span class=\"attr\">  keyFile:</span> <span class=\"string\">\"/etc/rs0.key\"</span></span><br><span class=\"line\"><span class=\"attr\">  authorization:</span> <span class=\"string\">enabled</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">replication:</span></span><br><span class=\"line\"><span class=\"attr\">  replSetName:</span> <span class=\"string\">rs0</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>C<code>/etc/mongod.conf</code></p>\n<ul>\n<li><p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">security:</span></span><br><span class=\"line\"><span class=\"attr\">  keyFile:</span> <span class=\"string\">\"/etc/rs0.key\"</span></span><br><span class=\"line\"><span class=\"attr\">  authorization:</span> <span class=\"string\">enabled</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">replication:</span></span><br><span class=\"line\"><span class=\"attr\">  replSetName:</span> <span class=\"string\">rs0</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">storage:</span></span><br><span class=\"line\"><span class=\"attr\">  journal:</span></span><br><span class=\"line\"><span class=\"attr\">    enabled:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>ABC<code>mongod</code></p>\n</li>\n<li><p></p>\n<ul>\n<li><p>A<code>mongod</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ mongo -u ethan -p &#123;ethan&#125; --authenticationDatabase admin</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ReplicaSet</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; rs.initiate()</span><br><span class=\"line\">&gt; cfg = rs.conf()</span><br><span class=\"line\">&gt; cfg.members[<span class=\"number\">0</span>].host = <span class=\"string\">\"&#123;AIP&#125;:27017\"</span></span><br><span class=\"line\">&gt; rs.reconfig(cfg)</span><br><span class=\"line\">&gt; rs.add(<span class=\"string\">\"&#123;BIP&#125;\"</span>)</span><br><span class=\"line\">&gt; rs.addArb(<span class=\"string\">\"&#123;CIP&#125;\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\">&gt; rs.status()  <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; use &#123;dbname&#125;;</span><br><span class=\"line\">&gt; db.createUser(&#123; <span class=\"attr\">user</span>: <span class=\"string\">\"&#123;&#125;\"</span>, <span class=\"attr\">pwd</span>: <span class=\"string\">\"&#123;&#125;\"</span>, <span class=\"attr\">roles</span>: [&#123; <span class=\"attr\">role</span>: <span class=\"string\">\"readWrite\"</span>, <span class=\"attr\">db</span>: <span class=\"string\">\"&#123;dbname&#125;\"</span> &#125;] &#125;);</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/\" target=\"_blank\" rel=\"noopener\">Install MongoDB on Ubuntu</a> <ul>\n<li>MongoDB</li>\n<li>MongoDB<code>apt-get</code>MongoDB</li>\n</ul>\n</li>\n<li><a href=\"https://docs.mongodb.com/manual/tutorial/enforce-keyfile-access-control-in-existing-replica-set/\" target=\"_blank\" rel=\"noopener\">Enforce Keyfile Access Control in a Replica Set</a><ul>\n<li>Security between members of the replica set using Internal Authentication</li>\n<li>Security between connecting clients and the replica set using User Access Controls</li>\n</ul>\n</li>\n<li><a href=\"https://docs.mongodb.com/manual/reference/configuration-options/#core-options\" target=\"_blank\" rel=\"noopener\">MongoDB configuration file options</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Ubuntu-Server-14-04MongoDB-3-2-6\"><a href=\"#Ubuntu-Server-14-04MongoDB-3-2-6\" class=\"headerlink\" title=\"Ubuntu Server 14.04MongoDB 3.2.6\"></a>Ubuntu Server 14.04MongoDB 3.2.6</h1><ul>\n<li>Import the public key used by the package management system<ul>\n<li><code>sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927</code></li>\n</ul>\n</li>\n<li>Create a list file for MongoDB<ul>\n<li><code>echo &quot;deb http://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.2 multiverse&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list</code></li>\n</ul>\n</li>\n<li>Reload local package database<ul>\n<li><code>sudo apt-get update</code></li>\n</ul>\n</li>\n<li>Install the MongoDB packages<ul>\n<li><code>sudo apt-get install -y mongodb-org=3.2.6 mongodb-org-server=3.2.6 mongodb-org-shell=3.2.6 mongodb-org-mongos=3.2.6 mongodb-org-tools=3.2.6</code></li>\n</ul>\n</li>\n<li><p>Pin a specific version of MongoDB</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org-server hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org-shell hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org-mongos hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"mongodb-org-tools hold\"</span> | sudo dpkg --<span class=\"built_in\">set</span>-selections</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>MongoDB<code>/etc/mongod.conf</code></p>\n<ul>\n<li><code>net.bindIp</code><code>0.0.0.0</code></li>\n<li><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">storage:</span></span><br><span class=\"line\"><span class=\"attr\">  directoryPerDB:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>MongoDB</p>\n<ul>\n<li><code>sudo service mongod restart</code></li>\n<li><code>mongo</code></li>\n</ul>\n</li>\n<li><p>Disable Transparent Huge Pages<a href=\"https://docs.mongodb.com/manual/tutorial/transparent-huge-pages/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<ul>\n<li><p>Create the init.d script</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/sh</span></span><br><span class=\"line\"><span class=\"comment\">### BEGIN INIT INFO</span></span><br><span class=\"line\"><span class=\"comment\"># Provides:          disable-transparent-hugepages</span></span><br><span class=\"line\"><span class=\"comment\"># Required-Start:    $local_fs</span></span><br><span class=\"line\"><span class=\"comment\"># Required-Stop:</span></span><br><span class=\"line\"><span class=\"comment\"># X-Start-Before:    mongod mongodb-mms-automation-agent</span></span><br><span class=\"line\"><span class=\"comment\"># Default-Start:     2 3 4 5</span></span><br><span class=\"line\"><span class=\"comment\"># Default-Stop:      0 1 6</span></span><br><span class=\"line\"><span class=\"comment\"># Short-Description: Disable Linux transparent huge pages</span></span><br><span class=\"line\"><span class=\"comment\"># Description:       Disable Linux transparent huge pages, to improve</span></span><br><span class=\"line\"><span class=\"comment\">#                    database performance.</span></span><br><span class=\"line\"><span class=\"comment\">### END INIT INFO</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"variable\">$1</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">  start)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [ -d /sys/kernel/mm/transparent_hugepage ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">      thp_path=/sys/kernel/mm/transparent_hugepage</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> [ -d /sys/kernel/mm/redhat_transparent_hugepage ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">      thp_path=/sys/kernel/mm/redhat_transparent_hugepage</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">      <span class=\"built_in\">return</span> 0</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">'never'</span> &gt; <span class=\"variable\">$&#123;thp_path&#125;</span>/enabled</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">'never'</span> &gt; <span class=\"variable\">$&#123;thp_path&#125;</span>/defrag</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">unset</span> thp_path</span><br><span class=\"line\">    ;;</span><br><span class=\"line\"><span class=\"keyword\">esac</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Make it executable</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo chmod 755 /etc/init.d/<span class=\"built_in\">disable</span>-transparent-hugepages</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Configure your operating system to run it on boot</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo update-rc.d <span class=\"built_in\">disable</span>-transparent-hugepages defaults</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>OS</p>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"MongoDB-ReplicaSet\"><a href=\"#MongoDB-ReplicaSet\" class=\"headerlink\" title=\"MongoDB ReplicaSet\"></a>MongoDB ReplicaSet</h1><p></p>\n<p><img src=\"https://docs.mongodb.com/manual/_images/replica-set-primary-with-secondary-and-arbiter.png\" alt=\"\"></p>\n<ul>\n<li>21</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>2ec2AB1ec2C</li>\n<li>ABCMongoDB</li>\n<li><p>AShell<code>mongo</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ mongo</span><br><span class=\"line\">&gt; admin = db.getSiblingDB(<span class=\"string\">\"admin\"</span>);</span><br><span class=\"line\">&gt; admin.createUser(&#123; <span class=\"attr\">user</span>: <span class=\"string\">\"ethan\"</span>, <span class=\"attr\">pwd</span>: <span class=\"string\">\"&#123;ethan&#125;\"</span>, <span class=\"attr\">roles</span>: [&#123; <span class=\"attr\">role</span>: <span class=\"string\">\"root\"</span>, <span class=\"attr\">db</span>: <span class=\"string\">\"admin\"</span> &#125;] &#125;);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>keyfile</p>\n<ul>\n<li>keyfile<ul>\n<li><code>openssl rand -base64 755 &gt; rs0.key</code></li>\n</ul>\n</li>\n<li><code>rs0.key</code>ABC<code>/etc</code></li>\n<li><code>rs0.key</code><ul>\n<li><code>chmod 400 rs0.key</code></li>\n<li><code>chown mongodb:mongodb /etc/rs0.key</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>AB<code>/etc/mongod.conf</code></p>\n<ul>\n<li><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">security:</span></span><br><span class=\"line\"><span class=\"attr\">  keyFile:</span> <span class=\"string\">\"/etc/rs0.key\"</span></span><br><span class=\"line\"><span class=\"attr\">  authorization:</span> <span class=\"string\">enabled</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">replication:</span></span><br><span class=\"line\"><span class=\"attr\">  replSetName:</span> <span class=\"string\">rs0</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>C<code>/etc/mongod.conf</code></p>\n<ul>\n<li><p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">security:</span></span><br><span class=\"line\"><span class=\"attr\">  keyFile:</span> <span class=\"string\">\"/etc/rs0.key\"</span></span><br><span class=\"line\"><span class=\"attr\">  authorization:</span> <span class=\"string\">enabled</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">replication:</span></span><br><span class=\"line\"><span class=\"attr\">  replSetName:</span> <span class=\"string\">rs0</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">storage:</span></span><br><span class=\"line\"><span class=\"attr\">  journal:</span></span><br><span class=\"line\"><span class=\"attr\">    enabled:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>ABC<code>mongod</code></p>\n</li>\n<li><p></p>\n<ul>\n<li><p>A<code>mongod</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ mongo -u ethan -p &#123;ethan&#125; --authenticationDatabase admin</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ReplicaSet</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; rs.initiate()</span><br><span class=\"line\">&gt; cfg = rs.conf()</span><br><span class=\"line\">&gt; cfg.members[<span class=\"number\">0</span>].host = <span class=\"string\">\"&#123;AIP&#125;:27017\"</span></span><br><span class=\"line\">&gt; rs.reconfig(cfg)</span><br><span class=\"line\">&gt; rs.add(<span class=\"string\">\"&#123;BIP&#125;\"</span>)</span><br><span class=\"line\">&gt; rs.addArb(<span class=\"string\">\"&#123;CIP&#125;\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\">&gt; rs.status()  <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; use &#123;dbname&#125;;</span><br><span class=\"line\">&gt; db.createUser(&#123; <span class=\"attr\">user</span>: <span class=\"string\">\"&#123;&#125;\"</span>, <span class=\"attr\">pwd</span>: <span class=\"string\">\"&#123;&#125;\"</span>, <span class=\"attr\">roles</span>: [&#123; <span class=\"attr\">role</span>: <span class=\"string\">\"readWrite\"</span>, <span class=\"attr\">db</span>: <span class=\"string\">\"&#123;dbname&#125;\"</span> &#125;] &#125;);</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/\" target=\"_blank\" rel=\"noopener\">Install MongoDB on Ubuntu</a> <ul>\n<li>MongoDB</li>\n<li>MongoDB<code>apt-get</code>MongoDB</li>\n</ul>\n</li>\n<li><a href=\"https://docs.mongodb.com/manual/tutorial/enforce-keyfile-access-control-in-existing-replica-set/\" target=\"_blank\" rel=\"noopener\">Enforce Keyfile Access Control in a Replica Set</a><ul>\n<li>Security between members of the replica set using Internal Authentication</li>\n<li>Security between connecting clients and the replica set using User Access Controls</li>\n</ul>\n</li>\n<li><a href=\"https://docs.mongodb.com/manual/reference/configuration-options/#core-options\" target=\"_blank\" rel=\"noopener\">MongoDB configuration file options</a></li>\n</ul>\n"},{"title":"Elasticsearch43Elasticsearch()","date":"2016-08-06T01:46:38.000Z","_content":"\n\n{% asset_img es-cluster.jpg %}\n\n# \n\nElasticsearch`apt`:\n\n- Elasticsearch 2.3.2\n\nJar:\n\n- [elasticsearch-analysis-ik](https://github.com/medcl/elasticsearch-analysis-ik): 1.9.2\n- [elasticsearch-analysis-pinyin](https://github.com/medcl/elasticsearch-analysis-pinyin): 1.7.2\n- [elasticsearch-analysis-stconvert](https://github.com/medcl/elasticsearch-analysis-stconvert): 1.8.2\n\nSite:\n\n- [elasticsearch-head](https://github.com/mobz/elasticsearch-head): \n\n# \n\n- Node1\n    - `search-1`\n    - `node-1`\n    - IP: `192.168.31.171`\n- Node2\n    - `search-1`\n    - `node-2`\n    - IP: `192.168.31.221`\n- Node3\n    - `search-1`\n    - `node-3`\n    - IP: `192.168.31.154`\n\n# \n\n| Node  | Installed Plugins           |\n|:------|:----------------------------|\n| Node1 | ik, pinyin, stconvert, head |\n| Node1 | ik, pinyin, stconvert       |\n| Node1 | ik, pinyin, stconvert       |\n\n# \n\n\n\n- Node 1\n\n```yaml\ncluster.name: search-1\nnode.name: node-1\n\nnode.master: true\nnode.data: true\n\nindex.number_of_shards: 3\nindex.number_of_replicas: 1\n\nnetwork.host: 0.0.0.0                           # \n\ndiscovery.zen.ping.multicast.enabled: false     # \ndiscovery.zen.minimum_master_nodes: 2           # \ndiscovery.zen.ping.unicast.hosts: ['192.168.31.171', '192.168.31.221', '192.168.31.154']\n```\n\n- Node 2\n\n```yaml\ncluster.name: search-1\nnode.name: node-2\n\nnode.master: true\nnode.data: true\n\nindex.number_of_shards: 3\nindex.number_of_replicas: 1\n\nnetwork.host: 0.0.0.0                           # \n\ndiscovery.zen.ping.multicast.enabled: false     # \ndiscovery.zen.minimum_master_nodes: 2           # \ndiscovery.zen.ping.unicast.hosts: ['192.168.31.171', '192.168.31.221', '192.168.31.154']\n```\n\n- Node 3\n\n```yaml\ncluster.name: search-1\nnode.name: node-3\n\nnode.master: true\nnode.data: true\n\nindex.number_of_shards: 3\nindex.number_of_replicas: 1\n\nnetwork.host: 0.0.0.0                           # \n\ndiscovery.zen.ping.multicast.enabled: false     # \ndiscovery.zen.minimum_master_nodes: 2           # \ndiscovery.zen.ping.unicast.hosts: ['192.168.31.171', '192.168.31.221', '192.168.31.154']\n```\n\n# \n\n\n\n```bash\n$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.171:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.171:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.171:~/\n\n$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.221:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.221:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.221:~/\n\n$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.154:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.154:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.154:~/\n\n```\n\n`/usr/share/elasticsearch/plugins`\n\n```bash\n$ mv elasticsearch-analysis-ik-1.9.2 /usr/share/elasticsearch/plugins/\n$ mv elasticsearch-analysis-pinyin-1.7.2 /usr/share/elasticsearch/plugins/\n$ mv elasticsearch-analysis-stconvert-1.8.2 /usr/share/elasticsearch/plugins/\n\n$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-ik-1.9.2/             # elasticsearch\n$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-pinyin-1.7.2/         # elasticsearch\n$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-stconvert-1.8.2/      # elasticsearch\n```\n","source":"_posts/configure-smallest-elasticsearch-cluster.md","raw":"---\ntitle: Elasticsearch43Elasticsearch()\ntags:\n  - elasticsearch\ncategories:\n  - \ndate: 2016-08-06 09:46:38\n---\n\n\n{% asset_img es-cluster.jpg %}\n\n# \n\nElasticsearch`apt`:\n\n- Elasticsearch 2.3.2\n\nJar:\n\n- [elasticsearch-analysis-ik](https://github.com/medcl/elasticsearch-analysis-ik): 1.9.2\n- [elasticsearch-analysis-pinyin](https://github.com/medcl/elasticsearch-analysis-pinyin): 1.7.2\n- [elasticsearch-analysis-stconvert](https://github.com/medcl/elasticsearch-analysis-stconvert): 1.8.2\n\nSite:\n\n- [elasticsearch-head](https://github.com/mobz/elasticsearch-head): \n\n# \n\n- Node1\n    - `search-1`\n    - `node-1`\n    - IP: `192.168.31.171`\n- Node2\n    - `search-1`\n    - `node-2`\n    - IP: `192.168.31.221`\n- Node3\n    - `search-1`\n    - `node-3`\n    - IP: `192.168.31.154`\n\n# \n\n| Node  | Installed Plugins           |\n|:------|:----------------------------|\n| Node1 | ik, pinyin, stconvert, head |\n| Node1 | ik, pinyin, stconvert       |\n| Node1 | ik, pinyin, stconvert       |\n\n# \n\n\n\n- Node 1\n\n```yaml\ncluster.name: search-1\nnode.name: node-1\n\nnode.master: true\nnode.data: true\n\nindex.number_of_shards: 3\nindex.number_of_replicas: 1\n\nnetwork.host: 0.0.0.0                           # \n\ndiscovery.zen.ping.multicast.enabled: false     # \ndiscovery.zen.minimum_master_nodes: 2           # \ndiscovery.zen.ping.unicast.hosts: ['192.168.31.171', '192.168.31.221', '192.168.31.154']\n```\n\n- Node 2\n\n```yaml\ncluster.name: search-1\nnode.name: node-2\n\nnode.master: true\nnode.data: true\n\nindex.number_of_shards: 3\nindex.number_of_replicas: 1\n\nnetwork.host: 0.0.0.0                           # \n\ndiscovery.zen.ping.multicast.enabled: false     # \ndiscovery.zen.minimum_master_nodes: 2           # \ndiscovery.zen.ping.unicast.hosts: ['192.168.31.171', '192.168.31.221', '192.168.31.154']\n```\n\n- Node 3\n\n```yaml\ncluster.name: search-1\nnode.name: node-3\n\nnode.master: true\nnode.data: true\n\nindex.number_of_shards: 3\nindex.number_of_replicas: 1\n\nnetwork.host: 0.0.0.0                           # \n\ndiscovery.zen.ping.multicast.enabled: false     # \ndiscovery.zen.minimum_master_nodes: 2           # \ndiscovery.zen.ping.unicast.hosts: ['192.168.31.171', '192.168.31.221', '192.168.31.154']\n```\n\n# \n\n\n\n```bash\n$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.171:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.171:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.171:~/\n\n$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.221:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.221:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.221:~/\n\n$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.154:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.154:~/\n$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.154:~/\n\n```\n\n`/usr/share/elasticsearch/plugins`\n\n```bash\n$ mv elasticsearch-analysis-ik-1.9.2 /usr/share/elasticsearch/plugins/\n$ mv elasticsearch-analysis-pinyin-1.7.2 /usr/share/elasticsearch/plugins/\n$ mv elasticsearch-analysis-stconvert-1.8.2 /usr/share/elasticsearch/plugins/\n\n$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-ik-1.9.2/             # elasticsearch\n$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-pinyin-1.7.2/         # elasticsearch\n$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-stconvert-1.8.2/      # elasticsearch\n```\n","slug":"configure-smallest-elasticsearch-cluster","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24n000dv7e8gpucx5x4","content":"<img src=\"/2016/08/06/configure-smallest-elasticsearch-cluster/es-cluster.jpg\">\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Elasticsearch<code>apt</code>:</p>\n<ul>\n<li>Elasticsearch 2.3.2</li>\n</ul>\n<p>Jar:</p>\n<ul>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-ik\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-ik</a>: 1.9.2</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-pinyin\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-pinyin</a>: 1.7.2</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-stconvert\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-stconvert</a>: 1.8.2</li>\n</ul>\n<p>Site:</p>\n<ul>\n<li><a href=\"https://github.com/mobz/elasticsearch-head\" target=\"_blank\" rel=\"noopener\">elasticsearch-head</a>: </li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>Node1<ul>\n<li><code>search-1</code></li>\n<li><code>node-1</code></li>\n<li>IP: <code>192.168.31.171</code></li>\n</ul>\n</li>\n<li>Node2<ul>\n<li><code>search-1</code></li>\n<li><code>node-2</code></li>\n<li>IP: <code>192.168.31.221</code></li>\n</ul>\n</li>\n<li>Node3<ul>\n<li><code>search-1</code></li>\n<li><code>node-3</code></li>\n<li>IP: <code>192.168.31.154</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Node</th>\n<th style=\"text-align:left\">Installed Plugins</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Node1</td>\n<td style=\"text-align:left\">ik, pinyin, stconvert, head</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Node1</td>\n<td style=\"text-align:left\">ik, pinyin, stconvert</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Node1</td>\n<td style=\"text-align:left\">ik, pinyin, stconvert</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li>Node 1</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cluster.name:</span> <span class=\"string\">search-1</span></span><br><span class=\"line\"><span class=\"string\">node.name:</span> <span class=\"string\">node-1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">node.master:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"string\">node.data:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">index.number_of_shards:</span> <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"string\">index.number_of_replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">network.host:</span> <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span>                           <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.multicast.enabled:</span> <span class=\"literal\">false</span>     <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.minimum_master_nodes:</span> <span class=\"number\">2</span>           <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.unicast.hosts:</span> <span class=\"string\">['192.168.31.171',</span> <span class=\"string\">'192.168.31.221'</span><span class=\"string\">,</span> <span class=\"string\">'192.168.31.154'</span><span class=\"string\">]</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>Node 2</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cluster.name:</span> <span class=\"string\">search-1</span></span><br><span class=\"line\"><span class=\"string\">node.name:</span> <span class=\"string\">node-2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">node.master:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"string\">node.data:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">index.number_of_shards:</span> <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"string\">index.number_of_replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">network.host:</span> <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span>                           <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.multicast.enabled:</span> <span class=\"literal\">false</span>     <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.minimum_master_nodes:</span> <span class=\"number\">2</span>           <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.unicast.hosts:</span> <span class=\"string\">['192.168.31.171',</span> <span class=\"string\">'192.168.31.221'</span><span class=\"string\">,</span> <span class=\"string\">'192.168.31.154'</span><span class=\"string\">]</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>Node 3</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cluster.name:</span> <span class=\"string\">search-1</span></span><br><span class=\"line\"><span class=\"string\">node.name:</span> <span class=\"string\">node-3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">node.master:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"string\">node.data:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">index.number_of_shards:</span> <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"string\">index.number_of_replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">network.host:</span> <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span>                           <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.multicast.enabled:</span> <span class=\"literal\">false</span>     <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.minimum_master_nodes:</span> <span class=\"number\">2</span>           <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.unicast.hosts:</span> <span class=\"string\">['192.168.31.171',</span> <span class=\"string\">'192.168.31.221'</span><span class=\"string\">,</span> <span class=\"string\">'192.168.31.154'</span><span class=\"string\">]</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.171:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.171:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.171:~/</span><br><span class=\"line\"></span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.221:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.221:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.221:~/</span><br><span class=\"line\"></span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.154:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.154:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.154:~/</span><br></pre></td></tr></table></figure>\n<p><code>/usr/share/elasticsearch/plugins</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ mv elasticsearch-analysis-ik-1.9.2 /usr/share/elasticsearch/plugins/</span><br><span class=\"line\">$ mv elasticsearch-analysis-pinyin-1.7.2 /usr/share/elasticsearch/plugins/</span><br><span class=\"line\">$ mv elasticsearch-analysis-stconvert-1.8.2 /usr/share/elasticsearch/plugins/</span><br><span class=\"line\"></span><br><span class=\"line\">$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-ik-1.9.2/             <span class=\"comment\"># elasticsearch</span></span><br><span class=\"line\">$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-pinyin-1.7.2/         <span class=\"comment\"># elasticsearch</span></span><br><span class=\"line\">$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-stconvert-1.8.2/      <span class=\"comment\"># elasticsearch</span></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<img src=\"/2016/08/06/configure-smallest-elasticsearch-cluster/es-cluster.jpg\">\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Elasticsearch<code>apt</code>:</p>\n<ul>\n<li>Elasticsearch 2.3.2</li>\n</ul>\n<p>Jar:</p>\n<ul>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-ik\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-ik</a>: 1.9.2</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-pinyin\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-pinyin</a>: 1.7.2</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-stconvert\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-stconvert</a>: 1.8.2</li>\n</ul>\n<p>Site:</p>\n<ul>\n<li><a href=\"https://github.com/mobz/elasticsearch-head\" target=\"_blank\" rel=\"noopener\">elasticsearch-head</a>: </li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>Node1<ul>\n<li><code>search-1</code></li>\n<li><code>node-1</code></li>\n<li>IP: <code>192.168.31.171</code></li>\n</ul>\n</li>\n<li>Node2<ul>\n<li><code>search-1</code></li>\n<li><code>node-2</code></li>\n<li>IP: <code>192.168.31.221</code></li>\n</ul>\n</li>\n<li>Node3<ul>\n<li><code>search-1</code></li>\n<li><code>node-3</code></li>\n<li>IP: <code>192.168.31.154</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Node</th>\n<th style=\"text-align:left\">Installed Plugins</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Node1</td>\n<td style=\"text-align:left\">ik, pinyin, stconvert, head</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Node1</td>\n<td style=\"text-align:left\">ik, pinyin, stconvert</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Node1</td>\n<td style=\"text-align:left\">ik, pinyin, stconvert</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li>Node 1</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cluster.name:</span> <span class=\"string\">search-1</span></span><br><span class=\"line\"><span class=\"string\">node.name:</span> <span class=\"string\">node-1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">node.master:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"string\">node.data:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">index.number_of_shards:</span> <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"string\">index.number_of_replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">network.host:</span> <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span>                           <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.multicast.enabled:</span> <span class=\"literal\">false</span>     <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.minimum_master_nodes:</span> <span class=\"number\">2</span>           <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.unicast.hosts:</span> <span class=\"string\">['192.168.31.171',</span> <span class=\"string\">'192.168.31.221'</span><span class=\"string\">,</span> <span class=\"string\">'192.168.31.154'</span><span class=\"string\">]</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>Node 2</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cluster.name:</span> <span class=\"string\">search-1</span></span><br><span class=\"line\"><span class=\"string\">node.name:</span> <span class=\"string\">node-2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">node.master:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"string\">node.data:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">index.number_of_shards:</span> <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"string\">index.number_of_replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">network.host:</span> <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span>                           <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.multicast.enabled:</span> <span class=\"literal\">false</span>     <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.minimum_master_nodes:</span> <span class=\"number\">2</span>           <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.unicast.hosts:</span> <span class=\"string\">['192.168.31.171',</span> <span class=\"string\">'192.168.31.221'</span><span class=\"string\">,</span> <span class=\"string\">'192.168.31.154'</span><span class=\"string\">]</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>Node 3</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">cluster.name:</span> <span class=\"string\">search-1</span></span><br><span class=\"line\"><span class=\"string\">node.name:</span> <span class=\"string\">node-3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">node.master:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"string\">node.data:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">index.number_of_shards:</span> <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"string\">index.number_of_replicas:</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">network.host:</span> <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span>                           <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.multicast.enabled:</span> <span class=\"literal\">false</span>     <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.minimum_master_nodes:</span> <span class=\"number\">2</span>           <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">discovery.zen.ping.unicast.hosts:</span> <span class=\"string\">['192.168.31.171',</span> <span class=\"string\">'192.168.31.221'</span><span class=\"string\">,</span> <span class=\"string\">'192.168.31.154'</span><span class=\"string\">]</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.171:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.171:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.171:~/</span><br><span class=\"line\"></span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.221:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.221:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.221:~/</span><br><span class=\"line\"></span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-ik-1.9.2 ubuntu@192.168.31.154:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-pinyin-1.7.2 ubuntu@192.168.31.154:~/</span><br><span class=\"line\">$ scp -r -i ~/dev.pem elasticsearch-analysis-stconvert-1.8.2 ubuntu@192.168.31.154:~/</span><br></pre></td></tr></table></figure>\n<p><code>/usr/share/elasticsearch/plugins</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ mv elasticsearch-analysis-ik-1.9.2 /usr/share/elasticsearch/plugins/</span><br><span class=\"line\">$ mv elasticsearch-analysis-pinyin-1.7.2 /usr/share/elasticsearch/plugins/</span><br><span class=\"line\">$ mv elasticsearch-analysis-stconvert-1.8.2 /usr/share/elasticsearch/plugins/</span><br><span class=\"line\"></span><br><span class=\"line\">$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-ik-1.9.2/             <span class=\"comment\"># elasticsearch</span></span><br><span class=\"line\">$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-pinyin-1.7.2/         <span class=\"comment\"># elasticsearch</span></span><br><span class=\"line\">$ chown -R elasticsearch:elasticsearch elasticsearch-analysis-stconvert-1.8.2/      <span class=\"comment\"># elasticsearch</span></span><br></pre></td></tr></table></figure>\n"},{"title":"","date":"2017-07-12T07:26:55.000Z","_content":"\n\n\n{% asset_img cracking_the_coding_skills.png %}\n\n****\n\n1. \n2. \n3. \n4. \n  - BUD\n    - Bottlenecks\n    - Unnecessary work\n    - Duplicated work\n  - Four Algorithm Approaches\n    - **Pattern Matching**: What problems is this similar to?\n    - **Simplify & Generalize**: Tweak and solve simpler problem.\n    - **Base Case & Build**: Does it sound recursive-ish?\n    - **Data Structure Brainstorm**: Try various data structures.\n  - \n    - Look for any unused info\n    - Use a fresh example\n    - Solve it \"incorrectly\"\n    - Make time vs. space tradeoff\n    - Precompute or do upfront work\n    - Try a hash table or another data structure\n5. \n6. \n  - Write beautiful code\n    - Modularize your code from the beginning\n    - Refactor to clean up anything that isn't beautiful\n7. \n  - FIRST Analyze\n    - What's it doing? Why?\n    - Anything that looks wired?\n    - Error hot spots\n  - THEN use test cases\n    - Small test cases\n    - Edge cases\n    - Bigger test cases\n  - When you find bugs, fix them carefully.\n\n****\n\n1. hash tables, linked lists, stacks, queues, trees, tries, graphs, vectors, heaps\n2. quick sort, merge sort, binary search, breadth-first search, depth-first search\n3. Big-O Time, Big-O Space, Recursion & Memoization, Probability, Bit Manipulation\n\n# \n\n- [Cracking the Coding interview](https://www.slideshare.net/gayle2/cracking-the-coding-interview-college)\n  - [Cracking the Coding Interview 6th Ed. Python Solutions](https://github.com/careercup/CtCI-6th-Edition-Python)\n- [Architecture of Tech Interviews](https://www.slideshare.net/gayle2/architecture-of-tech-interviews)\n- [AWS](https://mp.weixin.qq.com/s?__biz=MzA4ODMwMDcxMQ==&mid=2650892256&idx=1&sn=71e0987c7c61ca25c58f586b60de3305)\n- [Amazon Leadership Principles](https://www.amazon.jobs/principles)\n","source":"_posts/cracking-the-coding-skill.md","raw":"---\ntitle: \ntags:\n  - coding\ncategories:\n  - \ndate: 2017-07-12 15:26:55\n---\n\n\n\n{% asset_img cracking_the_coding_skills.png %}\n\n****\n\n1. \n2. \n3. \n4. \n  - BUD\n    - Bottlenecks\n    - Unnecessary work\n    - Duplicated work\n  - Four Algorithm Approaches\n    - **Pattern Matching**: What problems is this similar to?\n    - **Simplify & Generalize**: Tweak and solve simpler problem.\n    - **Base Case & Build**: Does it sound recursive-ish?\n    - **Data Structure Brainstorm**: Try various data structures.\n  - \n    - Look for any unused info\n    - Use a fresh example\n    - Solve it \"incorrectly\"\n    - Make time vs. space tradeoff\n    - Precompute or do upfront work\n    - Try a hash table or another data structure\n5. \n6. \n  - Write beautiful code\n    - Modularize your code from the beginning\n    - Refactor to clean up anything that isn't beautiful\n7. \n  - FIRST Analyze\n    - What's it doing? Why?\n    - Anything that looks wired?\n    - Error hot spots\n  - THEN use test cases\n    - Small test cases\n    - Edge cases\n    - Bigger test cases\n  - When you find bugs, fix them carefully.\n\n****\n\n1. hash tables, linked lists, stacks, queues, trees, tries, graphs, vectors, heaps\n2. quick sort, merge sort, binary search, breadth-first search, depth-first search\n3. Big-O Time, Big-O Space, Recursion & Memoization, Probability, Bit Manipulation\n\n# \n\n- [Cracking the Coding interview](https://www.slideshare.net/gayle2/cracking-the-coding-interview-college)\n  - [Cracking the Coding Interview 6th Ed. Python Solutions](https://github.com/careercup/CtCI-6th-Edition-Python)\n- [Architecture of Tech Interviews](https://www.slideshare.net/gayle2/architecture-of-tech-interviews)\n- [AWS](https://mp.weixin.qq.com/s?__biz=MzA4ODMwMDcxMQ==&mid=2650892256&idx=1&sn=71e0987c7c61ca25c58f586b60de3305)\n- [Amazon Leadership Principles](https://www.amazon.jobs/principles)\n","slug":"cracking-the-coding-skill","published":1,"updated":"2017-08-27T12:28:28.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24p000iv7e8id2ocice","content":"<p></p>\n<img src=\"/2017/07/12/cracking-the-coding-skill/cracking_the_coding_skills.png\">\n<p><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li><ul>\n<li>BUD<ul>\n<li>Bottlenecks</li>\n<li>Unnecessary work</li>\n<li>Duplicated work</li>\n</ul>\n</li>\n<li>Four Algorithm Approaches<ul>\n<li><strong>Pattern Matching</strong>: What problems is this similar to?</li>\n<li><strong>Simplify &amp; Generalize</strong>: Tweak and solve simpler problem.</li>\n<li><strong>Base Case &amp; Build</strong>: Does it sound recursive-ish?</li>\n<li><strong>Data Structure Brainstorm</strong>: Try various data structures.</li>\n</ul>\n</li>\n<li><ul>\n<li>Look for any unused info</li>\n<li>Use a fresh example</li>\n<li>Solve it incorrectly</li>\n<li>Make time vs. space tradeoff</li>\n<li>Precompute or do upfront work</li>\n<li>Try a hash table or another data structure</li>\n</ul>\n</li>\n</ul>\n</li>\n<li></li>\n<li><ul>\n<li>Write beautiful code<ul>\n<li>Modularize your code from the beginning</li>\n<li>Refactor to clean up anything that isnt beautiful</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><ul>\n<li>FIRST Analyze<ul>\n<li>Whats it doing? Why?</li>\n<li>Anything that looks wired?</li>\n<li>Error hot spots</li>\n</ul>\n</li>\n<li>THEN use test cases<ul>\n<li>Small test cases</li>\n<li>Edge cases</li>\n<li>Bigger test cases</li>\n</ul>\n</li>\n<li>When you find bugs, fix them carefully.</li>\n</ul>\n</li>\n</ol>\n<p><strong></strong></p>\n<ol>\n<li>hash tables, linked lists, stacks, queues, trees, tries, graphs, vectors, heaps</li>\n<li>quick sort, merge sort, binary search, breadth-first search, depth-first search</li>\n<li>Big-O Time, Big-O Space, Recursion &amp; Memoization, Probability, Bit Manipulation</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://www.slideshare.net/gayle2/cracking-the-coding-interview-college\" target=\"_blank\" rel=\"noopener\">Cracking the Coding interview</a><ul>\n<li><a href=\"https://github.com/careercup/CtCI-6th-Edition-Python\" target=\"_blank\" rel=\"noopener\">Cracking the Coding Interview 6th Ed. Python Solutions</a></li>\n</ul>\n</li>\n<li><a href=\"https://www.slideshare.net/gayle2/architecture-of-tech-interviews\" target=\"_blank\" rel=\"noopener\">Architecture of Tech Interviews</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s?__biz=MzA4ODMwMDcxMQ==&amp;mid=2650892256&amp;idx=1&amp;sn=71e0987c7c61ca25c58f586b60de3305\" target=\"_blank\" rel=\"noopener\">AWS</a></li>\n<li><a href=\"https://www.amazon.jobs/principles\" target=\"_blank\" rel=\"noopener\">Amazon Leadership Principles</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p></p>\n<img src=\"/2017/07/12/cracking-the-coding-skill/cracking_the_coding_skills.png\">\n<p><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li><ul>\n<li>BUD<ul>\n<li>Bottlenecks</li>\n<li>Unnecessary work</li>\n<li>Duplicated work</li>\n</ul>\n</li>\n<li>Four Algorithm Approaches<ul>\n<li><strong>Pattern Matching</strong>: What problems is this similar to?</li>\n<li><strong>Simplify &amp; Generalize</strong>: Tweak and solve simpler problem.</li>\n<li><strong>Base Case &amp; Build</strong>: Does it sound recursive-ish?</li>\n<li><strong>Data Structure Brainstorm</strong>: Try various data structures.</li>\n</ul>\n</li>\n<li><ul>\n<li>Look for any unused info</li>\n<li>Use a fresh example</li>\n<li>Solve it incorrectly</li>\n<li>Make time vs. space tradeoff</li>\n<li>Precompute or do upfront work</li>\n<li>Try a hash table or another data structure</li>\n</ul>\n</li>\n</ul>\n</li>\n<li></li>\n<li><ul>\n<li>Write beautiful code<ul>\n<li>Modularize your code from the beginning</li>\n<li>Refactor to clean up anything that isnt beautiful</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><ul>\n<li>FIRST Analyze<ul>\n<li>Whats it doing? Why?</li>\n<li>Anything that looks wired?</li>\n<li>Error hot spots</li>\n</ul>\n</li>\n<li>THEN use test cases<ul>\n<li>Small test cases</li>\n<li>Edge cases</li>\n<li>Bigger test cases</li>\n</ul>\n</li>\n<li>When you find bugs, fix them carefully.</li>\n</ul>\n</li>\n</ol>\n<p><strong></strong></p>\n<ol>\n<li>hash tables, linked lists, stacks, queues, trees, tries, graphs, vectors, heaps</li>\n<li>quick sort, merge sort, binary search, breadth-first search, depth-first search</li>\n<li>Big-O Time, Big-O Space, Recursion &amp; Memoization, Probability, Bit Manipulation</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://www.slideshare.net/gayle2/cracking-the-coding-interview-college\" target=\"_blank\" rel=\"noopener\">Cracking the Coding interview</a><ul>\n<li><a href=\"https://github.com/careercup/CtCI-6th-Edition-Python\" target=\"_blank\" rel=\"noopener\">Cracking the Coding Interview 6th Ed. Python Solutions</a></li>\n</ul>\n</li>\n<li><a href=\"https://www.slideshare.net/gayle2/architecture-of-tech-interviews\" target=\"_blank\" rel=\"noopener\">Architecture of Tech Interviews</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s?__biz=MzA4ODMwMDcxMQ==&amp;mid=2650892256&amp;idx=1&amp;sn=71e0987c7c61ca25c58f586b60de3305\" target=\"_blank\" rel=\"noopener\">AWS</a></li>\n<li><a href=\"https://www.amazon.jobs/principles\" target=\"_blank\" rel=\"noopener\">Amazon Leadership Principles</a></li>\n</ul>\n"},{"title":"macOS","date":"2017-11-18T11:54:23.000Z","_content":"\n\n{% asset_img 2a73dea7a35b4a2057eec46b15c17133.png %}\n\n**http**macOS`launchd``launchd`wiki2\n\n> In computing, launchd, a unified service-management framework, starts, stops and manages daemons, applications, processes, and scripts.\n>\n> There are two main programs in the launchd system: launchd and launchctl.\n>\n> launchd manages the daemons at both a system and user level. Similar to xinetd, launchd can start daemons on demand. Similar to watchdogd, launchd can monitor daemons to make sure that they keep running. launchd also has replaced init as PID 1 on macOS and as a result it is responsible for starting the system at boot time.\n>\n> Configuration files define the parameters of services run by launchd. Stored in the LaunchAgents and LaunchDaemons subdirectories of the Library folders, the propertylist-based files have approximately thirty different keys that can be set. launchd itself has no knowledge of these configuration files or any ability to read them - that is the responsibility of \"launchctl\".\n>\n> launchctl is a command line application which talks to launchd using IPC and knows how to parse the propertylist files used to describe launchd jobs, serializing them using a specialized dictionary protocol that launchd understands. launchctl can be used to load and unload daemons, start and stop launchd controlled jobs, get system utilization statistics for launchd and its child processes, and set environment settings.\n\n\n****\n\n`/Users/{your_username}/Library/LaunchAgents``com.myutils.licsrv.plist`\n\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n  <dict>\n    <key>Label</key>\n    <string>com.myutils.licsrv.activator</string>\n    <key>ProgramArguments</key>\n    <array>\n       <string>/Users/{your_username}/Applications/myutils/licsrv.darwin.amd64</string>\n    </array>\n    <key>RunAtLoad</key>\n    <true/>\n    <key>StandardErrorPath</key>\n    <string>/dev/null</string>\n    <key>StandardOutPath</key>\n    <string>/dev/null</string>\n  </dict>\n</plist>\n```\n\n`/Users/{your_username}/Applications/myutils`\n\n```\n> launchctl load com.myutils.licsrv.plist\n> launchctl start com.myutils.licsrv.plist\n> ps aux | grep licsrv\n```\n\n\n\n\n# \n\n- [Daemons and Services Programming Guide](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/Introduction.html)\n  - [Creating Launch Daemons and Agents](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html)\n- [launchd info](http://www.launchd.info/)\n- [wiki2 - launchd](https://wiki2.org/en/Launchd)\n","source":"_posts/create-a-launch-agents-in-macOS.md","raw":"---\ntitle: macOS\ntags:\n  - macOS\ncategories:\n  - \ndate: 2017-11-18 19:54:23\n---\n\n\n{% asset_img 2a73dea7a35b4a2057eec46b15c17133.png %}\n\n**http**macOS`launchd``launchd`wiki2\n\n> In computing, launchd, a unified service-management framework, starts, stops and manages daemons, applications, processes, and scripts.\n>\n> There are two main programs in the launchd system: launchd and launchctl.\n>\n> launchd manages the daemons at both a system and user level. Similar to xinetd, launchd can start daemons on demand. Similar to watchdogd, launchd can monitor daemons to make sure that they keep running. launchd also has replaced init as PID 1 on macOS and as a result it is responsible for starting the system at boot time.\n>\n> Configuration files define the parameters of services run by launchd. Stored in the LaunchAgents and LaunchDaemons subdirectories of the Library folders, the propertylist-based files have approximately thirty different keys that can be set. launchd itself has no knowledge of these configuration files or any ability to read them - that is the responsibility of \"launchctl\".\n>\n> launchctl is a command line application which talks to launchd using IPC and knows how to parse the propertylist files used to describe launchd jobs, serializing them using a specialized dictionary protocol that launchd understands. launchctl can be used to load and unload daemons, start and stop launchd controlled jobs, get system utilization statistics for launchd and its child processes, and set environment settings.\n\n\n****\n\n`/Users/{your_username}/Library/LaunchAgents``com.myutils.licsrv.plist`\n\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n  <dict>\n    <key>Label</key>\n    <string>com.myutils.licsrv.activator</string>\n    <key>ProgramArguments</key>\n    <array>\n       <string>/Users/{your_username}/Applications/myutils/licsrv.darwin.amd64</string>\n    </array>\n    <key>RunAtLoad</key>\n    <true/>\n    <key>StandardErrorPath</key>\n    <string>/dev/null</string>\n    <key>StandardOutPath</key>\n    <string>/dev/null</string>\n  </dict>\n</plist>\n```\n\n`/Users/{your_username}/Applications/myutils`\n\n```\n> launchctl load com.myutils.licsrv.plist\n> launchctl start com.myutils.licsrv.plist\n> ps aux | grep licsrv\n```\n\n\n\n\n# \n\n- [Daemons and Services Programming Guide](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/Introduction.html)\n  - [Creating Launch Daemons and Agents](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html)\n- [launchd info](http://www.launchd.info/)\n- [wiki2 - launchd](https://wiki2.org/en/Launchd)\n","slug":"create-a-launch-agents-in-macOS","published":1,"updated":"2017-11-18T11:54:23.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24t000lv7e85q3roztk","content":"<img src=\"/2017/11/18/create-a-launch-agents-in-macOS/2a73dea7a35b4a2057eec46b15c17133.png\">\n<p><strong>http</strong>macOS<code>launchd</code><code>launchd</code>wiki2</p>\n<blockquote>\n<p>In computing, launchd, a unified service-management framework, starts, stops and manages daemons, applications, processes, and scripts.</p>\n<p>There are two main programs in the launchd system: launchd and launchctl.</p>\n<p>launchd manages the daemons at both a system and user level. Similar to xinetd, launchd can start daemons on demand. Similar to watchdogd, launchd can monitor daemons to make sure that they keep running. launchd also has replaced init as PID 1 on macOS and as a result it is responsible for starting the system at boot time.</p>\n<p>Configuration files define the parameters of services run by launchd. Stored in the LaunchAgents and LaunchDaemons subdirectories of the Library folders, the propertylist-based files have approximately thirty different keys that can be set. launchd itself has no knowledge of these configuration files or any ability to read them - that is the responsibility of launchctl.</p>\n<p>launchctl is a command line application which talks to launchd using IPC and knows how to parse the propertylist files used to describe launchd jobs, serializing them using a specialized dictionary protocol that launchd understands. launchctl can be used to load and unload daemons, start and stop launchd controlled jobs, get system utilization statistics for launchd and its child processes, and set environment settings.</p>\n</blockquote>\n<p><strong></strong></p>\n<p><code>/Users/{your_username}/Library/LaunchAgents</code><code>com.myutils.licsrv.plist</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class=\"line\">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><br><span class=\"line\">&lt;plist version=&quot;1.0&quot;&gt;</span><br><span class=\"line\">  &lt;dict&gt;</span><br><span class=\"line\">    &lt;key&gt;Label&lt;/key&gt;</span><br><span class=\"line\">    &lt;string&gt;com.myutils.licsrv.activator&lt;/string&gt;</span><br><span class=\"line\">    &lt;key&gt;ProgramArguments&lt;/key&gt;</span><br><span class=\"line\">    &lt;array&gt;</span><br><span class=\"line\">       &lt;string&gt;/Users/&#123;your_username&#125;/Applications/myutils/licsrv.darwin.amd64&lt;/string&gt;</span><br><span class=\"line\">    &lt;/array&gt;</span><br><span class=\"line\">    &lt;key&gt;RunAtLoad&lt;/key&gt;</span><br><span class=\"line\">    &lt;true/&gt;</span><br><span class=\"line\">    &lt;key&gt;StandardErrorPath&lt;/key&gt;</span><br><span class=\"line\">    &lt;string&gt;/dev/null&lt;/string&gt;</span><br><span class=\"line\">    &lt;key&gt;StandardOutPath&lt;/key&gt;</span><br><span class=\"line\">    &lt;string&gt;/dev/null&lt;/string&gt;</span><br><span class=\"line\">  &lt;/dict&gt;</span><br><span class=\"line\">&lt;/plist&gt;</span><br></pre></td></tr></table></figure>\n<p><code>/Users/{your_username}/Applications/myutils</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; launchctl load com.myutils.licsrv.plist</span><br><span class=\"line\">&gt; launchctl start com.myutils.licsrv.plist</span><br><span class=\"line\">&gt; ps aux | grep licsrv</span><br></pre></td></tr></table></figure>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/Introduction.html\" target=\"_blank\" rel=\"noopener\">Daemons and Services Programming Guide</a><ul>\n<li><a href=\"https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html\" target=\"_blank\" rel=\"noopener\">Creating Launch Daemons and Agents</a></li>\n</ul>\n</li>\n<li><a href=\"http://www.launchd.info/\" target=\"_blank\" rel=\"noopener\">launchd info</a></li>\n<li><a href=\"https://wiki2.org/en/Launchd\" target=\"_blank\" rel=\"noopener\">wiki2 - launchd</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<img src=\"/2017/11/18/create-a-launch-agents-in-macOS/2a73dea7a35b4a2057eec46b15c17133.png\">\n<p><strong>http</strong>macOS<code>launchd</code><code>launchd</code>wiki2</p>\n<blockquote>\n<p>In computing, launchd, a unified service-management framework, starts, stops and manages daemons, applications, processes, and scripts.</p>\n<p>There are two main programs in the launchd system: launchd and launchctl.</p>\n<p>launchd manages the daemons at both a system and user level. Similar to xinetd, launchd can start daemons on demand. Similar to watchdogd, launchd can monitor daemons to make sure that they keep running. launchd also has replaced init as PID 1 on macOS and as a result it is responsible for starting the system at boot time.</p>\n<p>Configuration files define the parameters of services run by launchd. Stored in the LaunchAgents and LaunchDaemons subdirectories of the Library folders, the propertylist-based files have approximately thirty different keys that can be set. launchd itself has no knowledge of these configuration files or any ability to read them - that is the responsibility of launchctl.</p>\n<p>launchctl is a command line application which talks to launchd using IPC and knows how to parse the propertylist files used to describe launchd jobs, serializing them using a specialized dictionary protocol that launchd understands. launchctl can be used to load and unload daemons, start and stop launchd controlled jobs, get system utilization statistics for launchd and its child processes, and set environment settings.</p>\n</blockquote>\n<p><strong></strong></p>\n<p><code>/Users/{your_username}/Library/LaunchAgents</code><code>com.myutils.licsrv.plist</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class=\"line\">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><br><span class=\"line\">&lt;plist version=&quot;1.0&quot;&gt;</span><br><span class=\"line\">  &lt;dict&gt;</span><br><span class=\"line\">    &lt;key&gt;Label&lt;/key&gt;</span><br><span class=\"line\">    &lt;string&gt;com.myutils.licsrv.activator&lt;/string&gt;</span><br><span class=\"line\">    &lt;key&gt;ProgramArguments&lt;/key&gt;</span><br><span class=\"line\">    &lt;array&gt;</span><br><span class=\"line\">       &lt;string&gt;/Users/&#123;your_username&#125;/Applications/myutils/licsrv.darwin.amd64&lt;/string&gt;</span><br><span class=\"line\">    &lt;/array&gt;</span><br><span class=\"line\">    &lt;key&gt;RunAtLoad&lt;/key&gt;</span><br><span class=\"line\">    &lt;true/&gt;</span><br><span class=\"line\">    &lt;key&gt;StandardErrorPath&lt;/key&gt;</span><br><span class=\"line\">    &lt;string&gt;/dev/null&lt;/string&gt;</span><br><span class=\"line\">    &lt;key&gt;StandardOutPath&lt;/key&gt;</span><br><span class=\"line\">    &lt;string&gt;/dev/null&lt;/string&gt;</span><br><span class=\"line\">  &lt;/dict&gt;</span><br><span class=\"line\">&lt;/plist&gt;</span><br></pre></td></tr></table></figure>\n<p><code>/Users/{your_username}/Applications/myutils</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; launchctl load com.myutils.licsrv.plist</span><br><span class=\"line\">&gt; launchctl start com.myutils.licsrv.plist</span><br><span class=\"line\">&gt; ps aux | grep licsrv</span><br></pre></td></tr></table></figure>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/Introduction.html\" target=\"_blank\" rel=\"noopener\">Daemons and Services Programming Guide</a><ul>\n<li><a href=\"https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html\" target=\"_blank\" rel=\"noopener\">Creating Launch Daemons and Agents</a></li>\n</ul>\n</li>\n<li><a href=\"http://www.launchd.info/\" target=\"_blank\" rel=\"noopener\">launchd info</a></li>\n<li><a href=\"https://wiki2.org/en/Launchd\" target=\"_blank\" rel=\"noopener\">wiki2 - launchd</a></li>\n</ul>\n"},{"title":"Elasticsearch3Elastcisearch","date":"2016-08-05T17:00:33.000Z","_content":"\n{% asset_img Brueghel-tower-of-babel.jpg %}\n\n[ElasticSearch](https://www.elastic.co/guide/en/elasticsearch/reference/current/_basic_concepts.html):\n\n# **Near Realtime:**\n\nthere is a slight latency (normally one second) from the time you index a document until the time it becomes searchable.\n\n# **Cluster**\n\nA cluster is a collection of one or more nodes (servers) that together holds your entire data and provides federated indexing and search capabilities across all nodes. A cluster is identified by a unique name which by default is \"elasticsearch\". This name is important because a node can only be part of a cluster if the node is set up to join the cluster by its name.\n\nMake sure that you dont reuse the same cluster names in different environments, otherwise you might end up with nodes joining the wrong cluster. For instance you could use logging-dev, logging-stage, and logging-prod for the development, staging, and production clusters.\n\nNote that it is valid and perfectly fine to have a cluster with only a single node in it. Furthermore, you may also have multiple independent clusters each with its own unique cluster name.\n\n# **Node**\n\nA node is a single server that is part of your cluster, stores your data, and participates in the clusters indexing and search capabilities. Just like a cluster, a node is identified by a name which by default is a random Marvel character name that is assigned to the node at startup. You can define any node name you want if you do not want the default. This name is important for administration purposes where you want to identify which servers in your network correspond to which nodes in your Elasticsearch cluster.\n\nA node can be configured to join a specific cluster by the cluster name. By default, each node is set up to join a cluster named elasticsearch which means that if you start up a number of nodes on your network andassuming they can discover each otherthey will all automatically form and join a single cluster named elasticsearch.\n\nIn a single cluster, you can have as many nodes as you want. Furthermore, if there are no other Elasticsearch nodes currently running on your network, starting a single node will by default form a new single-node cluster named elasticsearch.\n\n# **Index**\n\nAn index is a collection of documents that have somewhat similar characteristics. For example, you can have an index for customer data, another index for a product catalog, and yet another index for order data. An index is identified by a name (that must be all lowercase) and this name is used to refer to the index when performing indexing, search, update, and delete operations against the documents in it.\n\nIn a single cluster, you can define as many indexes as you want.\n\n# **Type**\n\nWithin an index, you can define one or more types. A type is **a logical category/partition of your index** whose semantics is completely up to you. In general, a type is defined for documents that have a set of common fields. For example, lets assume you run a blogging platform and store all your data in a single index. In this index, you may define a type for user data, another type for blog data, and yet another type for comments data.\n\n# **Document**\n\nA document is a basic unit of information that can be indexed. For example, you can have a document for a single customer, another document for a single product, and yet another for a single order. This document is expressed in JSON (JavaScript Object Notation) which is an ubiquitous internet data interchange format.\n\nWithin an index/type, you can store as many documents as you want. Note that although a document physically resides in an index, a document actually must be indexed/assigned to a type inside an index.\n\n# **Shards & Replicas**\n\nAn index can potentially store a large amount of data that can exceed the hardware limits of a single node. For example, a single index of a billion documents taking up 1TB of disk space may not fit on the disk of a single node or may be too slow to serve search requests from a single node alone.\n\nTo solve this problem, Elasticsearch provides the ability to subdivide your index into multiple pieces called shards. When you create an index, you can simply define the number of shards that you want. Each shard is in itself a fully-functional and independent \"index\" that can be hosted on any node in the cluster.\n\nSharding is important for two primary reasons:\n\n- It allows you to horizontally split/scale your content volume\n- It allows you to distribute and parallelize operations across shards (potentially on multiple nodes) thus increasing performance/throughput\nThe mechanics of how a shard is distributed and also how its documents are aggregated back into search requests are completely managed by Elasticsearch and is transparent to you as the user.\n\nIn a network/cloud environment where failures can be expected anytime, it is very useful and highly recommended to have a failover mechanism in case a shard/node somehow goes offline or disappears for whatever reason. To this end, Elasticsearch allows you to make one or more copies of your indexs shards into what are called replica shards, or replicas for short.\n\nReplication is important for two primary reasons:\n\n- It provides high availability in case a shard/node fails. For this reason, it is important to note that a replica shard is never allocated on the same node as the original/primary shard that it was copied from.\n- It allows you to scale out your search volume/throughput since searches can be executed on all replicas in parallel.\n\nTo summarize, each index can be split into multiple shards. An index can also be replicated zero (meaning no replicas) or more times. Once replicated, each index will have primary shards (the original shards that were replicated from) and replica shards (the copies of the primary shards). The number of shards and replicas can be defined per index at the time the index is created. After the index is created, you may change the number of replicas dynamically anytime but you cannot change the number shards after-the-fact.\n\nBy default, each index in Elasticsearch is allocated 5 primary shards and 1 replica which means that if you have at least two nodes in your cluster, your index will have 5 primary shards and another 5 replica shards (1 complete replica) for a total of 10 shards per index.\n","source":"_posts/elastic-basic-concepts.md","raw":"---\ntitle: Elasticsearch3Elastcisearch\ndate: 2016-08-06 01:00:33\ntags:\n  - elasticsearch\ncategories:\n  - \n---\n\n{% asset_img Brueghel-tower-of-babel.jpg %}\n\n[ElasticSearch](https://www.elastic.co/guide/en/elasticsearch/reference/current/_basic_concepts.html):\n\n# **Near Realtime:**\n\nthere is a slight latency (normally one second) from the time you index a document until the time it becomes searchable.\n\n# **Cluster**\n\nA cluster is a collection of one or more nodes (servers) that together holds your entire data and provides federated indexing and search capabilities across all nodes. A cluster is identified by a unique name which by default is \"elasticsearch\". This name is important because a node can only be part of a cluster if the node is set up to join the cluster by its name.\n\nMake sure that you dont reuse the same cluster names in different environments, otherwise you might end up with nodes joining the wrong cluster. For instance you could use logging-dev, logging-stage, and logging-prod for the development, staging, and production clusters.\n\nNote that it is valid and perfectly fine to have a cluster with only a single node in it. Furthermore, you may also have multiple independent clusters each with its own unique cluster name.\n\n# **Node**\n\nA node is a single server that is part of your cluster, stores your data, and participates in the clusters indexing and search capabilities. Just like a cluster, a node is identified by a name which by default is a random Marvel character name that is assigned to the node at startup. You can define any node name you want if you do not want the default. This name is important for administration purposes where you want to identify which servers in your network correspond to which nodes in your Elasticsearch cluster.\n\nA node can be configured to join a specific cluster by the cluster name. By default, each node is set up to join a cluster named elasticsearch which means that if you start up a number of nodes on your network andassuming they can discover each otherthey will all automatically form and join a single cluster named elasticsearch.\n\nIn a single cluster, you can have as many nodes as you want. Furthermore, if there are no other Elasticsearch nodes currently running on your network, starting a single node will by default form a new single-node cluster named elasticsearch.\n\n# **Index**\n\nAn index is a collection of documents that have somewhat similar characteristics. For example, you can have an index for customer data, another index for a product catalog, and yet another index for order data. An index is identified by a name (that must be all lowercase) and this name is used to refer to the index when performing indexing, search, update, and delete operations against the documents in it.\n\nIn a single cluster, you can define as many indexes as you want.\n\n# **Type**\n\nWithin an index, you can define one or more types. A type is **a logical category/partition of your index** whose semantics is completely up to you. In general, a type is defined for documents that have a set of common fields. For example, lets assume you run a blogging platform and store all your data in a single index. In this index, you may define a type for user data, another type for blog data, and yet another type for comments data.\n\n# **Document**\n\nA document is a basic unit of information that can be indexed. For example, you can have a document for a single customer, another document for a single product, and yet another for a single order. This document is expressed in JSON (JavaScript Object Notation) which is an ubiquitous internet data interchange format.\n\nWithin an index/type, you can store as many documents as you want. Note that although a document physically resides in an index, a document actually must be indexed/assigned to a type inside an index.\n\n# **Shards & Replicas**\n\nAn index can potentially store a large amount of data that can exceed the hardware limits of a single node. For example, a single index of a billion documents taking up 1TB of disk space may not fit on the disk of a single node or may be too slow to serve search requests from a single node alone.\n\nTo solve this problem, Elasticsearch provides the ability to subdivide your index into multiple pieces called shards. When you create an index, you can simply define the number of shards that you want. Each shard is in itself a fully-functional and independent \"index\" that can be hosted on any node in the cluster.\n\nSharding is important for two primary reasons:\n\n- It allows you to horizontally split/scale your content volume\n- It allows you to distribute and parallelize operations across shards (potentially on multiple nodes) thus increasing performance/throughput\nThe mechanics of how a shard is distributed and also how its documents are aggregated back into search requests are completely managed by Elasticsearch and is transparent to you as the user.\n\nIn a network/cloud environment where failures can be expected anytime, it is very useful and highly recommended to have a failover mechanism in case a shard/node somehow goes offline or disappears for whatever reason. To this end, Elasticsearch allows you to make one or more copies of your indexs shards into what are called replica shards, or replicas for short.\n\nReplication is important for two primary reasons:\n\n- It provides high availability in case a shard/node fails. For this reason, it is important to note that a replica shard is never allocated on the same node as the original/primary shard that it was copied from.\n- It allows you to scale out your search volume/throughput since searches can be executed on all replicas in parallel.\n\nTo summarize, each index can be split into multiple shards. An index can also be replicated zero (meaning no replicas) or more times. Once replicated, each index will have primary shards (the original shards that were replicated from) and replica shards (the copies of the primary shards). The number of shards and replicas can be defined per index at the time the index is created. After the index is created, you may change the number of replicas dynamically anytime but you cannot change the number shards after-the-fact.\n\nBy default, each index in Elasticsearch is allocated 5 primary shards and 1 replica which means that if you have at least two nodes in your cluster, your index will have 5 primary shards and another 5 replica shards (1 complete replica) for a total of 10 shards per index.\n","slug":"elastic-basic-concepts","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24v000qv7e8gbj1r5e3","content":"<img src=\"/2016/08/06/elastic-basic-concepts/Brueghel-tower-of-babel.jpg\">\n<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/_basic_concepts.html\" target=\"_blank\" rel=\"noopener\">ElasticSearch</a>:</p>\n<h1 id=\"Near-Realtime\"><a href=\"#Near-Realtime\" class=\"headerlink\" title=\"Near Realtime:\"></a><strong>Near Realtime:</strong></h1><p>there is a slight latency (normally one second) from the time you index a document until the time it becomes searchable.</p>\n<h1 id=\"Cluster\"><a href=\"#Cluster\" class=\"headerlink\" title=\"Cluster\"></a><strong>Cluster</strong></h1><p>A cluster is a collection of one or more nodes (servers) that together holds your entire data and provides federated indexing and search capabilities across all nodes. A cluster is identified by a unique name which by default is elasticsearch. This name is important because a node can only be part of a cluster if the node is set up to join the cluster by its name.</p>\n<p>Make sure that you dont reuse the same cluster names in different environments, otherwise you might end up with nodes joining the wrong cluster. For instance you could use logging-dev, logging-stage, and logging-prod for the development, staging, and production clusters.</p>\n<p>Note that it is valid and perfectly fine to have a cluster with only a single node in it. Furthermore, you may also have multiple independent clusters each with its own unique cluster name.</p>\n<h1 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a><strong>Node</strong></h1><p>A node is a single server that is part of your cluster, stores your data, and participates in the clusters indexing and search capabilities. Just like a cluster, a node is identified by a name which by default is a random Marvel character name that is assigned to the node at startup. You can define any node name you want if you do not want the default. This name is important for administration purposes where you want to identify which servers in your network correspond to which nodes in your Elasticsearch cluster.</p>\n<p>A node can be configured to join a specific cluster by the cluster name. By default, each node is set up to join a cluster named elasticsearch which means that if you start up a number of nodes on your network andassuming they can discover each otherthey will all automatically form and join a single cluster named elasticsearch.</p>\n<p>In a single cluster, you can have as many nodes as you want. Furthermore, if there are no other Elasticsearch nodes currently running on your network, starting a single node will by default form a new single-node cluster named elasticsearch.</p>\n<h1 id=\"Index\"><a href=\"#Index\" class=\"headerlink\" title=\"Index\"></a><strong>Index</strong></h1><p>An index is a collection of documents that have somewhat similar characteristics. For example, you can have an index for customer data, another index for a product catalog, and yet another index for order data. An index is identified by a name (that must be all lowercase) and this name is used to refer to the index when performing indexing, search, update, and delete operations against the documents in it.</p>\n<p>In a single cluster, you can define as many indexes as you want.</p>\n<h1 id=\"Type\"><a href=\"#Type\" class=\"headerlink\" title=\"Type\"></a><strong>Type</strong></h1><p>Within an index, you can define one or more types. A type is <strong>a logical category/partition of your index</strong> whose semantics is completely up to you. In general, a type is defined for documents that have a set of common fields. For example, lets assume you run a blogging platform and store all your data in a single index. In this index, you may define a type for user data, another type for blog data, and yet another type for comments data.</p>\n<h1 id=\"Document\"><a href=\"#Document\" class=\"headerlink\" title=\"Document\"></a><strong>Document</strong></h1><p>A document is a basic unit of information that can be indexed. For example, you can have a document for a single customer, another document for a single product, and yet another for a single order. This document is expressed in JSON (JavaScript Object Notation) which is an ubiquitous internet data interchange format.</p>\n<p>Within an index/type, you can store as many documents as you want. Note that although a document physically resides in an index, a document actually must be indexed/assigned to a type inside an index.</p>\n<h1 id=\"Shards-amp-Replicas\"><a href=\"#Shards-amp-Replicas\" class=\"headerlink\" title=\"Shards &amp; Replicas\"></a><strong>Shards &amp; Replicas</strong></h1><p>An index can potentially store a large amount of data that can exceed the hardware limits of a single node. For example, a single index of a billion documents taking up 1TB of disk space may not fit on the disk of a single node or may be too slow to serve search requests from a single node alone.</p>\n<p>To solve this problem, Elasticsearch provides the ability to subdivide your index into multiple pieces called shards. When you create an index, you can simply define the number of shards that you want. Each shard is in itself a fully-functional and independent index that can be hosted on any node in the cluster.</p>\n<p>Sharding is important for two primary reasons:</p>\n<ul>\n<li>It allows you to horizontally split/scale your content volume</li>\n<li>It allows you to distribute and parallelize operations across shards (potentially on multiple nodes) thus increasing performance/throughput<br>The mechanics of how a shard is distributed and also how its documents are aggregated back into search requests are completely managed by Elasticsearch and is transparent to you as the user.</li>\n</ul>\n<p>In a network/cloud environment where failures can be expected anytime, it is very useful and highly recommended to have a failover mechanism in case a shard/node somehow goes offline or disappears for whatever reason. To this end, Elasticsearch allows you to make one or more copies of your indexs shards into what are called replica shards, or replicas for short.</p>\n<p>Replication is important for two primary reasons:</p>\n<ul>\n<li>It provides high availability in case a shard/node fails. For this reason, it is important to note that a replica shard is never allocated on the same node as the original/primary shard that it was copied from.</li>\n<li>It allows you to scale out your search volume/throughput since searches can be executed on all replicas in parallel.</li>\n</ul>\n<p>To summarize, each index can be split into multiple shards. An index can also be replicated zero (meaning no replicas) or more times. Once replicated, each index will have primary shards (the original shards that were replicated from) and replica shards (the copies of the primary shards). The number of shards and replicas can be defined per index at the time the index is created. After the index is created, you may change the number of replicas dynamically anytime but you cannot change the number shards after-the-fact.</p>\n<p>By default, each index in Elasticsearch is allocated 5 primary shards and 1 replica which means that if you have at least two nodes in your cluster, your index will have 5 primary shards and another 5 replica shards (1 complete replica) for a total of 10 shards per index.</p>\n","site":{"data":{}},"excerpt":"","more":"<img src=\"/2016/08/06/elastic-basic-concepts/Brueghel-tower-of-babel.jpg\">\n<p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/_basic_concepts.html\" target=\"_blank\" rel=\"noopener\">ElasticSearch</a>:</p>\n<h1 id=\"Near-Realtime\"><a href=\"#Near-Realtime\" class=\"headerlink\" title=\"Near Realtime:\"></a><strong>Near Realtime:</strong></h1><p>there is a slight latency (normally one second) from the time you index a document until the time it becomes searchable.</p>\n<h1 id=\"Cluster\"><a href=\"#Cluster\" class=\"headerlink\" title=\"Cluster\"></a><strong>Cluster</strong></h1><p>A cluster is a collection of one or more nodes (servers) that together holds your entire data and provides federated indexing and search capabilities across all nodes. A cluster is identified by a unique name which by default is elasticsearch. This name is important because a node can only be part of a cluster if the node is set up to join the cluster by its name.</p>\n<p>Make sure that you dont reuse the same cluster names in different environments, otherwise you might end up with nodes joining the wrong cluster. For instance you could use logging-dev, logging-stage, and logging-prod for the development, staging, and production clusters.</p>\n<p>Note that it is valid and perfectly fine to have a cluster with only a single node in it. Furthermore, you may also have multiple independent clusters each with its own unique cluster name.</p>\n<h1 id=\"Node\"><a href=\"#Node\" class=\"headerlink\" title=\"Node\"></a><strong>Node</strong></h1><p>A node is a single server that is part of your cluster, stores your data, and participates in the clusters indexing and search capabilities. Just like a cluster, a node is identified by a name which by default is a random Marvel character name that is assigned to the node at startup. You can define any node name you want if you do not want the default. This name is important for administration purposes where you want to identify which servers in your network correspond to which nodes in your Elasticsearch cluster.</p>\n<p>A node can be configured to join a specific cluster by the cluster name. By default, each node is set up to join a cluster named elasticsearch which means that if you start up a number of nodes on your network andassuming they can discover each otherthey will all automatically form and join a single cluster named elasticsearch.</p>\n<p>In a single cluster, you can have as many nodes as you want. Furthermore, if there are no other Elasticsearch nodes currently running on your network, starting a single node will by default form a new single-node cluster named elasticsearch.</p>\n<h1 id=\"Index\"><a href=\"#Index\" class=\"headerlink\" title=\"Index\"></a><strong>Index</strong></h1><p>An index is a collection of documents that have somewhat similar characteristics. For example, you can have an index for customer data, another index for a product catalog, and yet another index for order data. An index is identified by a name (that must be all lowercase) and this name is used to refer to the index when performing indexing, search, update, and delete operations against the documents in it.</p>\n<p>In a single cluster, you can define as many indexes as you want.</p>\n<h1 id=\"Type\"><a href=\"#Type\" class=\"headerlink\" title=\"Type\"></a><strong>Type</strong></h1><p>Within an index, you can define one or more types. A type is <strong>a logical category/partition of your index</strong> whose semantics is completely up to you. In general, a type is defined for documents that have a set of common fields. For example, lets assume you run a blogging platform and store all your data in a single index. In this index, you may define a type for user data, another type for blog data, and yet another type for comments data.</p>\n<h1 id=\"Document\"><a href=\"#Document\" class=\"headerlink\" title=\"Document\"></a><strong>Document</strong></h1><p>A document is a basic unit of information that can be indexed. For example, you can have a document for a single customer, another document for a single product, and yet another for a single order. This document is expressed in JSON (JavaScript Object Notation) which is an ubiquitous internet data interchange format.</p>\n<p>Within an index/type, you can store as many documents as you want. Note that although a document physically resides in an index, a document actually must be indexed/assigned to a type inside an index.</p>\n<h1 id=\"Shards-amp-Replicas\"><a href=\"#Shards-amp-Replicas\" class=\"headerlink\" title=\"Shards &amp; Replicas\"></a><strong>Shards &amp; Replicas</strong></h1><p>An index can potentially store a large amount of data that can exceed the hardware limits of a single node. For example, a single index of a billion documents taking up 1TB of disk space may not fit on the disk of a single node or may be too slow to serve search requests from a single node alone.</p>\n<p>To solve this problem, Elasticsearch provides the ability to subdivide your index into multiple pieces called shards. When you create an index, you can simply define the number of shards that you want. Each shard is in itself a fully-functional and independent index that can be hosted on any node in the cluster.</p>\n<p>Sharding is important for two primary reasons:</p>\n<ul>\n<li>It allows you to horizontally split/scale your content volume</li>\n<li>It allows you to distribute and parallelize operations across shards (potentially on multiple nodes) thus increasing performance/throughput<br>The mechanics of how a shard is distributed and also how its documents are aggregated back into search requests are completely managed by Elasticsearch and is transparent to you as the user.</li>\n</ul>\n<p>In a network/cloud environment where failures can be expected anytime, it is very useful and highly recommended to have a failover mechanism in case a shard/node somehow goes offline or disappears for whatever reason. To this end, Elasticsearch allows you to make one or more copies of your indexs shards into what are called replica shards, or replicas for short.</p>\n<p>Replication is important for two primary reasons:</p>\n<ul>\n<li>It provides high availability in case a shard/node fails. For this reason, it is important to note that a replica shard is never allocated on the same node as the original/primary shard that it was copied from.</li>\n<li>It allows you to scale out your search volume/throughput since searches can be executed on all replicas in parallel.</li>\n</ul>\n<p>To summarize, each index can be split into multiple shards. An index can also be replicated zero (meaning no replicas) or more times. Once replicated, each index will have primary shards (the original shards that were replicated from) and replica shards (the copies of the primary shards). The number of shards and replicas can be defined per index at the time the index is created. After the index is created, you may change the number of replicas dynamically anytime but you cannot change the number shards after-the-fact.</p>\n<p>By default, each index in Elasticsearch is allocated 5 primary shards and 1 replica which means that if you have at least two nodes in your cluster, your index will have 5 primary shards and another 5 replica shards (1 complete replica) for a total of 10 shards per index.</p>\n"},{"title":"","date":"2016-11-01T07:54:00.000Z","_content":"\n\n# \n\nmobile App App \n\n App  App  App \n\n# \n\n## \n\n\n\nRequest\n\n```\nhttps://api.sample.com/v3/users/?limit=30&before=NDMyNzQyODI3OTQw\nhttps://api.sample.com/v3/users/?limit=30&after=MTAxNTExOTQ1MjAwNzI5NDE=\n```\n\n\n\n- **limit** `limit` \n- **before**\n- **after**\n\nResponse\n\n```json\n{\n  \"rows\": [\n     ... Endpoint data is here\n  ],\n  \"paging\": {\n    \"cursors\": {\n      \"top\": \"MTAxNTExOTQ1MjAwNzI5NDE=\",\n      \"last\": \"NDMyNzQyODI3OTQw\"\n    },\n    \"previous\": \"NDMyNzQyODI3OTQw\",\n    \"next\": \"MTAxNTExOTQ1MjAwNzI5NDE=\"\n  }\n}\n```\n\n\n\n- **rows**`rows``next`\n- **top**\n- **last**\n- **previous** API `null`\n- **next** API `null`\n\n## \n\nRequest\n\n```\nhttps://api.sample.com/v3/users/?limit=30&offset=30\n```\n\n\n\n- **limit**\n- **offset**\n\n> \n\nResponse\n\n```json\n{\n  \"rows\": [\n     ... Endpoint data is here\n  ],\n  \"count\": 10765\n}\n```\n\n\n\n- **count**`offset``count`\n\n> \n\n# \n\nAPI \"not supported\"\n\n## HTTP Request\n\n- `limit`: 0\n- `after`: `after``after``limit`\n- `before`: `before``before``limit`\n- \n    - Request`before``after`\n    - Request`before``after`\n    - **MySQLMongoDB**\n\n## HTTP Response\n\n```json\n{\n    \"code\": 0,\n    \"result\": {\n        \"rows\": [\n            //\"... Endpoint data is here\"\n        ],\n        \"paging\": {\n            \"cursors\": {\n                \"top\": \"MTAxNTExOTQ1MjAwNzI5NDE=\" or \"19\",\n                \"last\": \"MTAxNTExOTQ1MjAwNzI5NDE=\" or \"19\"\n            },\n            \"previous\": \"MTAxNTExOTQ1MjAwNzI5NDE=\" or \"19\",\n            \"next\": \"MTAxNTExOTQ1MjAwNzI5NDE=\" or \"19\",\n            \"count\": 1087\n        }\n    }\n}\n```\n\n- `paging.cursors.top`: null\n- `paging.cursors.last`: null\n- `paging.previous`: nullRequest`before`null\n- `paging.next`: nullRequest`after`null\n- `paging.count`: \n- \n    - `rows``paging.cursors.top``paging.cursors.last``null``paging.previous``paging.next``null`\n    - `paging.cursors.top``paging.cursors.last`\n\n# \n\n- [twitter API - GET statuses/user_timeline](https://dev.twitter.com/rest/reference/get/statuses/user_timeline)\n","source":"_posts/general-pagination-for-mobile-app.md","raw":"---\ntitle: \ntags:\n  - API\ncategories:\n  - \ndate: 2016-11-01 15:54:00\n---\n\n\n# \n\nmobile App App \n\n App  App  App \n\n# \n\n## \n\n\n\nRequest\n\n```\nhttps://api.sample.com/v3/users/?limit=30&before=NDMyNzQyODI3OTQw\nhttps://api.sample.com/v3/users/?limit=30&after=MTAxNTExOTQ1MjAwNzI5NDE=\n```\n\n\n\n- **limit** `limit` \n- **before**\n- **after**\n\nResponse\n\n```json\n{\n  \"rows\": [\n     ... Endpoint data is here\n  ],\n  \"paging\": {\n    \"cursors\": {\n      \"top\": \"MTAxNTExOTQ1MjAwNzI5NDE=\",\n      \"last\": \"NDMyNzQyODI3OTQw\"\n    },\n    \"previous\": \"NDMyNzQyODI3OTQw\",\n    \"next\": \"MTAxNTExOTQ1MjAwNzI5NDE=\"\n  }\n}\n```\n\n\n\n- **rows**`rows``next`\n- **top**\n- **last**\n- **previous** API `null`\n- **next** API `null`\n\n## \n\nRequest\n\n```\nhttps://api.sample.com/v3/users/?limit=30&offset=30\n```\n\n\n\n- **limit**\n- **offset**\n\n> \n\nResponse\n\n```json\n{\n  \"rows\": [\n     ... Endpoint data is here\n  ],\n  \"count\": 10765\n}\n```\n\n\n\n- **count**`offset``count`\n\n> \n\n# \n\nAPI \"not supported\"\n\n## HTTP Request\n\n- `limit`: 0\n- `after`: `after``after``limit`\n- `before`: `before``before``limit`\n- \n    - Request`before``after`\n    - Request`before``after`\n    - **MySQLMongoDB**\n\n## HTTP Response\n\n```json\n{\n    \"code\": 0,\n    \"result\": {\n        \"rows\": [\n            //\"... Endpoint data is here\"\n        ],\n        \"paging\": {\n            \"cursors\": {\n                \"top\": \"MTAxNTExOTQ1MjAwNzI5NDE=\" or \"19\",\n                \"last\": \"MTAxNTExOTQ1MjAwNzI5NDE=\" or \"19\"\n            },\n            \"previous\": \"MTAxNTExOTQ1MjAwNzI5NDE=\" or \"19\",\n            \"next\": \"MTAxNTExOTQ1MjAwNzI5NDE=\" or \"19\",\n            \"count\": 1087\n        }\n    }\n}\n```\n\n- `paging.cursors.top`: null\n- `paging.cursors.last`: null\n- `paging.previous`: nullRequest`before`null\n- `paging.next`: nullRequest`after`null\n- `paging.count`: \n- \n    - `rows``paging.cursors.top``paging.cursors.last``null``paging.previous``paging.next``null`\n    - `paging.cursors.top``paging.cursors.last`\n\n# \n\n- [twitter API - GET statuses/user_timeline](https://dev.twitter.com/rest/reference/get/statuses/user_timeline)\n","slug":"general-pagination-for-mobile-app","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24w000sv7e8nlit4ewa","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>mobile App App </p>\n<p> App  App  App </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>Request</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.sample.com/v3/users/?limit=30&amp;before=NDMyNzQyODI3OTQw</span><br><span class=\"line\">https://api.sample.com/v3/users/?limit=30&amp;after=MTAxNTExOTQ1MjAwNzI5NDE=</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><strong>limit</strong> <code>limit</code> </li>\n<li><strong>before</strong></li>\n<li><strong>after</strong></li>\n</ul>\n<p>Response</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"rows\"</span>: [</span><br><span class=\"line\">     ... Endpoint data is here</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"paging\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"cursors\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"top\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"last\"</span>: <span class=\"string\">\"NDMyNzQyODI3OTQw\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">\"previous\"</span>: <span class=\"string\">\"NDMyNzQyODI3OTQw\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"next\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><strong>rows</strong><code>rows</code><code>next</code></li>\n<li><strong>top</strong></li>\n<li><strong>last</strong></li>\n<li><strong>previous</strong> API <code>null</code></li>\n<li><strong>next</strong> API <code>null</code></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Request</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.sample.com/v3/users/?limit=30&amp;offset=30</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><strong>limit</strong></li>\n<li><strong>offset</strong></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<p>Response</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"rows\"</span>: [</span><br><span class=\"line\">     ... Endpoint data is here</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"count\"</span>: <span class=\"number\">10765</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><strong>count</strong><code>offset</code><code>count</code></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API not supported</p>\n<h2 id=\"HTTP-Request\"><a href=\"#HTTP-Request\" class=\"headerlink\" title=\"HTTP Request\"></a>HTTP Request</h2><ul>\n<li><code>limit</code>: 0</li>\n<li><code>after</code>: <code>after</code><code>after</code><code>limit</code></li>\n<li><code>before</code>: <code>before</code><code>before</code><code>limit</code></li>\n<li><ul>\n<li>Request<code>before</code><code>after</code></li>\n<li>Request<code>before</code><code>after</code></li>\n<li><strong>MySQLMongoDB</strong></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"HTTP-Response\"><a href=\"#HTTP-Response\" class=\"headerlink\" title=\"HTTP Response\"></a>HTTP Response</h2><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"code\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"result\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"rows\"</span>: [</span><br><span class=\"line\">            //<span class=\"string\">\"... Endpoint data is here\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"attr\">\"paging\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"cursors\"</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">\"top\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span> or <span class=\"string\">\"19\"</span>,</span><br><span class=\"line\">                <span class=\"attr\">\"last\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span> or <span class=\"string\">\"19\"</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"attr\">\"previous\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span> or <span class=\"string\">\"19\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"next\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span> or <span class=\"string\">\"19\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"count\"</span>: <span class=\"number\">1087</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>paging.cursors.top</code>: null</li>\n<li><code>paging.cursors.last</code>: null</li>\n<li><code>paging.previous</code>: nullRequest<code>before</code>null</li>\n<li><code>paging.next</code>: nullRequest<code>after</code>null</li>\n<li><code>paging.count</code>: </li>\n<li><ul>\n<li><code>rows</code><code>paging.cursors.top</code><code>paging.cursors.last</code><code>null</code><code>paging.previous</code><code>paging.next</code><code>null</code></li>\n<li><code>paging.cursors.top</code><code>paging.cursors.last</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://dev.twitter.com/rest/reference/get/statuses/user_timeline\" target=\"_blank\" rel=\"noopener\">twitter API - GET statuses/user_timeline</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>mobile App App </p>\n<p> App  App  App </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>Request</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.sample.com/v3/users/?limit=30&amp;before=NDMyNzQyODI3OTQw</span><br><span class=\"line\">https://api.sample.com/v3/users/?limit=30&amp;after=MTAxNTExOTQ1MjAwNzI5NDE=</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><strong>limit</strong> <code>limit</code> </li>\n<li><strong>before</strong></li>\n<li><strong>after</strong></li>\n</ul>\n<p>Response</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"rows\"</span>: [</span><br><span class=\"line\">     ... Endpoint data is here</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"paging\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"cursors\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"top\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"last\"</span>: <span class=\"string\">\"NDMyNzQyODI3OTQw\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">\"previous\"</span>: <span class=\"string\">\"NDMyNzQyODI3OTQw\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"next\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><strong>rows</strong><code>rows</code><code>next</code></li>\n<li><strong>top</strong></li>\n<li><strong>last</strong></li>\n<li><strong>previous</strong> API <code>null</code></li>\n<li><strong>next</strong> API <code>null</code></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Request</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.sample.com/v3/users/?limit=30&amp;offset=30</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><strong>limit</strong></li>\n<li><strong>offset</strong></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<p>Response</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"rows\"</span>: [</span><br><span class=\"line\">     ... Endpoint data is here</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"count\"</span>: <span class=\"number\">10765</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><strong>count</strong><code>offset</code><code>count</code></li>\n</ul>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API not supported</p>\n<h2 id=\"HTTP-Request\"><a href=\"#HTTP-Request\" class=\"headerlink\" title=\"HTTP Request\"></a>HTTP Request</h2><ul>\n<li><code>limit</code>: 0</li>\n<li><code>after</code>: <code>after</code><code>after</code><code>limit</code></li>\n<li><code>before</code>: <code>before</code><code>before</code><code>limit</code></li>\n<li><ul>\n<li>Request<code>before</code><code>after</code></li>\n<li>Request<code>before</code><code>after</code></li>\n<li><strong>MySQLMongoDB</strong></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"HTTP-Response\"><a href=\"#HTTP-Response\" class=\"headerlink\" title=\"HTTP Response\"></a>HTTP Response</h2><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"code\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"result\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"rows\"</span>: [</span><br><span class=\"line\">            //<span class=\"string\">\"... Endpoint data is here\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"attr\">\"paging\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"cursors\"</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">\"top\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span> or <span class=\"string\">\"19\"</span>,</span><br><span class=\"line\">                <span class=\"attr\">\"last\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span> or <span class=\"string\">\"19\"</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"attr\">\"previous\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span> or <span class=\"string\">\"19\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"next\"</span>: <span class=\"string\">\"MTAxNTExOTQ1MjAwNzI5NDE=\"</span> or <span class=\"string\">\"19\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"count\"</span>: <span class=\"number\">1087</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>paging.cursors.top</code>: null</li>\n<li><code>paging.cursors.last</code>: null</li>\n<li><code>paging.previous</code>: nullRequest<code>before</code>null</li>\n<li><code>paging.next</code>: nullRequest<code>after</code>null</li>\n<li><code>paging.count</code>: </li>\n<li><ul>\n<li><code>rows</code><code>paging.cursors.top</code><code>paging.cursors.last</code><code>null</code><code>paging.previous</code><code>paging.next</code><code>null</code></li>\n<li><code>paging.cursors.top</code><code>paging.cursors.last</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://dev.twitter.com/rest/reference/get/statuses/user_timeline\" target=\"_blank\" rel=\"noopener\">twitter API - GET statuses/user_timeline</a></li>\n</ul>\n"},{"title":"Golang","date":"2016-04-19T18:09:39.000Z","_content":"\n\n# \n\n<!-- TOC depthFrom:1 depthTo:2 withLinks:0 updateOnSave:1 orderedList:0 -->\n\n- \n- `dlog`\n- `dlog`\n- \n    - `panic``return error`\n    - `logger``data log`\n    - `data log`\n    - `Logger.Log`\n    - `logger``msg``buf`AWS Kinesis\n    - \n    - `Setup``TearDown`\n    - `kinesisMock`\n    - AWS Kinesis\n    - `log.Print`\n- \n- \n- \n\n<!-- /TOC -->\n\n# \n\n[](https://segmentfault.com/a/1190000002416822)Golog[dlog](https://github.com/topicai/dlog)Go\n\n> Go\n\n# `dlog`\n\n**readme**`dlog`\n\n> dlog is a Go package for distributed structure logging using Amazon AWS Kinesis/Firehose.\n\n[readme](https://github.com/topicai/dlog/blob/develop/README.md)\n\n`dlog``data log`Golang package`data log`\n\n- `status log`Bug\n- `data log``data log`\n\n\n# `dlog`\n\n- `data log``logger``logger``data log`\n- `dlog`\n    - AWS Kinesis\n- `dlog``data log``dlog``dlog`\n- AWS KinesisAPI[PutRecord](http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecord.html), [PutRecords](http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecords.html)Kinesis`data log`\n    - `PutRecords``record``500``record`1MB`request`5MB\n    - Kinesis StreamTPSstreamshardshardTPS`1000 records per second` `1MB per second`\n- \n\n\n# \n\n## `panic``return error`\n\n`panic``return error`\n\n### `panic`\n\n`panic``goroutine``panic``recover`\n\n```go\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    go func() {\n        log.Panic(\"some error before work2\")\n        fmt.Println(\"do some work2\")\n    }()\n\n    time.Sleep(time.Second)\n    fmt.Println(\"do some work1\")\n}\n```\n\n_[](https://play.golang.org/p/off1y9tBax)_\n\n`recover``goroutine``panic`\n\n```go\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    go func() {\n        defer func() {\n            if err := recover(); err != nil {\n                log.Printf(\"error: %v\", err)\n            }\n        }()\n        log.Panic(\"some error before work2\")\n        fmt.Println(\"do some work2\")\n    }()\n\n    time.Sleep(time.Second)\n    fmt.Println(\"do some work1\")\n}\n```\n\n_[](https://play.golang.org/p/RLWyb813Uw)_\n\nGo`panic``recover`Java.NET`throw``try...catch`\n\n### `return error`\n\n`return error`Go`caller`\n\n`return error``return error``panic/recover`\n\n```go\npackage main\n\nimport (\n    \"errors\"\n    \"log\"\n)\n\ntype R struct {\n}\n\nfunc f1() (error, *R) {\n    return errors.New(\"an error\"), nil\n}\n\nfunc f2() (error, *R) {\n    err, r := f1()\n    if err != nil {\n        return err, nil\n    }\n\n    return nil, r\n}\n\nfunc f3() (error, *R) {\n    err, r := f2()\n    if err != nil {\n        return err, nil\n    }\n\n    return nil, r\n}\n\nfunc main() {\n    err, _ := f3()\n    if err != nil {\n        log.Print(err)\n    }\n}\n```\n\n_[](https://play.golang.org/p/GhE5JpzZvn)_\n\n### `dlog`\n\n`panic``return error``panic``return error`\n\n`dlog``package`\n\n- `func NewLogger(example interface{}, opts *Options) (*Logger, error)`\n- `func (l *Logger) Log(msg interface{}) error`\n\n\n\n- `NewLogger`data log`NewLogger``logger``panic``return error``caller`Golang package\n- `logger.Log``Log``panic`\n    - `logger.Log``return error``msg`\n    - `logger.Log`AWS KinesisAWS Kinesis`panic``return error``logger``handler``handler`\n\n## `logger``data log`\n\n`logger``data log`\n\n- `Logger``msgType reflect.Type`\n- `NewLogger``logger``logger`\n- `Log``msg``logger`\n\n\n\n```go\n// msgTypeLogger\ntype Logger struct {\n    ...\n    msgType    reflect.Type\n    ...\n}\n\n// msgreflect.Type\nfunc msgType(msg interface{}) (reflect.Type, error) {\n    t := reflect.TypeOf(msg)\n\n    if t.Kind() == reflect.Ptr {\n        t = t.Elem()\n    }\n\n    if t.Kind() != reflect.Struct {\n        return nil, fmt.Errorf(\"dlog message must be either *struct or struct\")\n    }\n\n    return t, nil\n}\n\nfunc NewLogger(example interface{}, opts *Options) (*Logger, error) {\n    t, e := msgType(example)\n    if e != nil {\n        return nil, e\n    }\n\n    ...\n\n    l := &Logger{\n        ...\n        msgType:    t,\n        ...\n    }\n\n    ...\n    return l, nil\n}\n\nfunc (l *Logger) Log(msg interface{}) error {\n    if t, e := msgType(msg); e != nil {\n        return e\n    } else if !t.AssignableTo(l.msgType) {\n        return fmt.Errorf(\"parameter (%+v) not assignable to %v\", msg, l.msgType)\n    }\n\n    ...\n}\n```\n\n`Log``AssignableTo``msg``struct``AssignableTo``True`\n\n```go\npackage main\n\nimport (\n    \"log\"\n    \"reflect\"\n)\n\nfunc main() {\n    type Fn func(int) int\n    id := func(x int) int {\n        return x\n    }\n    var zeroFn Fn\n    log.Println(reflect.TypeOf(id).AssignableTo(reflect.TypeOf(zeroFn)))\n\n    type MyInt int\n    mi := 1\n    log.Println(reflect.TypeOf(2).AssignableTo(reflect.TypeOf(mi)))\n\n    type S1 struct {\n        name string\n    }\n    type S2 S1\n\n    s1 := S1{\n        name: \"ethan\",\n    }\n    s2 := S2{\n        name: \"ethan\",\n    }\n    // s2 = s1\t// if uncomment this line, will report \"cannot use s1 (type S1) as type S2 in assignment\" when compile\n    log.Println(reflect.TypeOf(s1).AssignableTo(reflect.TypeOf(s2)))\n}\n```\n\n_[](https://play.golang.org/p/eDmzxW-ayk)_\n\n## `data log`\n\n`buffer``message``buffer`AWS Kinesis`buffer`(goroutine)`buffer`\n\n- `buffer`\n- `channel``buffer`\n\nJava.NETCSP(Communicating Sequential Processes)\n\n{% asset_img channel.png CSP Model %}\n\n`dlog``Log``msg``buffer``channel``goroutine``channel``buf := make([][]byte, 0)``buf`AWS Kinesis`flush`AWS Kinesis`goroutine``buf``buf`\n\n<!--\ndigraph G {\n    fontname=\"Microsoft YaHei\";\n    fontsize=10;\n    rankdir = LR;\n\n    \"buffer channel\" [shape=box];\n\n    \"Logger.Log goroutine 1\" -> \"buffer channel\";\n    \"Logger.Log goroutine 2\" -> \"buffer channel\";\n    \"Logger.Log goroutine 3\" -> \"buffer channel\";\n    \"buffer channel\" -> \"sync goroutine\";\n    \"sync goroutine\" -> \"AWS Kinesis Stream\";\n}\n-->\n\n<!-- ![Thread Model](http://g.gravizo.com/g?digraph%20G%20%7B%0A%20%20%20%20fontname%3D%22Microsoft%20YaHei%22%3B%0A%20%20%20%20fontsize%3D10%3B%0A%20%20%20%20rankdir%20%3D%20LR%3B%0A%0A%20%20%20%20%22buffer%20channel%22%20%5Bshape%3Dbox%5D%3B%0A%0A%20%20%20%20%22Logger.Log%20goroutine%201%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22Logger.Log%20goroutine%202%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22Logger.Log%20goroutine%203%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22buffer%20channel%22%20-%3E%20%22sync%20goroutine%22%3B%0A%20%20%20%20%22sync%20goroutine%22%20-%3E%20%22AWS%20Kinesis%20Stream%22%3B%0A%20%7D) -->\n\n{% asset_img use_channel.png Channel %}\n\n\n\n```go\nfunc NewLogger(example interface{}, opts *Options) (*Logger, error) {\n    ...\n\n    go l.sync()    // sync goroutine\n    return l, nil\n}\n\nfunc (l *Logger) Log(msg interface{}) error {\n    ...\n\n    en := encode(msg)       // msg\n    ...\n        select {\n        case l.buffer <- en:    // buffer channelmsg\n        ...\n        }\n    ...\n    return nil\n}\n\nfunc (l *Logger) sync() {\n    ...\n\n    buf := make([][]byte, 0) // buffer channel\n    bufSize := 0\n\n    for {\n        select {\n        case msg := <-l.buffer:\n            if bufSize+len(msg)+partitionKeySize >= maxBatchSize {  // buf\n                l.flush(&buf, &bufSize)                             // AWS Kinesis\n            }\n\n            buf = append(buf, msg)                                  // buffer channelbuf\n            bufSize += len(msg) + partitionKeySize\n\n        ...\n    }\n}\n```\n\n## `Logger.Log`\n\nIO`caller`\n\n`Logger.Log`Go`channel`\n\n```go\nfunc (l *Logger) Log(msg interface{}) error {\n    ...\n\n    var timeout <-chan time.Time\n    if l.WriteTimeout > 0 {\n        timeout = time.After(l.WriteTimeout)    // l.WriteTimeout\n    }\n\n    ...\n        select {\n        case l.buffer <- en:\n        case <-timeout: // timeoutcase\n            return fmt.Errorf(\"dlog writes %+v timeout after %v\", msg, l.WriteTimeout)\n        }\n    ...\n    return nil\n}\n```\n\nJava.NETGo\n\n- C#\n    - [Implementing .Net method timeout](http://weblogs.asp.net/israelio/159985)\n    - [How to implement Task Async for a timer in C#?](http://stackoverflow.com/questions/18646650/how-to-implement-task-async-for-a-timer-in-c)\n    - [Implementing a timeout in c#](http://stackoverflow.com/questions/10143980/implementing-a-timeout-in-c-sharp)\n- Java\n    - [How to implement timeout using threads](http://www.coderanch.com/t/232213/threads/java/implement-timeout-threads)\n    - [How to timeout a thread](http://stackoverflow.com/questions/2275443/how-to-timeout-a-thread)\n\n## `logger``msg``buf`AWS Kinesis\n\n`dlog``Logger.sync()``buf`AWS Kinesis\n\n```go\nfunc (l *Logger) sync() {\n    if l.SyncPeriod <= 0 {\n        l.SyncPeriod = time.Second\n    }\n    ticker := time.NewTicker(l.SyncPeriod)  // l.SyncPeriodticker\n\n    buf := make([][]byte, 0)\n    bufSize := 0\n\n    for {  // sync goroutine\n        select {\n        case msg := <-l.buffer:\n            ...\n\n        case <-ticker.C: // ticker.C<-chan Timel.SyncPeriodcase\n            if bufSize > 0 {\n                l.flush(&buf, &bufSize)\n            }\n        }\n    }\n}\n```\n\n`ticker``dlog``msg``buf``l.SyncPeriod`AWS Kinesis\n\n\n\n## \n\nGoPackage `expvar``expvar`HTTP`/debug/vars`JSON`expvar`\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"expvar\"\n    \"fmt\"\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\n// Stats is used to collect runtime metrics\ntype Stats struct {\n    sync.Mutex\n    TotalHit  int\n    ErrorNums int\n}\n\nfunc (s *Stats) IncreaseTotalHit(i int) {\n    s.Lock()\n    defer s.Unlock()\n\n    s.TotalHit += i\n}\n\nfunc (s *Stats) IncreaseErrorNums(i int) {\n    s.Lock()\n    defer s.Unlock()\n\n    s.ErrorNums += i\n}\n\nfunc (s *Stats) String() string {\n    s.Lock()\n    defer s.Unlock()\n\n    b, err := json.Marshal(*s)\n    if err != nil {\n        return \"{}\"\n    } else {\n        return string(b)\n    }\n}\n\nvar (\n    stats *Stats\n    hits  *expvar.Map\n)\n\nfunc init() {\n\n    expvar.Publish(\"now\", expvar.Func(func() interface{} {\n        return time.Now().Format(\"\\\"2006-01-02 15:04:05\\\"\")\n    }))\n\n    stats = &Stats{}\n    expvar.Publish(\"stats\", stats)\n\n    hits = expvar.NewMap(\"hits\").Init()\n}\n\nfunc homeHandler(w http.ResponseWriter, r *http.Request) {\n    p := r.URL.Path[1:]\n    hits.Add(p, 1)\n    stats.IncreaseTotalHit(1)\n    fmt.Fprintf(w, \"Hey! I love %s! hits: %v\\n\", p, hits.Get(p))\n}\n\nfunc errHandler(w http.ResponseWriter, r *http.Request) {\n    stats.IncreaseErrorNums(1)\n    fmt.Fprintf(w, \"Error Nums: %v\\n\", stats.ErrorNums)\n}\n\nfunc main() {\n    http.HandleFunc(\"/err\", errHandler)\n    http.HandleFunc(\"/\", homeHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n```\n\n\n\n- `go run expvarexample.go`\n- `http://localhost:8080/ethan`\n- `http://localhost:8080/err`\n- `http://localhost:8080/debug/vars`\n```json\n{\n    \"cmdline\": [\"/var/folders/jf/65ft181j33j_d75ktgv67bsc0000gn/T/go-build467453980/command-line-arguments/_obj/exe/expvarsample\"],\n    \"hits\": {\n        \"ethan\": 1,\n        \"favicon.ico\": 2\n    },\n    \"memstats\": { ... },\n    \"now\": \"\\\"2016-04-19 20:17:40\\\"\",\n    \"stats\": {\n        \"TotalHit\":3,\n        \"ErrorNums\":1\n    }\n}\n```\n\n[expvarmon](https://github.com/divan/expvarmon)`expvar`\n\n- `go get github.com/divan/expvarmon`\n- `expvarmon -ports=\"8080\" -vars=\"hits.ethan,stats.TotalHit,stats.ErrorNums,now\"`\n- \n{% asset_img expvarmon_screen.png expvarmon screen %}\n\n`dlog``expvar``dlog`\n\n- `writtenRecords`: AWS Kinesis`msg`\n- `writtenBatches`: AWS KinesisAPI\n- `failedRecords`: AWS Kinesis`msg`\n- `tooBigMesssages`: (partitionKeySize1MB)`msg`\n\n\n\n## `Setup``TearDown`\n\nGo****`go test``testing` package[](http://docs.studygolang.com/doc/code.html#Testing)Go\n\n```go\n//$GOPATH/src/github.com/user/stringutil/reverse_test.go\npackage stringutil\n\nimport \"testing\"\n\nfunc TestReverse(t *testing.T) {\n    cases := []struct {\n        in, want string\n    }{\n        {\"Hello, world\", \"dlrow ,olleH\"},\n        {\"Hello, \", \" ,olleH\"},\n        {\"\", \"\"},\n    }\n    for _, c := range cases {\n        got := Reverse(c.in)\n        if got != c.want {\n            t.Errorf(\"Reverse(%q) == %q, want %q\", c.in, got, c.want)\n        }\n    }\n}\n```\n\n\n\n```go\n$ go test github.com/user/stringutil\nok  \tgithub.com/user/stringutil 0.165s\n```\n\nIaaS[testify/suite](https://github.com/stretchr/testify/suite) package[testify/suite](https://github.com/stretchr/testify/suite)`struct``setup`()/`teardown`()`go test`\n\n[testify/suite](https://github.com/stretchr/testify/suite)\n\n```go\npackage suite\n\nimport (\n    \"testing\"\n\n    \"github.com/stretchr/testify/assert\"\n)\n\ntype SuiteTester struct {\n    // Include our basic suite logic.\n    Suite\n\n    // Other properties\n    propertyN string\n}\n\n// The SetupSuite method will be run by testify once, at the very\n// start of the testing suite, before any tests are run.\nfunc (suite *SuiteTester) SetupSuite() {\n    // ...\n}\n\n// The TearDownSuite method will be run by testify once, at the very\n// end of the testing suite, after all tests have been run.\nfunc (suite *SuiteTester) TearDownSuite() {\n    // ...\n}\n\n// The SetupTest method will be run before every test in the suite.\nfunc (suite *SuiteTester) SetupTest() {\n    // ...\n}\n\n// The TearDownTest method will be run after every test in the suite.\nfunc (suite *SuiteTester) TearDownTest() {\n    // ...\n}\n\n// a test method\nfunc (suite *SuiteTester) TestOne() {\n    // ...\n}\n\n// another test method\nfunc (suite *SuiteTester) TestTwo() {\n    // ...\n}\n\n// TestRunSuite will be run by the 'go test' command, so within it, we\n// can run our suite using the Run(*testing.T, TestingSuite) function.\nfunc TestRunSuite(t *testing.T) {\n    suiteTester := new(SuiteTester)\n    Run(t, suiteTester)\n}\n```\n\n`dlog``Logger.Log`\n\n```go\npackage dlog\n\n//...\n\ntype WriteLogSuiteTester struct {\n    suite.Suite\n\n    options     *Options\n    seachLogger *Logger\n    clickLogger *Logger\n    streamNames []string // save the created AWS Kinesis Streams, which will be removed in TearDownSuite()\n}\n\n// The SetupSuite method will be run by testify once, at the very\n// start of the testing suite, before any tests are run.\nfunc (s *WriteLogSuiteTester) SetupSuite() {\n\n    //...\n\n    // create stream 1\n    err = s.seachLogger.kinesis.CreateStream(s.seachLogger.streamName, testingShardCount)\n    s.Nil(err)\n\n    // create stream 2\n    err = s.clickLogger.kinesis.CreateStream(s.clickLogger.streamName, testingShardCount)\n    s.Nil(err)\n\n    s.streamNames = []string{s.seachLogger.streamName, s.clickLogger.streamName}\n\n    for { // waiting created stream's status to be active\n        time.Sleep(1 * time.Second)\n        resp1, err1 := s.seachLogger.kinesis.DescribeStream(s.seachLogger.streamName)\n        s.Nil(err1)\n\n        resp2, err2 := s.seachLogger.kinesis.DescribeStream(s.clickLogger.streamName)\n        s.Nil(err2)\n\n        status1 := strings.ToLower(string(resp1.StreamStatus))\n        status2 := strings.ToLower(string(resp2.StreamStatus))\n        if status1 == \"active\" && status2 == \"active\" {\n            break\n        }\n    }\n}\n\n// The TearDownSuite method will be run by testify once, at the very\n// end of the testing suite, after all tests have been run.\nfunc (s *WriteLogSuiteTester) TearDownSuite() {\n    if s.streamNames == nil || len(s.streamNames) == 0 {\n        return\n    }\n\n    for _, streamName := range s.streamNames {\n        err := s.seachLogger.kinesis.DeleteStream(streamName)\n        s.Nil(err)\n    }\n}\n\nfunc (s *WriteLogSuiteTester) TestWriteLog() {\n    defer func() { // Recover if panicking to make sure TearDownSuite will be executed\n        if r := recover(); r != nil {\n            s.Fail(fmt.Sprint(r))\n        }\n    }()\n\n    //...\n}\n\nfunc TestRunWriteLogSuite(t *testing.T) {\n    suiteTester := new(WriteLogSuiteTester)\n    suite.Run(t, suiteTester)\n}\n```\n\n\n\n- \n- \n    - \n    - \n    - \n\n## `kinesisMock`\n\nMock\n\n`dlog``KinesisInterface`:\n\n```go\ntype KinesisInterface interface {\n    PutRecords(streamName string, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error)\n    CreateStream(name string, shardCount int) error\n    DescribeStream(name string) (resp *kinesis.StreamDescription, err error)\n    DeleteStream(name string) error\n}\n```\n\n`KinesisInterface``dlog`[github.com/AdRoll/goamz/kinesis/kinesis](https://github.com/AdRoll/goamz/blob/master/kinesis/kinesis.go)Go`interface`****[github.com/AdRoll/goamz/kinesis/kinesis](https://github.com/AdRoll/goamz/blob/master/kinesis/kinesis.go)`KinesisInterface``kinesisMock``KinesisInterface`\n\n```go\ntype kinesisMock struct {\n    // Mapping from steam name to batches of batches\n    storage map[string][][]kinesis.PutRecordsRequestEntry\n\n    // simulate lantency that sync to Kinesis\n    putRecordLatency time.Duration\n\n    // created streams' names\n    streamNames []string\n\n    // lock to solve concurrent call\n    lock sync.RWMutex\n}\n\nfunc newKinesisMock(putRecordsLatency time.Duration) *kinesisMock {\n    return &kinesisMock{\n        storage:          make(map[string][][]kinesis.PutRecordsRequestEntry),\n        putRecordLatency: putRecordsLatency,\n        streamNames:      make([]string, 0),\n    }\n}\n\nfunc (mock *kinesisMock) PutRecords(streamName string, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error) {\n    // ...\n}\n\nfunc (mock *kinesisMock) CreateStream(name string, shardCount int) error {\n    // ...\n}\n\nfunc (mock *kinesisMock) DescribeStream(name string) (resp *kinesis.StreamDescription, err error) {\n    // ...\n}\n\nfunc (mock *kinesisMock) DeleteStream(name string) error {\n    // ...\n}\n```\n\n`kinesis``KinesisInterface`\n\n```go\ntype Logger struct {\n    //...\n    kinesis    KinesisInterface\n    //...\n}\n```\n\n`Logger``kinesisMock``kinesis`\n\n```go\nfunc TestLoggingToMockKinesis(t *testing.T) {\n    assert := assert.New(t)\n\n    l, e := NewLogger(&impression{}, &Options{\n        // ...\n        UseMockKinesis: true,\n        MockKinesis:    newKinesisMock(0),\n    })\n\n    // ...\n}\n```\n\n## AWS Kinesis\n\n`kinesisMock``kinesis`\n\n`kinesisMock``putRecordLatency``PutRecords`\n\n```go\ntype kinesisMock struct {\n    // ...\n\n    // simulate lantency that sync to Kinesis\n    putRecordLatency time.Duration\n\n    // ...\n}\n\nfunc (mock *kinesisMock) PutRecords(streamName string, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error) {\n    //...\n\n    time.Sleep(mock.putRecordLatency) // \n\n    //...\n}\n```\n\n`kinesis``brokenKinesisMock`\n\n```go\ntype brokenKinesisMock struct {\n    *kinesisMock\n}\n\nfunc newBrokenKinesisMock() *brokenKinesisMock {\n    return &brokenKinesisMock{\n        kinesisMock: newKinesisMock(0),\n    }\n}\n\nfunc (mock *brokenKinesisMock) PutRecords(streamName string, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error) {\n    return nil, fmt.Errorf(\"Kinesis is broken\")\n}\n```\n\n`kinesisMock``brokenKinesisMock``struct``brokenKinesisMock``kinesisMock``KinesisInterface`\n\n## `log.Print`\n\n\n\n- `log.Print``stdout`\n- `go test``-v``log.Print``log.Print`\n\n\n# \n\n- [AWS Kinesis API - CreateStream](http://docs.aws.amazon.com/kinesis/latest/APIReference/API_CreateStream.html)Stream10+Stream\n- [github.com/AdRoll/goamz/aws/regions.go](https://github.com/AdRoll/goamz/blob/master/aws/regions.go)AWS KinesisURLAWS Kinesis\n- Travis CIKill1CI10\n\n\n# \n\n- \n- Kinesis`dlog`\n\n\n# \n\n- [Effective Go](http://docs.studygolang.com/doc/effective_go.html)\n- [Amazon Kinesis Documentation](https://aws.amazon.com/cn/documentation/kinesis/)\n- [Advanced Go Concurrency Patterns](http://blog.golang.org/advanced-go-concurrency-patterns)\n- [hystrix-go](https://github.com/afex/hystrix-go)\n\n\n# \n\n[](http://www.augmn.com)(ethancai@qq.com)\n\n{% asset_img 2016-04-21_07-12-24.png 1 %}\n\n{% asset_img 2016-04-21_07-12-40.png 2 %}\n\n** / Backend Engineer**\n\n\n\n- \n- micro-service\n- \n- Code Review\n\n\n\n- \n- GoNode.jsC++Python\n- RESTfulRPC\n- web serviceweb app\n- MysqlRedisMongoDB\n- \n- \n- \n- 53\n\n\n** / Senior Ops Engineer**\n\n\n\n- AWS\n- \n- \n- \n- 7*24\n- IT\n\n\n\n- Linux/UnixLinux\n- TCP/IPHTTP\n- NginxDNSNTP\n- ShellPythonPerl Ruby\n- Linuxgrepawksedtmuxvim\n- MySQL\n- \n-  2 AWS\n- DevOps\n- \n- \n- \n- \n","source":"_posts/experiences-about-develop-dlog.md","raw":"---\ntitle: Golang\ntags:\n  - data log\n  - golang\ncategories:\n  - \ndate: 2016-04-20 02:09:39\n---\n\n\n# \n\n<!-- TOC depthFrom:1 depthTo:2 withLinks:0 updateOnSave:1 orderedList:0 -->\n\n- \n- `dlog`\n- `dlog`\n- \n    - `panic``return error`\n    - `logger``data log`\n    - `data log`\n    - `Logger.Log`\n    - `logger``msg``buf`AWS Kinesis\n    - \n    - `Setup``TearDown`\n    - `kinesisMock`\n    - AWS Kinesis\n    - `log.Print`\n- \n- \n- \n\n<!-- /TOC -->\n\n# \n\n[](https://segmentfault.com/a/1190000002416822)Golog[dlog](https://github.com/topicai/dlog)Go\n\n> Go\n\n# `dlog`\n\n**readme**`dlog`\n\n> dlog is a Go package for distributed structure logging using Amazon AWS Kinesis/Firehose.\n\n[readme](https://github.com/topicai/dlog/blob/develop/README.md)\n\n`dlog``data log`Golang package`data log`\n\n- `status log`Bug\n- `data log``data log`\n\n\n# `dlog`\n\n- `data log``logger``logger``data log`\n- `dlog`\n    - AWS Kinesis\n- `dlog``data log``dlog``dlog`\n- AWS KinesisAPI[PutRecord](http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecord.html), [PutRecords](http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecords.html)Kinesis`data log`\n    - `PutRecords``record``500``record`1MB`request`5MB\n    - Kinesis StreamTPSstreamshardshardTPS`1000 records per second` `1MB per second`\n- \n\n\n# \n\n## `panic``return error`\n\n`panic``return error`\n\n### `panic`\n\n`panic``goroutine``panic``recover`\n\n```go\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    go func() {\n        log.Panic(\"some error before work2\")\n        fmt.Println(\"do some work2\")\n    }()\n\n    time.Sleep(time.Second)\n    fmt.Println(\"do some work1\")\n}\n```\n\n_[](https://play.golang.org/p/off1y9tBax)_\n\n`recover``goroutine``panic`\n\n```go\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    go func() {\n        defer func() {\n            if err := recover(); err != nil {\n                log.Printf(\"error: %v\", err)\n            }\n        }()\n        log.Panic(\"some error before work2\")\n        fmt.Println(\"do some work2\")\n    }()\n\n    time.Sleep(time.Second)\n    fmt.Println(\"do some work1\")\n}\n```\n\n_[](https://play.golang.org/p/RLWyb813Uw)_\n\nGo`panic``recover`Java.NET`throw``try...catch`\n\n### `return error`\n\n`return error`Go`caller`\n\n`return error``return error``panic/recover`\n\n```go\npackage main\n\nimport (\n    \"errors\"\n    \"log\"\n)\n\ntype R struct {\n}\n\nfunc f1() (error, *R) {\n    return errors.New(\"an error\"), nil\n}\n\nfunc f2() (error, *R) {\n    err, r := f1()\n    if err != nil {\n        return err, nil\n    }\n\n    return nil, r\n}\n\nfunc f3() (error, *R) {\n    err, r := f2()\n    if err != nil {\n        return err, nil\n    }\n\n    return nil, r\n}\n\nfunc main() {\n    err, _ := f3()\n    if err != nil {\n        log.Print(err)\n    }\n}\n```\n\n_[](https://play.golang.org/p/GhE5JpzZvn)_\n\n### `dlog`\n\n`panic``return error``panic``return error`\n\n`dlog``package`\n\n- `func NewLogger(example interface{}, opts *Options) (*Logger, error)`\n- `func (l *Logger) Log(msg interface{}) error`\n\n\n\n- `NewLogger`data log`NewLogger``logger``panic``return error``caller`Golang package\n- `logger.Log``Log``panic`\n    - `logger.Log``return error``msg`\n    - `logger.Log`AWS KinesisAWS Kinesis`panic``return error``logger``handler``handler`\n\n## `logger``data log`\n\n`logger``data log`\n\n- `Logger``msgType reflect.Type`\n- `NewLogger``logger``logger`\n- `Log``msg``logger`\n\n\n\n```go\n// msgTypeLogger\ntype Logger struct {\n    ...\n    msgType    reflect.Type\n    ...\n}\n\n// msgreflect.Type\nfunc msgType(msg interface{}) (reflect.Type, error) {\n    t := reflect.TypeOf(msg)\n\n    if t.Kind() == reflect.Ptr {\n        t = t.Elem()\n    }\n\n    if t.Kind() != reflect.Struct {\n        return nil, fmt.Errorf(\"dlog message must be either *struct or struct\")\n    }\n\n    return t, nil\n}\n\nfunc NewLogger(example interface{}, opts *Options) (*Logger, error) {\n    t, e := msgType(example)\n    if e != nil {\n        return nil, e\n    }\n\n    ...\n\n    l := &Logger{\n        ...\n        msgType:    t,\n        ...\n    }\n\n    ...\n    return l, nil\n}\n\nfunc (l *Logger) Log(msg interface{}) error {\n    if t, e := msgType(msg); e != nil {\n        return e\n    } else if !t.AssignableTo(l.msgType) {\n        return fmt.Errorf(\"parameter (%+v) not assignable to %v\", msg, l.msgType)\n    }\n\n    ...\n}\n```\n\n`Log``AssignableTo``msg``struct``AssignableTo``True`\n\n```go\npackage main\n\nimport (\n    \"log\"\n    \"reflect\"\n)\n\nfunc main() {\n    type Fn func(int) int\n    id := func(x int) int {\n        return x\n    }\n    var zeroFn Fn\n    log.Println(reflect.TypeOf(id).AssignableTo(reflect.TypeOf(zeroFn)))\n\n    type MyInt int\n    mi := 1\n    log.Println(reflect.TypeOf(2).AssignableTo(reflect.TypeOf(mi)))\n\n    type S1 struct {\n        name string\n    }\n    type S2 S1\n\n    s1 := S1{\n        name: \"ethan\",\n    }\n    s2 := S2{\n        name: \"ethan\",\n    }\n    // s2 = s1\t// if uncomment this line, will report \"cannot use s1 (type S1) as type S2 in assignment\" when compile\n    log.Println(reflect.TypeOf(s1).AssignableTo(reflect.TypeOf(s2)))\n}\n```\n\n_[](https://play.golang.org/p/eDmzxW-ayk)_\n\n## `data log`\n\n`buffer``message``buffer`AWS Kinesis`buffer`(goroutine)`buffer`\n\n- `buffer`\n- `channel``buffer`\n\nJava.NETCSP(Communicating Sequential Processes)\n\n{% asset_img channel.png CSP Model %}\n\n`dlog``Log``msg``buffer``channel``goroutine``channel``buf := make([][]byte, 0)``buf`AWS Kinesis`flush`AWS Kinesis`goroutine``buf``buf`\n\n<!--\ndigraph G {\n    fontname=\"Microsoft YaHei\";\n    fontsize=10;\n    rankdir = LR;\n\n    \"buffer channel\" [shape=box];\n\n    \"Logger.Log goroutine 1\" -> \"buffer channel\";\n    \"Logger.Log goroutine 2\" -> \"buffer channel\";\n    \"Logger.Log goroutine 3\" -> \"buffer channel\";\n    \"buffer channel\" -> \"sync goroutine\";\n    \"sync goroutine\" -> \"AWS Kinesis Stream\";\n}\n-->\n\n<!-- ![Thread Model](http://g.gravizo.com/g?digraph%20G%20%7B%0A%20%20%20%20fontname%3D%22Microsoft%20YaHei%22%3B%0A%20%20%20%20fontsize%3D10%3B%0A%20%20%20%20rankdir%20%3D%20LR%3B%0A%0A%20%20%20%20%22buffer%20channel%22%20%5Bshape%3Dbox%5D%3B%0A%0A%20%20%20%20%22Logger.Log%20goroutine%201%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22Logger.Log%20goroutine%202%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22Logger.Log%20goroutine%203%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22buffer%20channel%22%20-%3E%20%22sync%20goroutine%22%3B%0A%20%20%20%20%22sync%20goroutine%22%20-%3E%20%22AWS%20Kinesis%20Stream%22%3B%0A%20%7D) -->\n\n{% asset_img use_channel.png Channel %}\n\n\n\n```go\nfunc NewLogger(example interface{}, opts *Options) (*Logger, error) {\n    ...\n\n    go l.sync()    // sync goroutine\n    return l, nil\n}\n\nfunc (l *Logger) Log(msg interface{}) error {\n    ...\n\n    en := encode(msg)       // msg\n    ...\n        select {\n        case l.buffer <- en:    // buffer channelmsg\n        ...\n        }\n    ...\n    return nil\n}\n\nfunc (l *Logger) sync() {\n    ...\n\n    buf := make([][]byte, 0) // buffer channel\n    bufSize := 0\n\n    for {\n        select {\n        case msg := <-l.buffer:\n            if bufSize+len(msg)+partitionKeySize >= maxBatchSize {  // buf\n                l.flush(&buf, &bufSize)                             // AWS Kinesis\n            }\n\n            buf = append(buf, msg)                                  // buffer channelbuf\n            bufSize += len(msg) + partitionKeySize\n\n        ...\n    }\n}\n```\n\n## `Logger.Log`\n\nIO`caller`\n\n`Logger.Log`Go`channel`\n\n```go\nfunc (l *Logger) Log(msg interface{}) error {\n    ...\n\n    var timeout <-chan time.Time\n    if l.WriteTimeout > 0 {\n        timeout = time.After(l.WriteTimeout)    // l.WriteTimeout\n    }\n\n    ...\n        select {\n        case l.buffer <- en:\n        case <-timeout: // timeoutcase\n            return fmt.Errorf(\"dlog writes %+v timeout after %v\", msg, l.WriteTimeout)\n        }\n    ...\n    return nil\n}\n```\n\nJava.NETGo\n\n- C#\n    - [Implementing .Net method timeout](http://weblogs.asp.net/israelio/159985)\n    - [How to implement Task Async for a timer in C#?](http://stackoverflow.com/questions/18646650/how-to-implement-task-async-for-a-timer-in-c)\n    - [Implementing a timeout in c#](http://stackoverflow.com/questions/10143980/implementing-a-timeout-in-c-sharp)\n- Java\n    - [How to implement timeout using threads](http://www.coderanch.com/t/232213/threads/java/implement-timeout-threads)\n    - [How to timeout a thread](http://stackoverflow.com/questions/2275443/how-to-timeout-a-thread)\n\n## `logger``msg``buf`AWS Kinesis\n\n`dlog``Logger.sync()``buf`AWS Kinesis\n\n```go\nfunc (l *Logger) sync() {\n    if l.SyncPeriod <= 0 {\n        l.SyncPeriod = time.Second\n    }\n    ticker := time.NewTicker(l.SyncPeriod)  // l.SyncPeriodticker\n\n    buf := make([][]byte, 0)\n    bufSize := 0\n\n    for {  // sync goroutine\n        select {\n        case msg := <-l.buffer:\n            ...\n\n        case <-ticker.C: // ticker.C<-chan Timel.SyncPeriodcase\n            if bufSize > 0 {\n                l.flush(&buf, &bufSize)\n            }\n        }\n    }\n}\n```\n\n`ticker``dlog``msg``buf``l.SyncPeriod`AWS Kinesis\n\n\n\n## \n\nGoPackage `expvar``expvar`HTTP`/debug/vars`JSON`expvar`\n\n```go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"expvar\"\n    \"fmt\"\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\n// Stats is used to collect runtime metrics\ntype Stats struct {\n    sync.Mutex\n    TotalHit  int\n    ErrorNums int\n}\n\nfunc (s *Stats) IncreaseTotalHit(i int) {\n    s.Lock()\n    defer s.Unlock()\n\n    s.TotalHit += i\n}\n\nfunc (s *Stats) IncreaseErrorNums(i int) {\n    s.Lock()\n    defer s.Unlock()\n\n    s.ErrorNums += i\n}\n\nfunc (s *Stats) String() string {\n    s.Lock()\n    defer s.Unlock()\n\n    b, err := json.Marshal(*s)\n    if err != nil {\n        return \"{}\"\n    } else {\n        return string(b)\n    }\n}\n\nvar (\n    stats *Stats\n    hits  *expvar.Map\n)\n\nfunc init() {\n\n    expvar.Publish(\"now\", expvar.Func(func() interface{} {\n        return time.Now().Format(\"\\\"2006-01-02 15:04:05\\\"\")\n    }))\n\n    stats = &Stats{}\n    expvar.Publish(\"stats\", stats)\n\n    hits = expvar.NewMap(\"hits\").Init()\n}\n\nfunc homeHandler(w http.ResponseWriter, r *http.Request) {\n    p := r.URL.Path[1:]\n    hits.Add(p, 1)\n    stats.IncreaseTotalHit(1)\n    fmt.Fprintf(w, \"Hey! I love %s! hits: %v\\n\", p, hits.Get(p))\n}\n\nfunc errHandler(w http.ResponseWriter, r *http.Request) {\n    stats.IncreaseErrorNums(1)\n    fmt.Fprintf(w, \"Error Nums: %v\\n\", stats.ErrorNums)\n}\n\nfunc main() {\n    http.HandleFunc(\"/err\", errHandler)\n    http.HandleFunc(\"/\", homeHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n```\n\n\n\n- `go run expvarexample.go`\n- `http://localhost:8080/ethan`\n- `http://localhost:8080/err`\n- `http://localhost:8080/debug/vars`\n```json\n{\n    \"cmdline\": [\"/var/folders/jf/65ft181j33j_d75ktgv67bsc0000gn/T/go-build467453980/command-line-arguments/_obj/exe/expvarsample\"],\n    \"hits\": {\n        \"ethan\": 1,\n        \"favicon.ico\": 2\n    },\n    \"memstats\": { ... },\n    \"now\": \"\\\"2016-04-19 20:17:40\\\"\",\n    \"stats\": {\n        \"TotalHit\":3,\n        \"ErrorNums\":1\n    }\n}\n```\n\n[expvarmon](https://github.com/divan/expvarmon)`expvar`\n\n- `go get github.com/divan/expvarmon`\n- `expvarmon -ports=\"8080\" -vars=\"hits.ethan,stats.TotalHit,stats.ErrorNums,now\"`\n- \n{% asset_img expvarmon_screen.png expvarmon screen %}\n\n`dlog``expvar``dlog`\n\n- `writtenRecords`: AWS Kinesis`msg`\n- `writtenBatches`: AWS KinesisAPI\n- `failedRecords`: AWS Kinesis`msg`\n- `tooBigMesssages`: (partitionKeySize1MB)`msg`\n\n\n\n## `Setup``TearDown`\n\nGo****`go test``testing` package[](http://docs.studygolang.com/doc/code.html#Testing)Go\n\n```go\n//$GOPATH/src/github.com/user/stringutil/reverse_test.go\npackage stringutil\n\nimport \"testing\"\n\nfunc TestReverse(t *testing.T) {\n    cases := []struct {\n        in, want string\n    }{\n        {\"Hello, world\", \"dlrow ,olleH\"},\n        {\"Hello, \", \" ,olleH\"},\n        {\"\", \"\"},\n    }\n    for _, c := range cases {\n        got := Reverse(c.in)\n        if got != c.want {\n            t.Errorf(\"Reverse(%q) == %q, want %q\", c.in, got, c.want)\n        }\n    }\n}\n```\n\n\n\n```go\n$ go test github.com/user/stringutil\nok  \tgithub.com/user/stringutil 0.165s\n```\n\nIaaS[testify/suite](https://github.com/stretchr/testify/suite) package[testify/suite](https://github.com/stretchr/testify/suite)`struct``setup`()/`teardown`()`go test`\n\n[testify/suite](https://github.com/stretchr/testify/suite)\n\n```go\npackage suite\n\nimport (\n    \"testing\"\n\n    \"github.com/stretchr/testify/assert\"\n)\n\ntype SuiteTester struct {\n    // Include our basic suite logic.\n    Suite\n\n    // Other properties\n    propertyN string\n}\n\n// The SetupSuite method will be run by testify once, at the very\n// start of the testing suite, before any tests are run.\nfunc (suite *SuiteTester) SetupSuite() {\n    // ...\n}\n\n// The TearDownSuite method will be run by testify once, at the very\n// end of the testing suite, after all tests have been run.\nfunc (suite *SuiteTester) TearDownSuite() {\n    // ...\n}\n\n// The SetupTest method will be run before every test in the suite.\nfunc (suite *SuiteTester) SetupTest() {\n    // ...\n}\n\n// The TearDownTest method will be run after every test in the suite.\nfunc (suite *SuiteTester) TearDownTest() {\n    // ...\n}\n\n// a test method\nfunc (suite *SuiteTester) TestOne() {\n    // ...\n}\n\n// another test method\nfunc (suite *SuiteTester) TestTwo() {\n    // ...\n}\n\n// TestRunSuite will be run by the 'go test' command, so within it, we\n// can run our suite using the Run(*testing.T, TestingSuite) function.\nfunc TestRunSuite(t *testing.T) {\n    suiteTester := new(SuiteTester)\n    Run(t, suiteTester)\n}\n```\n\n`dlog``Logger.Log`\n\n```go\npackage dlog\n\n//...\n\ntype WriteLogSuiteTester struct {\n    suite.Suite\n\n    options     *Options\n    seachLogger *Logger\n    clickLogger *Logger\n    streamNames []string // save the created AWS Kinesis Streams, which will be removed in TearDownSuite()\n}\n\n// The SetupSuite method will be run by testify once, at the very\n// start of the testing suite, before any tests are run.\nfunc (s *WriteLogSuiteTester) SetupSuite() {\n\n    //...\n\n    // create stream 1\n    err = s.seachLogger.kinesis.CreateStream(s.seachLogger.streamName, testingShardCount)\n    s.Nil(err)\n\n    // create stream 2\n    err = s.clickLogger.kinesis.CreateStream(s.clickLogger.streamName, testingShardCount)\n    s.Nil(err)\n\n    s.streamNames = []string{s.seachLogger.streamName, s.clickLogger.streamName}\n\n    for { // waiting created stream's status to be active\n        time.Sleep(1 * time.Second)\n        resp1, err1 := s.seachLogger.kinesis.DescribeStream(s.seachLogger.streamName)\n        s.Nil(err1)\n\n        resp2, err2 := s.seachLogger.kinesis.DescribeStream(s.clickLogger.streamName)\n        s.Nil(err2)\n\n        status1 := strings.ToLower(string(resp1.StreamStatus))\n        status2 := strings.ToLower(string(resp2.StreamStatus))\n        if status1 == \"active\" && status2 == \"active\" {\n            break\n        }\n    }\n}\n\n// The TearDownSuite method will be run by testify once, at the very\n// end of the testing suite, after all tests have been run.\nfunc (s *WriteLogSuiteTester) TearDownSuite() {\n    if s.streamNames == nil || len(s.streamNames) == 0 {\n        return\n    }\n\n    for _, streamName := range s.streamNames {\n        err := s.seachLogger.kinesis.DeleteStream(streamName)\n        s.Nil(err)\n    }\n}\n\nfunc (s *WriteLogSuiteTester) TestWriteLog() {\n    defer func() { // Recover if panicking to make sure TearDownSuite will be executed\n        if r := recover(); r != nil {\n            s.Fail(fmt.Sprint(r))\n        }\n    }()\n\n    //...\n}\n\nfunc TestRunWriteLogSuite(t *testing.T) {\n    suiteTester := new(WriteLogSuiteTester)\n    suite.Run(t, suiteTester)\n}\n```\n\n\n\n- \n- \n    - \n    - \n    - \n\n## `kinesisMock`\n\nMock\n\n`dlog``KinesisInterface`:\n\n```go\ntype KinesisInterface interface {\n    PutRecords(streamName string, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error)\n    CreateStream(name string, shardCount int) error\n    DescribeStream(name string) (resp *kinesis.StreamDescription, err error)\n    DeleteStream(name string) error\n}\n```\n\n`KinesisInterface``dlog`[github.com/AdRoll/goamz/kinesis/kinesis](https://github.com/AdRoll/goamz/blob/master/kinesis/kinesis.go)Go`interface`****[github.com/AdRoll/goamz/kinesis/kinesis](https://github.com/AdRoll/goamz/blob/master/kinesis/kinesis.go)`KinesisInterface``kinesisMock``KinesisInterface`\n\n```go\ntype kinesisMock struct {\n    // Mapping from steam name to batches of batches\n    storage map[string][][]kinesis.PutRecordsRequestEntry\n\n    // simulate lantency that sync to Kinesis\n    putRecordLatency time.Duration\n\n    // created streams' names\n    streamNames []string\n\n    // lock to solve concurrent call\n    lock sync.RWMutex\n}\n\nfunc newKinesisMock(putRecordsLatency time.Duration) *kinesisMock {\n    return &kinesisMock{\n        storage:          make(map[string][][]kinesis.PutRecordsRequestEntry),\n        putRecordLatency: putRecordsLatency,\n        streamNames:      make([]string, 0),\n    }\n}\n\nfunc (mock *kinesisMock) PutRecords(streamName string, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error) {\n    // ...\n}\n\nfunc (mock *kinesisMock) CreateStream(name string, shardCount int) error {\n    // ...\n}\n\nfunc (mock *kinesisMock) DescribeStream(name string) (resp *kinesis.StreamDescription, err error) {\n    // ...\n}\n\nfunc (mock *kinesisMock) DeleteStream(name string) error {\n    // ...\n}\n```\n\n`kinesis``KinesisInterface`\n\n```go\ntype Logger struct {\n    //...\n    kinesis    KinesisInterface\n    //...\n}\n```\n\n`Logger``kinesisMock``kinesis`\n\n```go\nfunc TestLoggingToMockKinesis(t *testing.T) {\n    assert := assert.New(t)\n\n    l, e := NewLogger(&impression{}, &Options{\n        // ...\n        UseMockKinesis: true,\n        MockKinesis:    newKinesisMock(0),\n    })\n\n    // ...\n}\n```\n\n## AWS Kinesis\n\n`kinesisMock``kinesis`\n\n`kinesisMock``putRecordLatency``PutRecords`\n\n```go\ntype kinesisMock struct {\n    // ...\n\n    // simulate lantency that sync to Kinesis\n    putRecordLatency time.Duration\n\n    // ...\n}\n\nfunc (mock *kinesisMock) PutRecords(streamName string, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error) {\n    //...\n\n    time.Sleep(mock.putRecordLatency) // \n\n    //...\n}\n```\n\n`kinesis``brokenKinesisMock`\n\n```go\ntype brokenKinesisMock struct {\n    *kinesisMock\n}\n\nfunc newBrokenKinesisMock() *brokenKinesisMock {\n    return &brokenKinesisMock{\n        kinesisMock: newKinesisMock(0),\n    }\n}\n\nfunc (mock *brokenKinesisMock) PutRecords(streamName string, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error) {\n    return nil, fmt.Errorf(\"Kinesis is broken\")\n}\n```\n\n`kinesisMock``brokenKinesisMock``struct``brokenKinesisMock``kinesisMock``KinesisInterface`\n\n## `log.Print`\n\n\n\n- `log.Print``stdout`\n- `go test``-v``log.Print``log.Print`\n\n\n# \n\n- [AWS Kinesis API - CreateStream](http://docs.aws.amazon.com/kinesis/latest/APIReference/API_CreateStream.html)Stream10+Stream\n- [github.com/AdRoll/goamz/aws/regions.go](https://github.com/AdRoll/goamz/blob/master/aws/regions.go)AWS KinesisURLAWS Kinesis\n- Travis CIKill1CI10\n\n\n# \n\n- \n- Kinesis`dlog`\n\n\n# \n\n- [Effective Go](http://docs.studygolang.com/doc/effective_go.html)\n- [Amazon Kinesis Documentation](https://aws.amazon.com/cn/documentation/kinesis/)\n- [Advanced Go Concurrency Patterns](http://blog.golang.org/advanced-go-concurrency-patterns)\n- [hystrix-go](https://github.com/afex/hystrix-go)\n\n\n# \n\n[](http://www.augmn.com)(ethancai@qq.com)\n\n{% asset_img 2016-04-21_07-12-24.png 1 %}\n\n{% asset_img 2016-04-21_07-12-40.png 2 %}\n\n** / Backend Engineer**\n\n\n\n- \n- micro-service\n- \n- Code Review\n\n\n\n- \n- GoNode.jsC++Python\n- RESTfulRPC\n- web serviceweb app\n- MysqlRedisMongoDB\n- \n- \n- \n- 53\n\n\n** / Senior Ops Engineer**\n\n\n\n- AWS\n- \n- \n- \n- 7*24\n- IT\n\n\n\n- Linux/UnixLinux\n- TCP/IPHTTP\n- NginxDNSNTP\n- ShellPythonPerl Ruby\n- Linuxgrepawksedtmuxvim\n- MySQL\n- \n-  2 AWS\n- DevOps\n- \n- \n- \n- \n","slug":"experiences-about-develop-dlog","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24y000wv7e8d4vpuz21","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><!-- TOC depthFrom:1 depthTo:2 withLinks:0 updateOnSave:1 orderedList:0 -->\n<ul>\n<li></li>\n<li><code>dlog</code></li>\n<li><code>dlog</code></li>\n<li><ul>\n<li><code>panic</code><code>return error</code></li>\n<li><code>logger</code><code>data log</code></li>\n<li><code>data log</code></li>\n<li><code>Logger.Log</code></li>\n<li><code>logger</code><code>msg</code><code>buf</code>AWS Kinesis</li>\n<li></li>\n<li><code>Setup</code><code>TearDown</code></li>\n<li><code>kinesisMock</code></li>\n<li>AWS Kinesis</li>\n<li><code>log.Print</code></li>\n</ul>\n</li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<!-- /TOC -->\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://segmentfault.com/a/1190000002416822\" target=\"_blank\" rel=\"noopener\"></a>Golog<a href=\"https://github.com/topicai/dlog\" target=\"_blank\" rel=\"noopener\">dlog</a>Go</p>\n<blockquote>\n<p>Go</p>\n</blockquote>\n<h1 id=\"dlog\"><a href=\"#dlog\" class=\"headerlink\" title=\"dlog\"></a><code>dlog</code></h1><p><strong>readme</strong><code>dlog</code></p>\n<blockquote>\n<p>dlog is a Go package for distributed structure logging using Amazon AWS Kinesis/Firehose.</p>\n</blockquote>\n<p><a href=\"https://github.com/topicai/dlog/blob/develop/README.md\" target=\"_blank\" rel=\"noopener\">readme</a></p>\n<p><code>dlog</code><code>data log</code>Golang package<code>data log</code></p>\n<ul>\n<li><code>status log</code>Bug</li>\n<li><code>data log</code><code>data log</code></li>\n</ul>\n<h1 id=\"dlog\"><a href=\"#dlog\" class=\"headerlink\" title=\"dlog\"></a><code>dlog</code></h1><ul>\n<li><code>data log</code><code>logger</code><code>logger</code><code>data log</code></li>\n<li><code>dlog</code><ul>\n<li>AWS Kinesis</li>\n</ul>\n</li>\n<li><code>dlog</code><code>data log</code><code>dlog</code><code>dlog</code></li>\n<li>AWS KinesisAPI<a href=\"http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecord.html\" target=\"_blank\" rel=\"noopener\">PutRecord</a>, <a href=\"http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecords.html\" target=\"_blank\" rel=\"noopener\">PutRecords</a>Kinesis<code>data log</code><ul>\n<li><code>PutRecords</code><code>record</code><code>500</code><code>record</code>1MB<code>request</code>5MB</li>\n<li>Kinesis StreamTPSstreamshardshardTPS<code>1000 records per second</code> <code>1MB per second</code></li>\n</ul>\n</li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"panicreturn-error\"><a href=\"#panicreturn-error\" class=\"headerlink\" title=\"panicreturn error\"></a><code>panic</code><code>return error</code></h2><p><code>panic</code><code>return error</code></p>\n<h3 id=\"panic\"><a href=\"#panic\" class=\"headerlink\" title=\"panic\"></a><code>panic</code></h3><p><code>panic</code><code>goroutine</code><code>panic</code><code>recover</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        log.Panic(<span class=\"string\">\"some error before work2\"</span>)</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"do some work2\"</span>)</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\"></span><br><span class=\"line\">    time.Sleep(time.Second)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"do some work1\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/off1y9tBax\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>recover</code><code>goroutine</code><code>panic</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> err := <span class=\"built_in\">recover</span>(); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">                log.Printf(<span class=\"string\">\"error: %v\"</span>, err)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;()</span><br><span class=\"line\">        log.Panic(<span class=\"string\">\"some error before work2\"</span>)</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"do some work2\"</span>)</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\"></span><br><span class=\"line\">    time.Sleep(time.Second)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"do some work1\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/RLWyb813Uw\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p>Go<code>panic</code><code>recover</code>Java.NET<code>throw</code><code>try...catch</code></p>\n<h3 id=\"return-error\"><a href=\"#return-error\" class=\"headerlink\" title=\"return error\"></a><code>return error</code></h3><p><code>return error</code>Go<code>caller</code></p>\n<p><code>return error</code><code>return error</code><code>panic/recover</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"errors\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> R <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f1</span><span class=\"params\">()</span> <span class=\"params\">(error, *R)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> errors.New(<span class=\"string\">\"an error\"</span>), <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f2</span><span class=\"params\">()</span> <span class=\"params\">(error, *R)</span></span> &#123;</span><br><span class=\"line\">    err, r := f1()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err, <span class=\"literal\">nil</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, r</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f3</span><span class=\"params\">()</span> <span class=\"params\">(error, *R)</span></span> &#123;</span><br><span class=\"line\">    err, r := f2()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err, <span class=\"literal\">nil</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, r</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    err, _ := f3()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Print(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/GhE5JpzZvn\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<h3 id=\"dlog\"><a href=\"#dlog\" class=\"headerlink\" title=\"dlog\"></a><code>dlog</code></h3><p><code>panic</code><code>return error</code><code>panic</code><code>return error</code></p>\n<p><code>dlog</code><code>package</code></p>\n<ul>\n<li><code>func NewLogger(example interface{}, opts *Options) (*Logger, error)</code></li>\n<li><code>func (l *Logger) Log(msg interface{}) error</code></li>\n</ul>\n<p></p>\n<ul>\n<li><code>NewLogger</code>data log<code>NewLogger</code><code>logger</code><code>panic</code><code>return error</code><code>caller</code>Golang package</li>\n<li><code>logger.Log</code><code>Log</code><code>panic</code><ul>\n<li><code>logger.Log</code><code>return error</code><code>msg</code></li>\n<li><code>logger.Log</code>AWS KinesisAWS Kinesis<code>panic</code><code>return error</code><code>logger</code><code>handler</code><code>handler</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"loggerdata-log\"><a href=\"#loggerdata-log\" class=\"headerlink\" title=\"loggerdata log\"></a><code>logger</code><code>data log</code></h2><p><code>logger</code><code>data log</code></p>\n<ul>\n<li><code>Logger</code><code>msgType reflect.Type</code></li>\n<li><code>NewLogger</code><code>logger</code><code>logger</code></li>\n<li><code>Log</code><code>msg</code><code>logger</code></li>\n</ul>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// msgTypeLogger</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Logger <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    msgType    reflect.Type</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// msgreflect.Type</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">msgType</span><span class=\"params\">(msg <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(reflect.Type, error)</span></span> &#123;</span><br><span class=\"line\">    t := reflect.TypeOf(msg)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> t.Kind() == reflect.Ptr &#123;</span><br><span class=\"line\">        t = t.Elem()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> t.Kind() != reflect.Struct &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, fmt.Errorf(<span class=\"string\">\"dlog message must be either *struct or struct\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> t, <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewLogger</span><span class=\"params\">(example <span class=\"keyword\">interface</span>&#123;&#125;, opts *Options)</span> <span class=\"params\">(*Logger, error)</span></span> &#123;</span><br><span class=\"line\">    t, e := msgType(example)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> e != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, e</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    l := &amp;Logger&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">        msgType:    t,</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"keyword\">return</span> l, <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">Log</span><span class=\"params\">(msg <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> t, e := msgType(msg); e != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> e</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> !t.AssignableTo(l.msgType) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fmt.Errorf(<span class=\"string\">\"parameter (%+v) not assignable to %v\"</span>, msg, l.msgType)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Log</code><code>AssignableTo</code><code>msg</code><code>struct</code><code>AssignableTo</code><code>True</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">type</span> Fn <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(<span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"title\">id</span> := <span class=\"title\">func</span><span class=\"params\">(x <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> zeroFn Fn</span><br><span class=\"line\">    log.Println(reflect.TypeOf(id).AssignableTo(reflect.TypeOf(zeroFn)))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">type</span> MyInt <span class=\"keyword\">int</span></span><br><span class=\"line\">    mi := <span class=\"number\">1</span></span><br><span class=\"line\">    log.Println(reflect.TypeOf(<span class=\"number\">2</span>).AssignableTo(reflect.TypeOf(mi)))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">type</span> S1 <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        name <span class=\"keyword\">string</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">type</span> S2 S1</span><br><span class=\"line\"></span><br><span class=\"line\">    s1 := S1&#123;</span><br><span class=\"line\">        name: <span class=\"string\">\"ethan\"</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    s2 := S2&#123;</span><br><span class=\"line\">        name: <span class=\"string\">\"ethan\"</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// s2 = s1\t// if uncomment this line, will report \"cannot use s1 (type S1) as type S2 in assignment\" when compile</span></span><br><span class=\"line\">    log.Println(reflect.TypeOf(s1).AssignableTo(reflect.TypeOf(s2)))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/eDmzxW-ayk\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<h2 id=\"data-log\"><a href=\"#data-log\" class=\"headerlink\" title=\"data log\"></a><code>data log</code></h2><p><code>buffer</code><code>message</code><code>buffer</code>AWS Kinesis<code>buffer</code>(goroutine)<code>buffer</code></p>\n<ul>\n<li><code>buffer</code></li>\n<li><code>channel</code><code>buffer</code></li>\n</ul>\n<p>Java.NETCSP(Communicating Sequential Processes)</p>\n<img src=\"/2016/04/20/experiences-about-develop-dlog/channel.png\" title=\"CSP Model\">\n<p><code>dlog</code><code>Log</code><code>msg</code><code>buffer</code><code>channel</code><code>goroutine</code><code>channel</code><code>buf := make([][]byte, 0)</code><code>buf</code>AWS Kinesis<code>flush</code>AWS Kinesis<code>goroutine</code><code>buf</code><code>buf</code></p>\n<!--\ndigraph G {\n    fontname=\"Microsoft YaHei\";\n    fontsize=10;\n    rankdir = LR;\n\n    \"buffer channel\" [shape=box];\n\n    \"Logger.Log goroutine 1\" -> \"buffer channel\";\n    \"Logger.Log goroutine 2\" -> \"buffer channel\";\n    \"Logger.Log goroutine 3\" -> \"buffer channel\";\n    \"buffer channel\" -> \"sync goroutine\";\n    \"sync goroutine\" -> \"AWS Kinesis Stream\";\n}\n-->\n<!-- ![Thread Model](http://g.gravizo.com/g?digraph%20G%20%7B%0A%20%20%20%20fontname%3D%22Microsoft%20YaHei%22%3B%0A%20%20%20%20fontsize%3D10%3B%0A%20%20%20%20rankdir%20%3D%20LR%3B%0A%0A%20%20%20%20%22buffer%20channel%22%20%5Bshape%3Dbox%5D%3B%0A%0A%20%20%20%20%22Logger.Log%20goroutine%201%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22Logger.Log%20goroutine%202%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22Logger.Log%20goroutine%203%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22buffer%20channel%22%20-%3E%20%22sync%20goroutine%22%3B%0A%20%20%20%20%22sync%20goroutine%22%20-%3E%20%22AWS%20Kinesis%20Stream%22%3B%0A%20%7D) -->\n<img src=\"/2016/04/20/experiences-about-develop-dlog/use_channel.png\" title=\"Channel\">\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewLogger</span><span class=\"params\">(example <span class=\"keyword\">interface</span>&#123;&#125;, opts *Options)</span> <span class=\"params\">(*Logger, error)</span></span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">go</span> l.sync()    <span class=\"comment\">// sync goroutine</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> l, <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">Log</span><span class=\"params\">(msg <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    en := encode(msg)       <span class=\"comment\">// msg</span></span><br><span class=\"line\">    ...</span><br><span class=\"line\">        <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> l.buffer &lt;- en:    <span class=\"comment\">// buffer channelmsg</span></span><br><span class=\"line\">        ...</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">sync</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([][]<span class=\"keyword\">byte</span>, <span class=\"number\">0</span>) <span class=\"comment\">// buffer channel</span></span><br><span class=\"line\">    bufSize := <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> msg := &lt;-l.buffer:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> bufSize+<span class=\"built_in\">len</span>(msg)+partitionKeySize &gt;= maxBatchSize &#123;  <span class=\"comment\">// buf</span></span><br><span class=\"line\">                l.flush(&amp;buf, &amp;bufSize)                             <span class=\"comment\">// AWS Kinesis</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            buf = <span class=\"built_in\">append</span>(buf, msg)                                  <span class=\"comment\">// buffer channelbuf</span></span><br><span class=\"line\">            bufSize += <span class=\"built_in\">len</span>(msg) + partitionKeySize</span><br><span class=\"line\"></span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Logger-Log\"><a href=\"#Logger-Log\" class=\"headerlink\" title=\"Logger.Log\"></a><code>Logger.Log</code></h2><p>IO<code>caller</code></p>\n<p><code>Logger.Log</code>Go<code>channel</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">Log</span><span class=\"params\">(msg <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> timeout &lt;-<span class=\"keyword\">chan</span> time.Time</span><br><span class=\"line\">    <span class=\"keyword\">if</span> l.WriteTimeout &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        timeout = time.After(l.WriteTimeout)    <span class=\"comment\">// l.WriteTimeout</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    ...</span><br><span class=\"line\">        <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> l.buffer &lt;- en:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> &lt;-timeout: <span class=\"comment\">// timeoutcase</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> fmt.Errorf(<span class=\"string\">\"dlog writes %+v timeout after %v\"</span>, msg, l.WriteTimeout)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Java.NETGo</p>\n<ul>\n<li>C#<ul>\n<li><a href=\"http://weblogs.asp.net/israelio/159985\" target=\"_blank\" rel=\"noopener\">Implementing .Net method timeout</a></li>\n<li><a href=\"http://stackoverflow.com/questions/18646650/how-to-implement-task-async-for-a-timer-in-c\" target=\"_blank\" rel=\"noopener\">How to implement Task Async for a timer in C#?</a></li>\n<li><a href=\"http://stackoverflow.com/questions/10143980/implementing-a-timeout-in-c-sharp\" target=\"_blank\" rel=\"noopener\">Implementing a timeout in c#</a></li>\n</ul>\n</li>\n<li>Java<ul>\n<li><a href=\"http://www.coderanch.com/t/232213/threads/java/implement-timeout-threads\" target=\"_blank\" rel=\"noopener\">How to implement timeout using threads</a></li>\n<li><a href=\"http://stackoverflow.com/questions/2275443/how-to-timeout-a-thread\" target=\"_blank\" rel=\"noopener\">How to timeout a thread</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"loggermsgbufAWS-Kinesis\"><a href=\"#loggermsgbufAWS-Kinesis\" class=\"headerlink\" title=\"loggermsgbufAWS Kinesis\"></a><code>logger</code><code>msg</code><code>buf</code>AWS Kinesis</h2><p><code>dlog</code><code>Logger.sync()</code><code>buf</code>AWS Kinesis</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">sync</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> l.SyncPeriod &lt;= <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        l.SyncPeriod = time.Second</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ticker := time.NewTicker(l.SyncPeriod)  <span class=\"comment\">// l.SyncPeriodticker</span></span><br><span class=\"line\"></span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([][]<span class=\"keyword\">byte</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">    bufSize := <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;  <span class=\"comment\">// sync goroutine</span></span><br><span class=\"line\">        <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> msg := &lt;-l.buffer:</span><br><span class=\"line\">            ...</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">case</span> &lt;-ticker.C: <span class=\"comment\">// ticker.C&lt;-chan Timel.SyncPeriodcase</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> bufSize &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                l.flush(&amp;buf, &amp;bufSize)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>ticker</code><code>dlog</code><code>msg</code><code>buf</code><code>l.SyncPeriod</code>AWS Kinesis</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>GoPackage <code>expvar</code><code>expvar</code>HTTP<code>/debug/vars</code>JSON<code>expvar</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"expvar\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Stats is used to collect runtime metrics</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Stats <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    sync.Mutex</span><br><span class=\"line\">    TotalHit  <span class=\"keyword\">int</span></span><br><span class=\"line\">    ErrorNums <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stats)</span> <span class=\"title\">IncreaseTotalHit</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    s.Lock()</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> s.Unlock()</span><br><span class=\"line\"></span><br><span class=\"line\">    s.TotalHit += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stats)</span> <span class=\"title\">IncreaseErrorNums</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    s.Lock()</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> s.Unlock()</span><br><span class=\"line\"></span><br><span class=\"line\">    s.ErrorNums += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stats)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    s.Lock()</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> s.Unlock()</span><br><span class=\"line\"></span><br><span class=\"line\">    b, err := json.Marshal(*s)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"&#123;&#125;\"</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">string</span>(b)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> (</span><br><span class=\"line\">    stats *Stats</span><br><span class=\"line\">    hits  *expvar.Map</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">init</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    expvar.Publish(<span class=\"string\">\"now\"</span>, expvar.Func(<span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span> <span class=\"title\">interface</span></span>&#123;&#125; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> time.Now().Format(<span class=\"string\">\"\\\"2006-01-02 15:04:05\\\"\"</span>)</span><br><span class=\"line\">    &#125;))</span><br><span class=\"line\"></span><br><span class=\"line\">    stats = &amp;Stats&#123;&#125;</span><br><span class=\"line\">    expvar.Publish(<span class=\"string\">\"stats\"</span>, stats)</span><br><span class=\"line\"></span><br><span class=\"line\">    hits = expvar.NewMap(<span class=\"string\">\"hits\"</span>).Init()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">homeHandler</span><span class=\"params\">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class=\"line\">    p := r.URL.Path[<span class=\"number\">1</span>:]</span><br><span class=\"line\">    hits.Add(p, <span class=\"number\">1</span>)</span><br><span class=\"line\">    stats.IncreaseTotalHit(<span class=\"number\">1</span>)</span><br><span class=\"line\">    fmt.Fprintf(w, <span class=\"string\">\"Hey! I love %s! hits: %v\\n\"</span>, p, hits.Get(p))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">errHandler</span><span class=\"params\">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class=\"line\">    stats.IncreaseErrorNums(<span class=\"number\">1</span>)</span><br><span class=\"line\">    fmt.Fprintf(w, <span class=\"string\">\"Error Nums: %v\\n\"</span>, stats.ErrorNums)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    http.HandleFunc(<span class=\"string\">\"/err\"</span>, errHandler)</span><br><span class=\"line\">    http.HandleFunc(<span class=\"string\">\"/\"</span>, homeHandler)</span><br><span class=\"line\">    http.ListenAndServe(<span class=\"string\">\":8080\"</span>, <span class=\"literal\">nil</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><code>go run expvarexample.go</code></li>\n<li><code>http://localhost:8080/ethan</code></li>\n<li><code>http://localhost:8080/err</code></li>\n<li><code>http://localhost:8080/debug/vars</code><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"cmdline\"</span>: [<span class=\"string\">\"/var/folders/jf/65ft181j33j_d75ktgv67bsc0000gn/T/go-build467453980/command-line-arguments/_obj/exe/expvarsample\"</span>],</span><br><span class=\"line\">    <span class=\"attr\">\"hits\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"ethan\"</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"favicon.ico\"</span>: <span class=\"number\">2</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    \"memstats\": &#123; ... &#125;,</span><br><span class=\"line\">    \"now\": \"\\\"2016-04-19 20:17:40\\\"\",</span><br><span class=\"line\">    \"stats\": &#123;</span><br><span class=\"line\">        \"TotalHit\":3,</span><br><span class=\"line\">        \"ErrorNums\":1</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a href=\"https://github.com/divan/expvarmon\" target=\"_blank\" rel=\"noopener\">expvarmon</a><code>expvar</code></p>\n<ul>\n<li><code>go get github.com/divan/expvarmon</code></li>\n<li><code>expvarmon -ports=&quot;8080&quot; -vars=&quot;hits.ethan,stats.TotalHit,stats.ErrorNums,now&quot;</code></li>\n<li><img src=\"/2016/04/20/experiences-about-develop-dlog/expvarmon_screen.png\" title=\"expvarmon screen\">\n</li>\n</ul>\n<p><code>dlog</code><code>expvar</code><code>dlog</code></p>\n<ul>\n<li><code>writtenRecords</code>: AWS Kinesis<code>msg</code></li>\n<li><code>writtenBatches</code>: AWS KinesisAPI</li>\n<li><code>failedRecords</code>: AWS Kinesis<code>msg</code></li>\n<li><code>tooBigMesssages</code>: (partitionKeySize1MB)<code>msg</code></li>\n</ul>\n<p></p>\n<h2 id=\"SetupTearDown\"><a href=\"#SetupTearDown\" class=\"headerlink\" title=\"SetupTearDown\"></a><code>Setup</code><code>TearDown</code></h2><p>Go<strong></strong><code>go test</code><code>testing</code> package<a href=\"http://docs.studygolang.com/doc/code.html#Testing\" target=\"_blank\" rel=\"noopener\"></a>Go</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//$GOPATH/src/github.com/user/stringutil/reverse_test.go</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> stringutil</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"testing\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TestReverse</span><span class=\"params\">(t *testing.T)</span></span> &#123;</span><br><span class=\"line\">    cases := []<span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        in, want <span class=\"keyword\">string</span></span><br><span class=\"line\">    &#125;&#123;</span><br><span class=\"line\">        &#123;<span class=\"string\">\"Hello, world\"</span>, <span class=\"string\">\"dlrow ,olleH\"</span>&#125;,</span><br><span class=\"line\">        &#123;<span class=\"string\">\"Hello, \"</span>, <span class=\"string\">\" ,olleH\"</span>&#125;,</span><br><span class=\"line\">        &#123;<span class=\"string\">\"\"</span>, <span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> _, c := <span class=\"keyword\">range</span> cases &#123;</span><br><span class=\"line\">        got := Reverse(c.in)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> got != c.want &#123;</span><br><span class=\"line\">            t.Errorf(<span class=\"string\">\"Reverse(%q) == %q, want %q\"</span>, c.in, got, c.want)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"keyword\">go</span> test github.com/user/stringutil</span><br><span class=\"line\">ok  \tgithub.com/user/stringutil <span class=\"number\">0.165s</span></span><br></pre></td></tr></table></figure>\n<p>IaaS<a href=\"https://github.com/stretchr/testify/suite\" target=\"_blank\" rel=\"noopener\">testify/suite</a> package<a href=\"https://github.com/stretchr/testify/suite\" target=\"_blank\" rel=\"noopener\">testify/suite</a><code>struct</code><code>setup</code>()/<code>teardown</code>()<code>go test</code></p>\n<p><a href=\"https://github.com/stretchr/testify/suite\" target=\"_blank\" rel=\"noopener\">testify/suite</a></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> suite</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"testing\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">\"github.com/stretchr/testify/assert\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> SuiteTester <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Include our basic suite logic.</span></span><br><span class=\"line\">    Suite</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Other properties</span></span><br><span class=\"line\">    propertyN <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The SetupSuite method will be run by testify once, at the very</span></span><br><span class=\"line\"><span class=\"comment\">// start of the testing suite, before any tests are run.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">SetupSuite</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The TearDownSuite method will be run by testify once, at the very</span></span><br><span class=\"line\"><span class=\"comment\">// end of the testing suite, after all tests have been run.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">TearDownSuite</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The SetupTest method will be run before every test in the suite.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">SetupTest</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The TearDownTest method will be run after every test in the suite.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">TearDownTest</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// a test method</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">TestOne</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// another test method</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">TestTwo</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// TestRunSuite will be run by the 'go test' command, so within it, we</span></span><br><span class=\"line\"><span class=\"comment\">// can run our suite using the Run(*testing.T, TestingSuite) function.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TestRunSuite</span><span class=\"params\">(t *testing.T)</span></span> &#123;</span><br><span class=\"line\">    suiteTester := <span class=\"built_in\">new</span>(SuiteTester)</span><br><span class=\"line\">    Run(t, suiteTester)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>dlog</code><code>Logger.Log</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> dlog</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> WriteLogSuiteTester <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    suite.Suite</span><br><span class=\"line\"></span><br><span class=\"line\">    options     *Options</span><br><span class=\"line\">    seachLogger *Logger</span><br><span class=\"line\">    clickLogger *Logger</span><br><span class=\"line\">    streamNames []<span class=\"keyword\">string</span> <span class=\"comment\">// save the created AWS Kinesis Streams, which will be removed in TearDownSuite()</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The SetupSuite method will be run by testify once, at the very</span></span><br><span class=\"line\"><span class=\"comment\">// start of the testing suite, before any tests are run.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *WriteLogSuiteTester)</span> <span class=\"title\">SetupSuite</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// create stream 1</span></span><br><span class=\"line\">    err = s.seachLogger.kinesis.CreateStream(s.seachLogger.streamName, testingShardCount)</span><br><span class=\"line\">    s.Nil(err)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// create stream 2</span></span><br><span class=\"line\">    err = s.clickLogger.kinesis.CreateStream(s.clickLogger.streamName, testingShardCount)</span><br><span class=\"line\">    s.Nil(err)</span><br><span class=\"line\"></span><br><span class=\"line\">    s.streamNames = []<span class=\"keyword\">string</span>&#123;s.seachLogger.streamName, s.clickLogger.streamName&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123; <span class=\"comment\">// waiting created stream's status to be active</span></span><br><span class=\"line\">        time.Sleep(<span class=\"number\">1</span> * time.Second)</span><br><span class=\"line\">        resp1, err1 := s.seachLogger.kinesis.DescribeStream(s.seachLogger.streamName)</span><br><span class=\"line\">        s.Nil(err1)</span><br><span class=\"line\"></span><br><span class=\"line\">        resp2, err2 := s.seachLogger.kinesis.DescribeStream(s.clickLogger.streamName)</span><br><span class=\"line\">        s.Nil(err2)</span><br><span class=\"line\"></span><br><span class=\"line\">        status1 := strings.ToLower(<span class=\"keyword\">string</span>(resp1.StreamStatus))</span><br><span class=\"line\">        status2 := strings.ToLower(<span class=\"keyword\">string</span>(resp2.StreamStatus))</span><br><span class=\"line\">        <span class=\"keyword\">if</span> status1 == <span class=\"string\">\"active\"</span> &amp;&amp; status2 == <span class=\"string\">\"active\"</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The TearDownSuite method will be run by testify once, at the very</span></span><br><span class=\"line\"><span class=\"comment\">// end of the testing suite, after all tests have been run.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *WriteLogSuiteTester)</span> <span class=\"title\">TearDownSuite</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> s.streamNames == <span class=\"literal\">nil</span> || <span class=\"built_in\">len</span>(s.streamNames) == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> _, streamName := <span class=\"keyword\">range</span> s.streamNames &#123;</span><br><span class=\"line\">        err := s.seachLogger.kinesis.DeleteStream(streamName)</span><br><span class=\"line\">        s.Nil(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *WriteLogSuiteTester)</span> <span class=\"title\">TestWriteLog</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123; <span class=\"comment\">// Recover if panicking to make sure TearDownSuite will be executed</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> r := <span class=\"built_in\">recover</span>(); r != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            s.Fail(fmt.Sprint(r))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TestRunWriteLogSuite</span><span class=\"params\">(t *testing.T)</span></span> &#123;</span><br><span class=\"line\">    suiteTester := <span class=\"built_in\">new</span>(WriteLogSuiteTester)</span><br><span class=\"line\">    suite.Run(t, suiteTester)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li></li>\n<li><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"kinesisMock\"><a href=\"#kinesisMock\" class=\"headerlink\" title=\"kinesisMock\"></a><code>kinesisMock</code></h2><p>Mock</p>\n<p><code>dlog</code><code>KinesisInterface</code>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> KinesisInterface <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    PutRecords(streamName <span class=\"keyword\">string</span>, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error)</span><br><span class=\"line\">    CreateStream(name <span class=\"keyword\">string</span>, shardCount <span class=\"keyword\">int</span>) error</span><br><span class=\"line\">    DescribeStream(name <span class=\"keyword\">string</span>) (resp *kinesis.StreamDescription, err error)</span><br><span class=\"line\">    DeleteStream(name <span class=\"keyword\">string</span>) error</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>KinesisInterface</code><code>dlog</code><a href=\"https://github.com/AdRoll/goamz/blob/master/kinesis/kinesis.go\" target=\"_blank\" rel=\"noopener\">github.com/AdRoll/goamz/kinesis/kinesis</a>Go<code>interface</code><strong></strong><a href=\"https://github.com/AdRoll/goamz/blob/master/kinesis/kinesis.go\" target=\"_blank\" rel=\"noopener\">github.com/AdRoll/goamz/kinesis/kinesis</a><code>KinesisInterface</code><code>kinesisMock</code><code>KinesisInterface</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> kinesisMock <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Mapping from steam name to batches of batches</span></span><br><span class=\"line\">    storage <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>][][]kinesis.PutRecordsRequestEntry</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// simulate lantency that sync to Kinesis</span></span><br><span class=\"line\">    putRecordLatency time.Duration</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// created streams' names</span></span><br><span class=\"line\">    streamNames []<span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// lock to solve concurrent call</span></span><br><span class=\"line\">    lock sync.RWMutex</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newKinesisMock</span><span class=\"params\">(putRecordsLatency time.Duration)</span> *<span class=\"title\">kinesisMock</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &amp;kinesisMock&#123;</span><br><span class=\"line\">        storage:          <span class=\"built_in\">make</span>(<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>][][]kinesis.PutRecordsRequestEntry),</span><br><span class=\"line\">        putRecordLatency: putRecordsLatency,</span><br><span class=\"line\">        streamNames:      <span class=\"built_in\">make</span>([]<span class=\"keyword\">string</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">PutRecords</span><span class=\"params\">(streamName <span class=\"keyword\">string</span>, records []kinesis.PutRecordsRequestEntry)</span> <span class=\"params\">(resp *kinesis.PutRecordsResponse, err error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">CreateStream</span><span class=\"params\">(name <span class=\"keyword\">string</span>, shardCount <span class=\"keyword\">int</span>)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">DescribeStream</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(resp *kinesis.StreamDescription, err error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">DeleteStream</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>kinesis</code><code>KinesisInterface</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Logger <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">    kinesis    KinesisInterface</span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Logger</code><code>kinesisMock</code><code>kinesis</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TestLoggingToMockKinesis</span><span class=\"params\">(t *testing.T)</span></span> &#123;</span><br><span class=\"line\">    assert := assert.New(t)</span><br><span class=\"line\"></span><br><span class=\"line\">    l, e := NewLogger(&amp;impression&#123;&#125;, &amp;Options&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">        UseMockKinesis: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        MockKinesis:    newKinesisMock(<span class=\"number\">0</span>),</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"AWS-Kinesis\"><a href=\"#AWS-Kinesis\" class=\"headerlink\" title=\"AWS Kinesis\"></a>AWS Kinesis</h2><p><code>kinesisMock</code><code>kinesis</code></p>\n<p><code>kinesisMock</code><code>putRecordLatency</code><code>PutRecords</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> kinesisMock <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// simulate lantency that sync to Kinesis</span></span><br><span class=\"line\">    putRecordLatency time.Duration</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">PutRecords</span><span class=\"params\">(streamName <span class=\"keyword\">string</span>, records []kinesis.PutRecordsRequestEntry)</span> <span class=\"params\">(resp *kinesis.PutRecordsResponse, err error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    time.Sleep(mock.putRecordLatency) <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>kinesis</code><code>brokenKinesisMock</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> brokenKinesisMock <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    *kinesisMock</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newBrokenKinesisMock</span><span class=\"params\">()</span> *<span class=\"title\">brokenKinesisMock</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &amp;brokenKinesisMock&#123;</span><br><span class=\"line\">        kinesisMock: newKinesisMock(<span class=\"number\">0</span>),</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *brokenKinesisMock)</span> <span class=\"title\">PutRecords</span><span class=\"params\">(streamName <span class=\"keyword\">string</span>, records []kinesis.PutRecordsRequestEntry)</span> <span class=\"params\">(resp *kinesis.PutRecordsResponse, err error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, fmt.Errorf(<span class=\"string\">\"Kinesis is broken\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>kinesisMock</code><code>brokenKinesisMock</code><code>struct</code><code>brokenKinesisMock</code><code>kinesisMock</code><code>KinesisInterface</code></p>\n<h2 id=\"log-Print\"><a href=\"#log-Print\" class=\"headerlink\" title=\"log.Print\"></a><code>log.Print</code></h2><p></p>\n<ul>\n<li><code>log.Print</code><code>stdout</code></li>\n<li><code>go test</code><code>-v</code><code>log.Print</code><code>log.Print</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://docs.aws.amazon.com/kinesis/latest/APIReference/API_CreateStream.html\" target=\"_blank\" rel=\"noopener\">AWS Kinesis API - CreateStream</a>Stream10+Stream</li>\n<li><a href=\"https://github.com/AdRoll/goamz/blob/master/aws/regions.go\" target=\"_blank\" rel=\"noopener\">github.com/AdRoll/goamz/aws/regions.go</a>AWS KinesisURLAWS Kinesis</li>\n<li>Travis CIKill1CI10</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li>Kinesis<code>dlog</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://docs.studygolang.com/doc/effective_go.html\" target=\"_blank\" rel=\"noopener\">Effective Go</a></li>\n<li><a href=\"https://aws.amazon.com/cn/documentation/kinesis/\" target=\"_blank\" rel=\"noopener\">Amazon Kinesis Documentation</a></li>\n<li><a href=\"http://blog.golang.org/advanced-go-concurrency-patterns\" target=\"_blank\" rel=\"noopener\">Advanced Go Concurrency Patterns</a></li>\n<li><a href=\"https://github.com/afex/hystrix-go\" target=\"_blank\" rel=\"noopener\">hystrix-go</a></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"http://www.augmn.com\" target=\"_blank\" rel=\"noopener\"></a>(ethancai@qq.com)</p>\n<img src=\"/2016/04/20/experiences-about-develop-dlog/2016-04-21_07-12-24.png\" title=\"1\">\n<img src=\"/2016/04/20/experiences-about-develop-dlog/2016-04-21_07-12-40.png\" title=\"2\">\n<p><strong> / Backend Engineer</strong></p>\n<p></p>\n<ul>\n<li></li>\n<li>micro-service</li>\n<li></li>\n<li>Code Review</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li>GoNode.jsC++Python</li>\n<li>RESTfulRPC</li>\n<li>web serviceweb app</li>\n<li>MysqlRedisMongoDB</li>\n<li></li>\n<li></li>\n<li></li>\n<li>53</li>\n</ul>\n<p><strong> / Senior Ops Engineer</strong></p>\n<p></p>\n<ul>\n<li>AWS</li>\n<li></li>\n<li></li>\n<li></li>\n<li>7*24</li>\n<li>IT</li>\n</ul>\n<p></p>\n<ul>\n<li>Linux/UnixLinux</li>\n<li>TCP/IPHTTP</li>\n<li>NginxDNSNTP</li>\n<li>ShellPythonPerl Ruby</li>\n<li>Linuxgrepawksedtmuxvim</li>\n<li>MySQL</li>\n<li></li>\n<li> 2 AWS</li>\n<li>DevOps</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><!-- TOC depthFrom:1 depthTo:2 withLinks:0 updateOnSave:1 orderedList:0 -->\n<ul>\n<li></li>\n<li><code>dlog</code></li>\n<li><code>dlog</code></li>\n<li><ul>\n<li><code>panic</code><code>return error</code></li>\n<li><code>logger</code><code>data log</code></li>\n<li><code>data log</code></li>\n<li><code>Logger.Log</code></li>\n<li><code>logger</code><code>msg</code><code>buf</code>AWS Kinesis</li>\n<li></li>\n<li><code>Setup</code><code>TearDown</code></li>\n<li><code>kinesisMock</code></li>\n<li>AWS Kinesis</li>\n<li><code>log.Print</code></li>\n</ul>\n</li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<!-- /TOC -->\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://segmentfault.com/a/1190000002416822\" target=\"_blank\" rel=\"noopener\"></a>Golog<a href=\"https://github.com/topicai/dlog\" target=\"_blank\" rel=\"noopener\">dlog</a>Go</p>\n<blockquote>\n<p>Go</p>\n</blockquote>\n<h1 id=\"dlog\"><a href=\"#dlog\" class=\"headerlink\" title=\"dlog\"></a><code>dlog</code></h1><p><strong>readme</strong><code>dlog</code></p>\n<blockquote>\n<p>dlog is a Go package for distributed structure logging using Amazon AWS Kinesis/Firehose.</p>\n</blockquote>\n<p><a href=\"https://github.com/topicai/dlog/blob/develop/README.md\" target=\"_blank\" rel=\"noopener\">readme</a></p>\n<p><code>dlog</code><code>data log</code>Golang package<code>data log</code></p>\n<ul>\n<li><code>status log</code>Bug</li>\n<li><code>data log</code><code>data log</code></li>\n</ul>\n<h1 id=\"dlog\"><a href=\"#dlog\" class=\"headerlink\" title=\"dlog\"></a><code>dlog</code></h1><ul>\n<li><code>data log</code><code>logger</code><code>logger</code><code>data log</code></li>\n<li><code>dlog</code><ul>\n<li>AWS Kinesis</li>\n</ul>\n</li>\n<li><code>dlog</code><code>data log</code><code>dlog</code><code>dlog</code></li>\n<li>AWS KinesisAPI<a href=\"http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecord.html\" target=\"_blank\" rel=\"noopener\">PutRecord</a>, <a href=\"http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecords.html\" target=\"_blank\" rel=\"noopener\">PutRecords</a>Kinesis<code>data log</code><ul>\n<li><code>PutRecords</code><code>record</code><code>500</code><code>record</code>1MB<code>request</code>5MB</li>\n<li>Kinesis StreamTPSstreamshardshardTPS<code>1000 records per second</code> <code>1MB per second</code></li>\n</ul>\n</li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"panicreturn-error\"><a href=\"#panicreturn-error\" class=\"headerlink\" title=\"panicreturn error\"></a><code>panic</code><code>return error</code></h2><p><code>panic</code><code>return error</code></p>\n<h3 id=\"panic\"><a href=\"#panic\" class=\"headerlink\" title=\"panic\"></a><code>panic</code></h3><p><code>panic</code><code>goroutine</code><code>panic</code><code>recover</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        log.Panic(<span class=\"string\">\"some error before work2\"</span>)</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"do some work2\"</span>)</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\"></span><br><span class=\"line\">    time.Sleep(time.Second)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"do some work1\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/off1y9tBax\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p><code>recover</code><code>goroutine</code><code>panic</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">go</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> err := <span class=\"built_in\">recover</span>(); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">                log.Printf(<span class=\"string\">\"error: %v\"</span>, err)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;()</span><br><span class=\"line\">        log.Panic(<span class=\"string\">\"some error before work2\"</span>)</span><br><span class=\"line\">        fmt.Println(<span class=\"string\">\"do some work2\"</span>)</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\"></span><br><span class=\"line\">    time.Sleep(time.Second)</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">\"do some work1\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/RLWyb813Uw\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<p>Go<code>panic</code><code>recover</code>Java.NET<code>throw</code><code>try...catch</code></p>\n<h3 id=\"return-error\"><a href=\"#return-error\" class=\"headerlink\" title=\"return error\"></a><code>return error</code></h3><p><code>return error</code>Go<code>caller</code></p>\n<p><code>return error</code><code>return error</code><code>panic/recover</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"errors\"</span></span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> R <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f1</span><span class=\"params\">()</span> <span class=\"params\">(error, *R)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> errors.New(<span class=\"string\">\"an error\"</span>), <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f2</span><span class=\"params\">()</span> <span class=\"params\">(error, *R)</span></span> &#123;</span><br><span class=\"line\">    err, r := f1()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err, <span class=\"literal\">nil</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, r</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">f3</span><span class=\"params\">()</span> <span class=\"params\">(error, *R)</span></span> &#123;</span><br><span class=\"line\">    err, r := f2()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> err, <span class=\"literal\">nil</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, r</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    err, _ := f3()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        log.Print(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/GhE5JpzZvn\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<h3 id=\"dlog\"><a href=\"#dlog\" class=\"headerlink\" title=\"dlog\"></a><code>dlog</code></h3><p><code>panic</code><code>return error</code><code>panic</code><code>return error</code></p>\n<p><code>dlog</code><code>package</code></p>\n<ul>\n<li><code>func NewLogger(example interface{}, opts *Options) (*Logger, error)</code></li>\n<li><code>func (l *Logger) Log(msg interface{}) error</code></li>\n</ul>\n<p></p>\n<ul>\n<li><code>NewLogger</code>data log<code>NewLogger</code><code>logger</code><code>panic</code><code>return error</code><code>caller</code>Golang package</li>\n<li><code>logger.Log</code><code>Log</code><code>panic</code><ul>\n<li><code>logger.Log</code><code>return error</code><code>msg</code></li>\n<li><code>logger.Log</code>AWS KinesisAWS Kinesis<code>panic</code><code>return error</code><code>logger</code><code>handler</code><code>handler</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"loggerdata-log\"><a href=\"#loggerdata-log\" class=\"headerlink\" title=\"loggerdata log\"></a><code>logger</code><code>data log</code></h2><p><code>logger</code><code>data log</code></p>\n<ul>\n<li><code>Logger</code><code>msgType reflect.Type</code></li>\n<li><code>NewLogger</code><code>logger</code><code>logger</code></li>\n<li><code>Log</code><code>msg</code><code>logger</code></li>\n</ul>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// msgTypeLogger</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Logger <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    msgType    reflect.Type</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// msgreflect.Type</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">msgType</span><span class=\"params\">(msg <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"params\">(reflect.Type, error)</span></span> &#123;</span><br><span class=\"line\">    t := reflect.TypeOf(msg)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> t.Kind() == reflect.Ptr &#123;</span><br><span class=\"line\">        t = t.Elem()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> t.Kind() != reflect.Struct &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, fmt.Errorf(<span class=\"string\">\"dlog message must be either *struct or struct\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> t, <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewLogger</span><span class=\"params\">(example <span class=\"keyword\">interface</span>&#123;&#125;, opts *Options)</span> <span class=\"params\">(*Logger, error)</span></span> &#123;</span><br><span class=\"line\">    t, e := msgType(example)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> e != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, e</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    l := &amp;Logger&#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">        msgType:    t,</span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"keyword\">return</span> l, <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">Log</span><span class=\"params\">(msg <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> t, e := msgType(msg); e != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> e</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> !t.AssignableTo(l.msgType) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fmt.Errorf(<span class=\"string\">\"parameter (%+v) not assignable to %v\"</span>, msg, l.msgType)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Log</code><code>AssignableTo</code><code>msg</code><code>struct</code><code>AssignableTo</code><code>True</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">    <span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">type</span> Fn <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(<span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span></span><br><span class=\"line\"><span class=\"function\">    <span class=\"title\">id</span> := <span class=\"title\">func</span><span class=\"params\">(x <span class=\"keyword\">int</span>)</span> <span class=\"title\">int</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> zeroFn Fn</span><br><span class=\"line\">    log.Println(reflect.TypeOf(id).AssignableTo(reflect.TypeOf(zeroFn)))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">type</span> MyInt <span class=\"keyword\">int</span></span><br><span class=\"line\">    mi := <span class=\"number\">1</span></span><br><span class=\"line\">    log.Println(reflect.TypeOf(<span class=\"number\">2</span>).AssignableTo(reflect.TypeOf(mi)))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">type</span> S1 <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        name <span class=\"keyword\">string</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">type</span> S2 S1</span><br><span class=\"line\"></span><br><span class=\"line\">    s1 := S1&#123;</span><br><span class=\"line\">        name: <span class=\"string\">\"ethan\"</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    s2 := S2&#123;</span><br><span class=\"line\">        name: <span class=\"string\">\"ethan\"</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// s2 = s1\t// if uncomment this line, will report \"cannot use s1 (type S1) as type S2 in assignment\" when compile</span></span><br><span class=\"line\">    log.Println(reflect.TypeOf(s1).AssignableTo(reflect.TypeOf(s2)))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em><a href=\"https://play.golang.org/p/eDmzxW-ayk\" target=\"_blank\" rel=\"noopener\"></a></em></p>\n<h2 id=\"data-log\"><a href=\"#data-log\" class=\"headerlink\" title=\"data log\"></a><code>data log</code></h2><p><code>buffer</code><code>message</code><code>buffer</code>AWS Kinesis<code>buffer</code>(goroutine)<code>buffer</code></p>\n<ul>\n<li><code>buffer</code></li>\n<li><code>channel</code><code>buffer</code></li>\n</ul>\n<p>Java.NETCSP(Communicating Sequential Processes)</p>\n<img src=\"/2016/04/20/experiences-about-develop-dlog/channel.png\" title=\"CSP Model\">\n<p><code>dlog</code><code>Log</code><code>msg</code><code>buffer</code><code>channel</code><code>goroutine</code><code>channel</code><code>buf := make([][]byte, 0)</code><code>buf</code>AWS Kinesis<code>flush</code>AWS Kinesis<code>goroutine</code><code>buf</code><code>buf</code></p>\n<!--\ndigraph G {\n    fontname=\"Microsoft YaHei\";\n    fontsize=10;\n    rankdir = LR;\n\n    \"buffer channel\" [shape=box];\n\n    \"Logger.Log goroutine 1\" -> \"buffer channel\";\n    \"Logger.Log goroutine 2\" -> \"buffer channel\";\n    \"Logger.Log goroutine 3\" -> \"buffer channel\";\n    \"buffer channel\" -> \"sync goroutine\";\n    \"sync goroutine\" -> \"AWS Kinesis Stream\";\n}\n-->\n<!-- ![Thread Model](http://g.gravizo.com/g?digraph%20G%20%7B%0A%20%20%20%20fontname%3D%22Microsoft%20YaHei%22%3B%0A%20%20%20%20fontsize%3D10%3B%0A%20%20%20%20rankdir%20%3D%20LR%3B%0A%0A%20%20%20%20%22buffer%20channel%22%20%5Bshape%3Dbox%5D%3B%0A%0A%20%20%20%20%22Logger.Log%20goroutine%201%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22Logger.Log%20goroutine%202%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22Logger.Log%20goroutine%203%22%20-%3E%20%22buffer%20channel%22%3B%0A%20%20%20%20%22buffer%20channel%22%20-%3E%20%22sync%20goroutine%22%3B%0A%20%20%20%20%22sync%20goroutine%22%20-%3E%20%22AWS%20Kinesis%20Stream%22%3B%0A%20%7D) -->\n<img src=\"/2016/04/20/experiences-about-develop-dlog/use_channel.png\" title=\"Channel\">\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">NewLogger</span><span class=\"params\">(example <span class=\"keyword\">interface</span>&#123;&#125;, opts *Options)</span> <span class=\"params\">(*Logger, error)</span></span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">go</span> l.sync()    <span class=\"comment\">// sync goroutine</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> l, <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">Log</span><span class=\"params\">(msg <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    en := encode(msg)       <span class=\"comment\">// msg</span></span><br><span class=\"line\">    ...</span><br><span class=\"line\">        <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> l.buffer &lt;- en:    <span class=\"comment\">// buffer channelmsg</span></span><br><span class=\"line\">        ...</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">sync</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([][]<span class=\"keyword\">byte</span>, <span class=\"number\">0</span>) <span class=\"comment\">// buffer channel</span></span><br><span class=\"line\">    bufSize := <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> msg := &lt;-l.buffer:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> bufSize+<span class=\"built_in\">len</span>(msg)+partitionKeySize &gt;= maxBatchSize &#123;  <span class=\"comment\">// buf</span></span><br><span class=\"line\">                l.flush(&amp;buf, &amp;bufSize)                             <span class=\"comment\">// AWS Kinesis</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            buf = <span class=\"built_in\">append</span>(buf, msg)                                  <span class=\"comment\">// buffer channelbuf</span></span><br><span class=\"line\">            bufSize += <span class=\"built_in\">len</span>(msg) + partitionKeySize</span><br><span class=\"line\"></span><br><span class=\"line\">        ...</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Logger-Log\"><a href=\"#Logger-Log\" class=\"headerlink\" title=\"Logger.Log\"></a><code>Logger.Log</code></h2><p>IO<code>caller</code></p>\n<p><code>Logger.Log</code>Go<code>channel</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">Log</span><span class=\"params\">(msg <span class=\"keyword\">interface</span>&#123;&#125;)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> timeout &lt;-<span class=\"keyword\">chan</span> time.Time</span><br><span class=\"line\">    <span class=\"keyword\">if</span> l.WriteTimeout &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        timeout = time.After(l.WriteTimeout)    <span class=\"comment\">// l.WriteTimeout</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    ...</span><br><span class=\"line\">        <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> l.buffer &lt;- en:</span><br><span class=\"line\">        <span class=\"keyword\">case</span> &lt;-timeout: <span class=\"comment\">// timeoutcase</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> fmt.Errorf(<span class=\"string\">\"dlog writes %+v timeout after %v\"</span>, msg, l.WriteTimeout)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Java.NETGo</p>\n<ul>\n<li>C#<ul>\n<li><a href=\"http://weblogs.asp.net/israelio/159985\" target=\"_blank\" rel=\"noopener\">Implementing .Net method timeout</a></li>\n<li><a href=\"http://stackoverflow.com/questions/18646650/how-to-implement-task-async-for-a-timer-in-c\" target=\"_blank\" rel=\"noopener\">How to implement Task Async for a timer in C#?</a></li>\n<li><a href=\"http://stackoverflow.com/questions/10143980/implementing-a-timeout-in-c-sharp\" target=\"_blank\" rel=\"noopener\">Implementing a timeout in c#</a></li>\n</ul>\n</li>\n<li>Java<ul>\n<li><a href=\"http://www.coderanch.com/t/232213/threads/java/implement-timeout-threads\" target=\"_blank\" rel=\"noopener\">How to implement timeout using threads</a></li>\n<li><a href=\"http://stackoverflow.com/questions/2275443/how-to-timeout-a-thread\" target=\"_blank\" rel=\"noopener\">How to timeout a thread</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"loggermsgbufAWS-Kinesis\"><a href=\"#loggermsgbufAWS-Kinesis\" class=\"headerlink\" title=\"loggermsgbufAWS Kinesis\"></a><code>logger</code><code>msg</code><code>buf</code>AWS Kinesis</h2><p><code>dlog</code><code>Logger.sync()</code><code>buf</code>AWS Kinesis</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(l *Logger)</span> <span class=\"title\">sync</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> l.SyncPeriod &lt;= <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        l.SyncPeriod = time.Second</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ticker := time.NewTicker(l.SyncPeriod)  <span class=\"comment\">// l.SyncPeriodticker</span></span><br><span class=\"line\"></span><br><span class=\"line\">    buf := <span class=\"built_in\">make</span>([][]<span class=\"keyword\">byte</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">    bufSize := <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123;  <span class=\"comment\">// sync goroutine</span></span><br><span class=\"line\">        <span class=\"keyword\">select</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> msg := &lt;-l.buffer:</span><br><span class=\"line\">            ...</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">case</span> &lt;-ticker.C: <span class=\"comment\">// ticker.C&lt;-chan Timel.SyncPeriodcase</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> bufSize &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                l.flush(&amp;buf, &amp;bufSize)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>ticker</code><code>dlog</code><code>msg</code><code>buf</code><code>l.SyncPeriod</code>AWS Kinesis</p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>GoPackage <code>expvar</code><code>expvar</code>HTTP<code>/debug/vars</code>JSON<code>expvar</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">    <span class=\"string\">\"expvar\"</span></span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    <span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">    <span class=\"string\">\"sync\"</span></span><br><span class=\"line\">    <span class=\"string\">\"time\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Stats is used to collect runtime metrics</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Stats <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    sync.Mutex</span><br><span class=\"line\">    TotalHit  <span class=\"keyword\">int</span></span><br><span class=\"line\">    ErrorNums <span class=\"keyword\">int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stats)</span> <span class=\"title\">IncreaseTotalHit</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    s.Lock()</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> s.Unlock()</span><br><span class=\"line\"></span><br><span class=\"line\">    s.TotalHit += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stats)</span> <span class=\"title\">IncreaseErrorNums</span><span class=\"params\">(i <span class=\"keyword\">int</span>)</span></span> &#123;</span><br><span class=\"line\">    s.Lock()</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> s.Unlock()</span><br><span class=\"line\"></span><br><span class=\"line\">    s.ErrorNums += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *Stats)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">    s.Lock()</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> s.Unlock()</span><br><span class=\"line\"></span><br><span class=\"line\">    b, err := json.Marshal(*s)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"&#123;&#125;\"</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">string</span>(b)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> (</span><br><span class=\"line\">    stats *Stats</span><br><span class=\"line\">    hits  *expvar.Map</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">init</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    expvar.Publish(<span class=\"string\">\"now\"</span>, expvar.Func(<span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span> <span class=\"title\">interface</span></span>&#123;&#125; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> time.Now().Format(<span class=\"string\">\"\\\"2006-01-02 15:04:05\\\"\"</span>)</span><br><span class=\"line\">    &#125;))</span><br><span class=\"line\"></span><br><span class=\"line\">    stats = &amp;Stats&#123;&#125;</span><br><span class=\"line\">    expvar.Publish(<span class=\"string\">\"stats\"</span>, stats)</span><br><span class=\"line\"></span><br><span class=\"line\">    hits = expvar.NewMap(<span class=\"string\">\"hits\"</span>).Init()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">homeHandler</span><span class=\"params\">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class=\"line\">    p := r.URL.Path[<span class=\"number\">1</span>:]</span><br><span class=\"line\">    hits.Add(p, <span class=\"number\">1</span>)</span><br><span class=\"line\">    stats.IncreaseTotalHit(<span class=\"number\">1</span>)</span><br><span class=\"line\">    fmt.Fprintf(w, <span class=\"string\">\"Hey! I love %s! hits: %v\\n\"</span>, p, hits.Get(p))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">errHandler</span><span class=\"params\">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class=\"line\">    stats.IncreaseErrorNums(<span class=\"number\">1</span>)</span><br><span class=\"line\">    fmt.Fprintf(w, <span class=\"string\">\"Error Nums: %v\\n\"</span>, stats.ErrorNums)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    http.HandleFunc(<span class=\"string\">\"/err\"</span>, errHandler)</span><br><span class=\"line\">    http.HandleFunc(<span class=\"string\">\"/\"</span>, homeHandler)</span><br><span class=\"line\">    http.ListenAndServe(<span class=\"string\">\":8080\"</span>, <span class=\"literal\">nil</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><code>go run expvarexample.go</code></li>\n<li><code>http://localhost:8080/ethan</code></li>\n<li><code>http://localhost:8080/err</code></li>\n<li><code>http://localhost:8080/debug/vars</code><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"cmdline\"</span>: [<span class=\"string\">\"/var/folders/jf/65ft181j33j_d75ktgv67bsc0000gn/T/go-build467453980/command-line-arguments/_obj/exe/expvarsample\"</span>],</span><br><span class=\"line\">    <span class=\"attr\">\"hits\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"ethan\"</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"favicon.ico\"</span>: <span class=\"number\">2</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    \"memstats\": &#123; ... &#125;,</span><br><span class=\"line\">    \"now\": \"\\\"2016-04-19 20:17:40\\\"\",</span><br><span class=\"line\">    \"stats\": &#123;</span><br><span class=\"line\">        \"TotalHit\":3,</span><br><span class=\"line\">        \"ErrorNums\":1</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a href=\"https://github.com/divan/expvarmon\" target=\"_blank\" rel=\"noopener\">expvarmon</a><code>expvar</code></p>\n<ul>\n<li><code>go get github.com/divan/expvarmon</code></li>\n<li><code>expvarmon -ports=&quot;8080&quot; -vars=&quot;hits.ethan,stats.TotalHit,stats.ErrorNums,now&quot;</code></li>\n<li><img src=\"/2016/04/20/experiences-about-develop-dlog/expvarmon_screen.png\" title=\"expvarmon screen\">\n</li>\n</ul>\n<p><code>dlog</code><code>expvar</code><code>dlog</code></p>\n<ul>\n<li><code>writtenRecords</code>: AWS Kinesis<code>msg</code></li>\n<li><code>writtenBatches</code>: AWS KinesisAPI</li>\n<li><code>failedRecords</code>: AWS Kinesis<code>msg</code></li>\n<li><code>tooBigMesssages</code>: (partitionKeySize1MB)<code>msg</code></li>\n</ul>\n<p></p>\n<h2 id=\"SetupTearDown\"><a href=\"#SetupTearDown\" class=\"headerlink\" title=\"SetupTearDown\"></a><code>Setup</code><code>TearDown</code></h2><p>Go<strong></strong><code>go test</code><code>testing</code> package<a href=\"http://docs.studygolang.com/doc/code.html#Testing\" target=\"_blank\" rel=\"noopener\"></a>Go</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//$GOPATH/src/github.com/user/stringutil/reverse_test.go</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> stringutil</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"testing\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TestReverse</span><span class=\"params\">(t *testing.T)</span></span> &#123;</span><br><span class=\"line\">    cases := []<span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">        in, want <span class=\"keyword\">string</span></span><br><span class=\"line\">    &#125;&#123;</span><br><span class=\"line\">        &#123;<span class=\"string\">\"Hello, world\"</span>, <span class=\"string\">\"dlrow ,olleH\"</span>&#125;,</span><br><span class=\"line\">        &#123;<span class=\"string\">\"Hello, \"</span>, <span class=\"string\">\" ,olleH\"</span>&#125;,</span><br><span class=\"line\">        &#123;<span class=\"string\">\"\"</span>, <span class=\"string\">\"\"</span>&#125;,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> _, c := <span class=\"keyword\">range</span> cases &#123;</span><br><span class=\"line\">        got := Reverse(c.in)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> got != c.want &#123;</span><br><span class=\"line\">            t.Errorf(<span class=\"string\">\"Reverse(%q) == %q, want %q\"</span>, c.in, got, c.want)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"keyword\">go</span> test github.com/user/stringutil</span><br><span class=\"line\">ok  \tgithub.com/user/stringutil <span class=\"number\">0.165s</span></span><br></pre></td></tr></table></figure>\n<p>IaaS<a href=\"https://github.com/stretchr/testify/suite\" target=\"_blank\" rel=\"noopener\">testify/suite</a> package<a href=\"https://github.com/stretchr/testify/suite\" target=\"_blank\" rel=\"noopener\">testify/suite</a><code>struct</code><code>setup</code>()/<code>teardown</code>()<code>go test</code></p>\n<p><a href=\"https://github.com/stretchr/testify/suite\" target=\"_blank\" rel=\"noopener\">testify/suite</a></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> suite</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"testing\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">\"github.com/stretchr/testify/assert\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> SuiteTester <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Include our basic suite logic.</span></span><br><span class=\"line\">    Suite</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Other properties</span></span><br><span class=\"line\">    propertyN <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The SetupSuite method will be run by testify once, at the very</span></span><br><span class=\"line\"><span class=\"comment\">// start of the testing suite, before any tests are run.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">SetupSuite</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The TearDownSuite method will be run by testify once, at the very</span></span><br><span class=\"line\"><span class=\"comment\">// end of the testing suite, after all tests have been run.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">TearDownSuite</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The SetupTest method will be run before every test in the suite.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">SetupTest</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The TearDownTest method will be run after every test in the suite.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">TearDownTest</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// a test method</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">TestOne</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// another test method</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(suite *SuiteTester)</span> <span class=\"title\">TestTwo</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// TestRunSuite will be run by the 'go test' command, so within it, we</span></span><br><span class=\"line\"><span class=\"comment\">// can run our suite using the Run(*testing.T, TestingSuite) function.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TestRunSuite</span><span class=\"params\">(t *testing.T)</span></span> &#123;</span><br><span class=\"line\">    suiteTester := <span class=\"built_in\">new</span>(SuiteTester)</span><br><span class=\"line\">    Run(t, suiteTester)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>dlog</code><code>Logger.Log</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> dlog</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> WriteLogSuiteTester <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    suite.Suite</span><br><span class=\"line\"></span><br><span class=\"line\">    options     *Options</span><br><span class=\"line\">    seachLogger *Logger</span><br><span class=\"line\">    clickLogger *Logger</span><br><span class=\"line\">    streamNames []<span class=\"keyword\">string</span> <span class=\"comment\">// save the created AWS Kinesis Streams, which will be removed in TearDownSuite()</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The SetupSuite method will be run by testify once, at the very</span></span><br><span class=\"line\"><span class=\"comment\">// start of the testing suite, before any tests are run.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *WriteLogSuiteTester)</span> <span class=\"title\">SetupSuite</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// create stream 1</span></span><br><span class=\"line\">    err = s.seachLogger.kinesis.CreateStream(s.seachLogger.streamName, testingShardCount)</span><br><span class=\"line\">    s.Nil(err)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// create stream 2</span></span><br><span class=\"line\">    err = s.clickLogger.kinesis.CreateStream(s.clickLogger.streamName, testingShardCount)</span><br><span class=\"line\">    s.Nil(err)</span><br><span class=\"line\"></span><br><span class=\"line\">    s.streamNames = []<span class=\"keyword\">string</span>&#123;s.seachLogger.streamName, s.clickLogger.streamName&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> &#123; <span class=\"comment\">// waiting created stream's status to be active</span></span><br><span class=\"line\">        time.Sleep(<span class=\"number\">1</span> * time.Second)</span><br><span class=\"line\">        resp1, err1 := s.seachLogger.kinesis.DescribeStream(s.seachLogger.streamName)</span><br><span class=\"line\">        s.Nil(err1)</span><br><span class=\"line\"></span><br><span class=\"line\">        resp2, err2 := s.seachLogger.kinesis.DescribeStream(s.clickLogger.streamName)</span><br><span class=\"line\">        s.Nil(err2)</span><br><span class=\"line\"></span><br><span class=\"line\">        status1 := strings.ToLower(<span class=\"keyword\">string</span>(resp1.StreamStatus))</span><br><span class=\"line\">        status2 := strings.ToLower(<span class=\"keyword\">string</span>(resp2.StreamStatus))</span><br><span class=\"line\">        <span class=\"keyword\">if</span> status1 == <span class=\"string\">\"active\"</span> &amp;&amp; status2 == <span class=\"string\">\"active\"</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// The TearDownSuite method will be run by testify once, at the very</span></span><br><span class=\"line\"><span class=\"comment\">// end of the testing suite, after all tests have been run.</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *WriteLogSuiteTester)</span> <span class=\"title\">TearDownSuite</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> s.streamNames == <span class=\"literal\">nil</span> || <span class=\"built_in\">len</span>(s.streamNames) == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> _, streamName := <span class=\"keyword\">range</span> s.streamNames &#123;</span><br><span class=\"line\">        err := s.seachLogger.kinesis.DeleteStream(streamName)</span><br><span class=\"line\">        s.Nil(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(s *WriteLogSuiteTester)</span> <span class=\"title\">TestWriteLog</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">defer</span> <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">()</span></span> &#123; <span class=\"comment\">// Recover if panicking to make sure TearDownSuite will be executed</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> r := <span class=\"built_in\">recover</span>(); r != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">            s.Fail(fmt.Sprint(r))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TestRunWriteLogSuite</span><span class=\"params\">(t *testing.T)</span></span> &#123;</span><br><span class=\"line\">    suiteTester := <span class=\"built_in\">new</span>(WriteLogSuiteTester)</span><br><span class=\"line\">    suite.Run(t, suiteTester)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li></li>\n<li><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"kinesisMock\"><a href=\"#kinesisMock\" class=\"headerlink\" title=\"kinesisMock\"></a><code>kinesisMock</code></h2><p>Mock</p>\n<p><code>dlog</code><code>KinesisInterface</code>:</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> KinesisInterface <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">    PutRecords(streamName <span class=\"keyword\">string</span>, records []kinesis.PutRecordsRequestEntry) (resp *kinesis.PutRecordsResponse, err error)</span><br><span class=\"line\">    CreateStream(name <span class=\"keyword\">string</span>, shardCount <span class=\"keyword\">int</span>) error</span><br><span class=\"line\">    DescribeStream(name <span class=\"keyword\">string</span>) (resp *kinesis.StreamDescription, err error)</span><br><span class=\"line\">    DeleteStream(name <span class=\"keyword\">string</span>) error</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>KinesisInterface</code><code>dlog</code><a href=\"https://github.com/AdRoll/goamz/blob/master/kinesis/kinesis.go\" target=\"_blank\" rel=\"noopener\">github.com/AdRoll/goamz/kinesis/kinesis</a>Go<code>interface</code><strong></strong><a href=\"https://github.com/AdRoll/goamz/blob/master/kinesis/kinesis.go\" target=\"_blank\" rel=\"noopener\">github.com/AdRoll/goamz/kinesis/kinesis</a><code>KinesisInterface</code><code>kinesisMock</code><code>KinesisInterface</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> kinesisMock <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Mapping from steam name to batches of batches</span></span><br><span class=\"line\">    storage <span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>][][]kinesis.PutRecordsRequestEntry</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// simulate lantency that sync to Kinesis</span></span><br><span class=\"line\">    putRecordLatency time.Duration</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// created streams' names</span></span><br><span class=\"line\">    streamNames []<span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// lock to solve concurrent call</span></span><br><span class=\"line\">    lock sync.RWMutex</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newKinesisMock</span><span class=\"params\">(putRecordsLatency time.Duration)</span> *<span class=\"title\">kinesisMock</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &amp;kinesisMock&#123;</span><br><span class=\"line\">        storage:          <span class=\"built_in\">make</span>(<span class=\"keyword\">map</span>[<span class=\"keyword\">string</span>][][]kinesis.PutRecordsRequestEntry),</span><br><span class=\"line\">        putRecordLatency: putRecordsLatency,</span><br><span class=\"line\">        streamNames:      <span class=\"built_in\">make</span>([]<span class=\"keyword\">string</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">PutRecords</span><span class=\"params\">(streamName <span class=\"keyword\">string</span>, records []kinesis.PutRecordsRequestEntry)</span> <span class=\"params\">(resp *kinesis.PutRecordsResponse, err error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">CreateStream</span><span class=\"params\">(name <span class=\"keyword\">string</span>, shardCount <span class=\"keyword\">int</span>)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">DescribeStream</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"params\">(resp *kinesis.StreamDescription, err error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">DeleteStream</span><span class=\"params\">(name <span class=\"keyword\">string</span>)</span> <span class=\"title\">error</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>kinesis</code><code>KinesisInterface</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Logger <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">    kinesis    KinesisInterface</span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Logger</code><code>kinesisMock</code><code>kinesis</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">TestLoggingToMockKinesis</span><span class=\"params\">(t *testing.T)</span></span> &#123;</span><br><span class=\"line\">    assert := assert.New(t)</span><br><span class=\"line\"></span><br><span class=\"line\">    l, e := NewLogger(&amp;impression&#123;&#125;, &amp;Options&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ...</span></span><br><span class=\"line\">        UseMockKinesis: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        MockKinesis:    newKinesisMock(<span class=\"number\">0</span>),</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"AWS-Kinesis\"><a href=\"#AWS-Kinesis\" class=\"headerlink\" title=\"AWS Kinesis\"></a>AWS Kinesis</h2><p><code>kinesisMock</code><code>kinesis</code></p>\n<p><code>kinesisMock</code><code>putRecordLatency</code><code>PutRecords</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> kinesisMock <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// simulate lantency that sync to Kinesis</span></span><br><span class=\"line\">    putRecordLatency time.Duration</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *kinesisMock)</span> <span class=\"title\">PutRecords</span><span class=\"params\">(streamName <span class=\"keyword\">string</span>, records []kinesis.PutRecordsRequestEntry)</span> <span class=\"params\">(resp *kinesis.PutRecordsResponse, err error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    time.Sleep(mock.putRecordLatency) <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>kinesis</code><code>brokenKinesisMock</code></p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> brokenKinesisMock <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">    *kinesisMock</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newBrokenKinesisMock</span><span class=\"params\">()</span> *<span class=\"title\">brokenKinesisMock</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &amp;brokenKinesisMock&#123;</span><br><span class=\"line\">        kinesisMock: newKinesisMock(<span class=\"number\">0</span>),</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(mock *brokenKinesisMock)</span> <span class=\"title\">PutRecords</span><span class=\"params\">(streamName <span class=\"keyword\">string</span>, records []kinesis.PutRecordsRequestEntry)</span> <span class=\"params\">(resp *kinesis.PutRecordsResponse, err error)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">nil</span>, fmt.Errorf(<span class=\"string\">\"Kinesis is broken\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>kinesisMock</code><code>brokenKinesisMock</code><code>struct</code><code>brokenKinesisMock</code><code>kinesisMock</code><code>KinesisInterface</code></p>\n<h2 id=\"log-Print\"><a href=\"#log-Print\" class=\"headerlink\" title=\"log.Print\"></a><code>log.Print</code></h2><p></p>\n<ul>\n<li><code>log.Print</code><code>stdout</code></li>\n<li><code>go test</code><code>-v</code><code>log.Print</code><code>log.Print</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://docs.aws.amazon.com/kinesis/latest/APIReference/API_CreateStream.html\" target=\"_blank\" rel=\"noopener\">AWS Kinesis API - CreateStream</a>Stream10+Stream</li>\n<li><a href=\"https://github.com/AdRoll/goamz/blob/master/aws/regions.go\" target=\"_blank\" rel=\"noopener\">github.com/AdRoll/goamz/aws/regions.go</a>AWS KinesisURLAWS Kinesis</li>\n<li>Travis CIKill1CI10</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li>Kinesis<code>dlog</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://docs.studygolang.com/doc/effective_go.html\" target=\"_blank\" rel=\"noopener\">Effective Go</a></li>\n<li><a href=\"https://aws.amazon.com/cn/documentation/kinesis/\" target=\"_blank\" rel=\"noopener\">Amazon Kinesis Documentation</a></li>\n<li><a href=\"http://blog.golang.org/advanced-go-concurrency-patterns\" target=\"_blank\" rel=\"noopener\">Advanced Go Concurrency Patterns</a></li>\n<li><a href=\"https://github.com/afex/hystrix-go\" target=\"_blank\" rel=\"noopener\">hystrix-go</a></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"http://www.augmn.com\" target=\"_blank\" rel=\"noopener\"></a>(ethancai@qq.com)</p>\n<img src=\"/2016/04/20/experiences-about-develop-dlog/2016-04-21_07-12-24.png\" title=\"1\">\n<img src=\"/2016/04/20/experiences-about-develop-dlog/2016-04-21_07-12-40.png\" title=\"2\">\n<p><strong> / Backend Engineer</strong></p>\n<p></p>\n<ul>\n<li></li>\n<li>micro-service</li>\n<li></li>\n<li>Code Review</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li>GoNode.jsC++Python</li>\n<li>RESTfulRPC</li>\n<li>web serviceweb app</li>\n<li>MysqlRedisMongoDB</li>\n<li></li>\n<li></li>\n<li></li>\n<li>53</li>\n</ul>\n<p><strong> / Senior Ops Engineer</strong></p>\n<p></p>\n<ul>\n<li>AWS</li>\n<li></li>\n<li></li>\n<li></li>\n<li>7*24</li>\n<li>IT</li>\n</ul>\n<p></p>\n<ul>\n<li>Linux/UnixLinux</li>\n<li>TCP/IPHTTP</li>\n<li>NginxDNSNTP</li>\n<li>ShellPythonPerl Ruby</li>\n<li>Linuxgrepawksedtmuxvim</li>\n<li>MySQL</li>\n<li></li>\n<li> 2 AWS</li>\n<li>DevOps</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n"},{"title":"Elasticsearch1Ubuntu 14.04Oracle JDK","date":"2016-08-05T16:29:11.000Z","_content":"\n{% asset_img oracle-jdk8-on-Ubuntu.png %}\n\n# JDK\n\n[Elasticsearch 2.3](https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html)JDKOracle JDK version 1.8.0_73Java 7.\n\n# OracleJDK\n\nOracle JDK\n\n- [How to Install Oracle Java JDK on Ubuntu Linux](http://www.wikihow.com/Install-Oracle-Java-JDK-on-Ubuntu-Linux)\n- `apt`[Installing the oracle JDK](https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-service.html#_installing_the_oracle_jdk)\n\n# \n\n- [](http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html)JDK 8u91\n- `~/Download/`'scp ~/Downloads/jdk-8u91-linux-x64.tar.gz ethancai@172.16.210.149:~/Downloads/'\n- SSHUbuntu Server`ssh ethancai@172.16.210.149`\n- OpenJDK\n    - `sudo apt-get purge openjdk-\\*`\n- \n    - `sudo mkdir -p /usr/local/java`\n    - `sudo cp -r ~/Downloads/jdk-8u91-linux-x64.tar.gz /usr/local/java/`\n- \n    - `cd /usr/local/java`\n    - `sudo tar -xvzf jdk-8u91-linux-x64.tar.gz`\n- Shell\n    - `sudo vim /etc/profile`\n    ```\n    JAVA_HOME=/usr/local/java/jdk1.8.0_91\n    JRE_HOME=$JAVA_HOME/jre\n    PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin\n    export JAVA_HOME\n    export JRE_HOME\n    export PATH\n    ```\n- Notify the system that JRE/JDK/Java Web Start is available for use\n    - `sudo update-alternatives --install \"/usr/bin/java\" \"java\" \"/usr/local/java/jdk1.8.0_91/bin/java\" 1`\n    - `sudo update-alternatives --install \"/usr/bin/javac\" \"javac\" \"/usr/local/java/jdk1.8.0_91/bin/javac\" 1`\n    - `sudo update-alternatives --install \"/usr/bin/javaws\" \"javaws\" \"/usr/local/java/jdk1.8.0_91/bin/javaws\" 1`\n- Reload your system wide PATH\n    - `source /etc/profile`\n\n# `apt`\n\n- jdk8`jdk-8u77-linux-x64`\n- `sudo apt-get purge openjdk-\\*`\n- `sudo add-apt-repository ppa:webupd8team/java`\n- `sudo apt-get update`\n- `sudo apt-get install oracle-java8-installer`\n\n# \n\n- `java -version`\n- `javac -version`\n- `sudo shutdown -r 0`\n","source":"_posts/install-oracle-jdk-on-ubuntu-14-04.md","raw":"---\ntitle: Elasticsearch1Ubuntu 14.04Oracle JDK\ntags:\n  - jdk\n  - elasticsearch\ncategories:\n  - \ndate: 2016-08-06 00:29:11\n---\n\n{% asset_img oracle-jdk8-on-Ubuntu.png %}\n\n# JDK\n\n[Elasticsearch 2.3](https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html)JDKOracle JDK version 1.8.0_73Java 7.\n\n# OracleJDK\n\nOracle JDK\n\n- [How to Install Oracle Java JDK on Ubuntu Linux](http://www.wikihow.com/Install-Oracle-Java-JDK-on-Ubuntu-Linux)\n- `apt`[Installing the oracle JDK](https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-service.html#_installing_the_oracle_jdk)\n\n# \n\n- [](http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html)JDK 8u91\n- `~/Download/`'scp ~/Downloads/jdk-8u91-linux-x64.tar.gz ethancai@172.16.210.149:~/Downloads/'\n- SSHUbuntu Server`ssh ethancai@172.16.210.149`\n- OpenJDK\n    - `sudo apt-get purge openjdk-\\*`\n- \n    - `sudo mkdir -p /usr/local/java`\n    - `sudo cp -r ~/Downloads/jdk-8u91-linux-x64.tar.gz /usr/local/java/`\n- \n    - `cd /usr/local/java`\n    - `sudo tar -xvzf jdk-8u91-linux-x64.tar.gz`\n- Shell\n    - `sudo vim /etc/profile`\n    ```\n    JAVA_HOME=/usr/local/java/jdk1.8.0_91\n    JRE_HOME=$JAVA_HOME/jre\n    PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin\n    export JAVA_HOME\n    export JRE_HOME\n    export PATH\n    ```\n- Notify the system that JRE/JDK/Java Web Start is available for use\n    - `sudo update-alternatives --install \"/usr/bin/java\" \"java\" \"/usr/local/java/jdk1.8.0_91/bin/java\" 1`\n    - `sudo update-alternatives --install \"/usr/bin/javac\" \"javac\" \"/usr/local/java/jdk1.8.0_91/bin/javac\" 1`\n    - `sudo update-alternatives --install \"/usr/bin/javaws\" \"javaws\" \"/usr/local/java/jdk1.8.0_91/bin/javaws\" 1`\n- Reload your system wide PATH\n    - `source /etc/profile`\n\n# `apt`\n\n- jdk8`jdk-8u77-linux-x64`\n- `sudo apt-get purge openjdk-\\*`\n- `sudo add-apt-repository ppa:webupd8team/java`\n- `sudo apt-get update`\n- `sudo apt-get install oracle-java8-installer`\n\n# \n\n- `java -version`\n- `javac -version`\n- `sudo shutdown -r 0`\n","slug":"install-oracle-jdk-on-ubuntu-14-04","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf24z000zv7e8twykfgeh","content":"<img src=\"/2016/08/06/install-oracle-jdk-on-ubuntu-14-04/oracle-jdk8-on-Ubuntu.png\">\n<h1 id=\"JDK\"><a href=\"#JDK\" class=\"headerlink\" title=\"JDK\"></a>JDK</h1><p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html\" target=\"_blank\" rel=\"noopener\">Elasticsearch 2.3</a>JDKOracle JDK version 1.8.0_73Java 7.</p>\n<h1 id=\"OracleJDK\"><a href=\"#OracleJDK\" class=\"headerlink\" title=\"OracleJDK\"></a>OracleJDK</h1><p>Oracle JDK</p>\n<ul>\n<li><a href=\"http://www.wikihow.com/Install-Oracle-Java-JDK-on-Ubuntu-Linux\" target=\"_blank\" rel=\"noopener\">How to Install Oracle Java JDK on Ubuntu Linux</a></li>\n<li><code>apt</code><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-service.html#_installing_the_oracle_jdk\" target=\"_blank\" rel=\"noopener\">Installing the oracle JDK</a></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\" target=\"_blank\" rel=\"noopener\"></a>JDK 8u91</li>\n<li><code>~/Download/</code>scp ~/Downloads/jdk-8u91-linux-x64.tar.gz ethancai@172.16.210.149:~/Downloads/</li>\n<li>SSHUbuntu Server<code>ssh ethancai@172.16.210.149</code></li>\n<li>OpenJDK<ul>\n<li><code>sudo apt-get purge openjdk-\\*</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>sudo mkdir -p /usr/local/java</code></li>\n<li><code>sudo cp -r ~/Downloads/jdk-8u91-linux-x64.tar.gz /usr/local/java/</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>cd /usr/local/java</code></li>\n<li><code>sudo tar -xvzf jdk-8u91-linux-x64.tar.gz</code></li>\n</ul>\n</li>\n<li><p>Shell</p>\n<ul>\n<li><code>sudo vim /etc/profile</code><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JAVA_HOME=/usr/local/java/jdk1.8.0_91</span><br><span class=\"line\">JRE_HOME=$JAVA_HOME/jre</span><br><span class=\"line\">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br><span class=\"line\">export JAVA_HOME</span><br><span class=\"line\">export JRE_HOME</span><br><span class=\"line\">export PATH</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>Notify the system that JRE/JDK/Java Web Start is available for use</p>\n<ul>\n<li><code>sudo update-alternatives --install &quot;/usr/bin/java&quot; &quot;java&quot; &quot;/usr/local/java/jdk1.8.0_91/bin/java&quot; 1</code></li>\n<li><code>sudo update-alternatives --install &quot;/usr/bin/javac&quot; &quot;javac&quot; &quot;/usr/local/java/jdk1.8.0_91/bin/javac&quot; 1</code></li>\n<li><code>sudo update-alternatives --install &quot;/usr/bin/javaws&quot; &quot;javaws&quot; &quot;/usr/local/java/jdk1.8.0_91/bin/javaws&quot; 1</code></li>\n</ul>\n</li>\n<li>Reload your system wide PATH<ul>\n<li><code>source /etc/profile</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"apt\"><a href=\"#apt\" class=\"headerlink\" title=\"apt\"></a><code>apt</code></h1><ul>\n<li>jdk8<code>jdk-8u77-linux-x64</code></li>\n<li><code>sudo apt-get purge openjdk-\\*</code></li>\n<li><code>sudo add-apt-repository ppa:webupd8team/java</code></li>\n<li><code>sudo apt-get update</code></li>\n<li><code>sudo apt-get install oracle-java8-installer</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><code>java -version</code></li>\n<li><code>javac -version</code></li>\n<li><code>sudo shutdown -r 0</code></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<img src=\"/2016/08/06/install-oracle-jdk-on-ubuntu-14-04/oracle-jdk8-on-Ubuntu.png\">\n<h1 id=\"JDK\"><a href=\"#JDK\" class=\"headerlink\" title=\"JDK\"></a>JDK</h1><p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html\" target=\"_blank\" rel=\"noopener\">Elasticsearch 2.3</a>JDKOracle JDK version 1.8.0_73Java 7.</p>\n<h1 id=\"OracleJDK\"><a href=\"#OracleJDK\" class=\"headerlink\" title=\"OracleJDK\"></a>OracleJDK</h1><p>Oracle JDK</p>\n<ul>\n<li><a href=\"http://www.wikihow.com/Install-Oracle-Java-JDK-on-Ubuntu-Linux\" target=\"_blank\" rel=\"noopener\">How to Install Oracle Java JDK on Ubuntu Linux</a></li>\n<li><code>apt</code><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-service.html#_installing_the_oracle_jdk\" target=\"_blank\" rel=\"noopener\">Installing the oracle JDK</a></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\" target=\"_blank\" rel=\"noopener\"></a>JDK 8u91</li>\n<li><code>~/Download/</code>scp ~/Downloads/jdk-8u91-linux-x64.tar.gz ethancai@172.16.210.149:~/Downloads/</li>\n<li>SSHUbuntu Server<code>ssh ethancai@172.16.210.149</code></li>\n<li>OpenJDK<ul>\n<li><code>sudo apt-get purge openjdk-\\*</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>sudo mkdir -p /usr/local/java</code></li>\n<li><code>sudo cp -r ~/Downloads/jdk-8u91-linux-x64.tar.gz /usr/local/java/</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>cd /usr/local/java</code></li>\n<li><code>sudo tar -xvzf jdk-8u91-linux-x64.tar.gz</code></li>\n</ul>\n</li>\n<li><p>Shell</p>\n<ul>\n<li><code>sudo vim /etc/profile</code><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JAVA_HOME=/usr/local/java/jdk1.8.0_91</span><br><span class=\"line\">JRE_HOME=$JAVA_HOME/jre</span><br><span class=\"line\">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br><span class=\"line\">export JAVA_HOME</span><br><span class=\"line\">export JRE_HOME</span><br><span class=\"line\">export PATH</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>Notify the system that JRE/JDK/Java Web Start is available for use</p>\n<ul>\n<li><code>sudo update-alternatives --install &quot;/usr/bin/java&quot; &quot;java&quot; &quot;/usr/local/java/jdk1.8.0_91/bin/java&quot; 1</code></li>\n<li><code>sudo update-alternatives --install &quot;/usr/bin/javac&quot; &quot;javac&quot; &quot;/usr/local/java/jdk1.8.0_91/bin/javac&quot; 1</code></li>\n<li><code>sudo update-alternatives --install &quot;/usr/bin/javaws&quot; &quot;javaws&quot; &quot;/usr/local/java/jdk1.8.0_91/bin/javaws&quot; 1</code></li>\n</ul>\n</li>\n<li>Reload your system wide PATH<ul>\n<li><code>source /etc/profile</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"apt\"><a href=\"#apt\" class=\"headerlink\" title=\"apt\"></a><code>apt</code></h1><ul>\n<li>jdk8<code>jdk-8u77-linux-x64</code></li>\n<li><code>sudo apt-get purge openjdk-\\*</code></li>\n<li><code>sudo add-apt-repository ppa:webupd8team/java</code></li>\n<li><code>sudo apt-get update</code></li>\n<li><code>sudo apt-get install oracle-java8-installer</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><code>java -version</code></li>\n<li><code>javac -version</code></li>\n<li><code>sudo shutdown -r 0</code></li>\n</ul>\n"},{"title":"Elasticsearch2Ubuntu 14.04Elasticsearch","date":"2016-08-05T16:40:48.000Z","_content":"\n{% asset_img logo-elastic.png %}\n\n\n#  Elasticsearch\n\n- `tar.gz`[ElasticSearch Reference 2.3 - Installation](https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html)\n- `apt`[ElasticSearch Reference 2.3 - Repositories](https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-repositories.html)\n\n## `tar.gz`\n\n- SSHUbuntu Server`ssh ethancai@###.###.###.###`\n- Elasticsearch\n    - `mkdir ~/Downloads && cd ~/Downloads && curl -L -O https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/2.3.1/elasticsearch-2.3.1.tar.gz`\n- \n    - `tar -xzvf elasticsearch-2.3.1.tar.gz && sudo mv elasticsearch-2.3.1 /var/`\n- \n    - `cd /var/elasticsearch-2.3.1/bin`\n    - `./elasticsearch``cluster``node``./elasticsearch --cluster.name my_cluster_name --node.name my_node_name`\n\n## `apt`\n\n- Download and install the Public Signing Key\n    - `wget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -`\n- Save the repository definition\n    - `echo \"deb http://packages.elastic.co/elasticsearch/2.x/debian stable main\" | sudo tee -a /etc/apt/sources.list.d/elasticsearch-2.x.list`\n- Install elasticsearch, \n    - `sudo apt-get update && sudo apt-get install elasticsearch=2.3.2`\n- Configure Elasticsearch to automatically start during bootup\n    - `sudo update-rc.d elasticsearch defaults 95 10`\n\n## \n\nBy default, Elasticsearch uses port 9200 to provide access to its REST API. \n\n- `curl 'localhost:9200/_cat/health?v'`\n- `curl 'localhost:9200/_cat/nodes?v'`\n- `sudo shutdown -r 0`\n\n# \n\n[ElasticSearch Reference 2.3 - Directory Layout](https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-dir-layout.html)\n\n`tar.gz`:\n\n| Type    | Description                                                                 | Location Debian/Ubuntu          |\n|:--------|:----------------------------------------------------------------------------|:--------------------------------|\n| home    | Home of elasticsearch installation.                                         | `{extract.path}`                |\n| bin     | Binary scripts including elasticsearch to start a node.                     | `{extract.path}/bin`            |\n| conf    | Configuration files elasticsearch.yml and logging.yml.                      | `{extract.path}/config`         |\n| data    | The location of the data files of each index / shard allocated on the node. | `{extract.path}/data`           |\n| logs    | Log files location                                                          | `{extract.path}/logs`           |\n| plugins | Plugin files location. Each plugin will be contained in a subdirectory.     | `{extract.path}/plugins`        |\n| repo    | Shared file system repository locations.                                    | Not configured                  |\n| script  | Location of script files.                                                   | `{extract.path}/config/scripts` |\n\n`apt`\n\n| Type    | Description                                                                                                          | Location Debian/Ubuntu             |\n|:--------|:---------------------------------------------------------------------------------------------------------------------|:-----------------------------------|\n| home    | Home of elasticsearch installation.                                                                                  | `/usr/share/elasticsearch`         |\n| bin     | Binary scripts including elasticsearch to start a node.                                                              | `/usr/share/elasticsearch/bin`     |\n| conf    | Configuration files elasticsearch.yml and logging.yml.                                                               | `/etc/elasticsearch`               |\n| conf    | Environment variables including heap size, file descriptors. **There isn't this folder when install using `tar.gz`** | `/etc/default/elasticsearch`       |\n| data    | The location of the data files of each index / shard allocated on the node.                                          | `/var/lib/elasticsearch`           |\n| logs    | Log files location                                                                                                   | `/var/log/elasticsearch`           |\n| plugins | Plugin files location. Each plugin will be contained in a subdirectory.                                              | `/usr/share/elasticsearch/plugins` |\n| repo    | Shared file system repository locations.                                                                             | Not configured                     |\n| script  | Location of script files.                                                                                            | `/etc/elasticsearch/scripts`       |\n\n# Elasticsearch\n\nPlugins are a way to enhance the core Elasticsearch functionality in a custom manner. They range from adding custom mapping types, custom analyzers, native scripts, custom discovery and more.\n\nThere are three types of plugins:\n\n- `Java Plugins`: These plugins contain only JAR files, and must be installed on every node in the cluster. **After installation, each node must be restarted before the plugin becomes visible.**\n- `Site Plugins`: These plugins contain static web content like Javascript, HTML, and CSS files, that can be served directly from Elasticsearch. Site plugins may only need to be installed on one node, and do not require a restart to become visible.\n    - The content of site plugins is accessible via a URL like: `http://yournode:9200/_plugin/[plugin name]`\n- `Mixed Plugins`: Mixed plugins contain both JAR files and web content.\n\n## `Site Plugins`\n\n```bash\n$ sudo su -\n$ cd /\n\n# \n$ /usr/share/elasticsearch/bin/plugin list\n\n# elasticsearch-headhttp://localhost:9200/_plugin/head\n$ /usr/share/elasticsearch/bin/plugin install mobz/elasticsearch-head\n\n# elasticsearch-kopfhttp://localhost:9200/_plugin/kopf\n$ /usr/share/elasticsearch/bin/plugin install lmenezes/elasticsearch-kopf\n\n# elastichqhttp://localhost:9200/_plugin/hq\n$ /usr/share/elasticsearch/bin/plugin install royrusso/elasticsearch-HQ\n\n# elasticsearch-inquisitorhttp://localhost:9200/_plugin/elasticsearch-inquisitor\n$ /usr/share/elasticsearch/bin/plugin install polyfractal/elasticsearch-inquisitor\n```\n\n## `Jar Plugins`\n\n### `elasticsearch-analysis-ik`\n\nElasticsearch[elasticsearch-analysis-ik](https://github.com/medcl/elasticsearch-analysis-ik)\n\n- \n    - [apache maven](http://maven.apache.org/install.html)\n    - `Apache Maven`\n        - `git clone https://github.com/medcl/elasticsearch-analysis-ik.git`\n    - \n        - `cd [elasticsearch-analysis-ik]`\n        - `git checkout v1.9.2`\n        - `mvn package`\n    - `target/releases/elasticsearch-analysis-ik-{version}.zip`Elasticsearchplugins\n        - `unzip elasticsearch-analysis-ik-{version}.zip -d elasticsearch-analysis-ik-{version}`\n        - `scp -r elasticsearch-analysis-ik-{version} ubuntu@xxx.xxx.xxx.xxx:/var/tmp/`\n        - `cp -R /var/tmp/elasticsearch-analysis-ik-{version} /usr/share/elasticsearch/plugins`\n        - `chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/plugins/elasticsearch-analysis-ik-{version}`\n    - elasticsearch\n        - `service elasticsearch restart`\n- [](https://github.com/medcl/elasticsearch-analysis-ik/releases)\n    - \n    - \n\n\n\n- v2.2.1`elasticsearch-analysis-ik``elasticsearch.yml`\n\n### `elasticsearch-analysis-pinyin`\n\nElasticsearch, [elasticsearch-analysis-pinyin](https://github.com/medcl/elasticsearch-analysis-pinyin)\n\n- \n    - `elasticsearch-analysis-ik`\n- [](https://github.com/medcl/elasticsearch-analysis-pinyin/releases)\n\n### `elasticsearch-analysis-stconvert`\n\nElasticsearch, [elasticsearch-analysis-stconvert](https://github.com/medcl/elasticsearch-analysis-stconvert)\n\n- \n    - `elasticsearch-analysis-ik`\n- [](https://github.com/medcl/elasticsearch-analysis-stconvert/releases)\n\n# \n\nOracle JDKElasticsearch`apt`\n\n- \n- \n- ElasticsearchDockerDocker[Dockerfile](https://github.com/docker-library/elasticsearch/blob/8267f6c29f06373373b4379473291d3082728cc0/2.3/Dockerfile)\n","source":"_posts/install-elasticsearch-on-ubuntu-14-04.md","raw":"---\ntitle: Elasticsearch2Ubuntu 14.04Elasticsearch\ntags:\n  - jdk\n  - elasticsearch\ncategories:\n  - \ndate: 2016-08-06 00:40:48\n---\n\n{% asset_img logo-elastic.png %}\n\n\n#  Elasticsearch\n\n- `tar.gz`[ElasticSearch Reference 2.3 - Installation](https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html)\n- `apt`[ElasticSearch Reference 2.3 - Repositories](https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-repositories.html)\n\n## `tar.gz`\n\n- SSHUbuntu Server`ssh ethancai@###.###.###.###`\n- Elasticsearch\n    - `mkdir ~/Downloads && cd ~/Downloads && curl -L -O https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/2.3.1/elasticsearch-2.3.1.tar.gz`\n- \n    - `tar -xzvf elasticsearch-2.3.1.tar.gz && sudo mv elasticsearch-2.3.1 /var/`\n- \n    - `cd /var/elasticsearch-2.3.1/bin`\n    - `./elasticsearch``cluster``node``./elasticsearch --cluster.name my_cluster_name --node.name my_node_name`\n\n## `apt`\n\n- Download and install the Public Signing Key\n    - `wget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -`\n- Save the repository definition\n    - `echo \"deb http://packages.elastic.co/elasticsearch/2.x/debian stable main\" | sudo tee -a /etc/apt/sources.list.d/elasticsearch-2.x.list`\n- Install elasticsearch, \n    - `sudo apt-get update && sudo apt-get install elasticsearch=2.3.2`\n- Configure Elasticsearch to automatically start during bootup\n    - `sudo update-rc.d elasticsearch defaults 95 10`\n\n## \n\nBy default, Elasticsearch uses port 9200 to provide access to its REST API. \n\n- `curl 'localhost:9200/_cat/health?v'`\n- `curl 'localhost:9200/_cat/nodes?v'`\n- `sudo shutdown -r 0`\n\n# \n\n[ElasticSearch Reference 2.3 - Directory Layout](https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-dir-layout.html)\n\n`tar.gz`:\n\n| Type    | Description                                                                 | Location Debian/Ubuntu          |\n|:--------|:----------------------------------------------------------------------------|:--------------------------------|\n| home    | Home of elasticsearch installation.                                         | `{extract.path}`                |\n| bin     | Binary scripts including elasticsearch to start a node.                     | `{extract.path}/bin`            |\n| conf    | Configuration files elasticsearch.yml and logging.yml.                      | `{extract.path}/config`         |\n| data    | The location of the data files of each index / shard allocated on the node. | `{extract.path}/data`           |\n| logs    | Log files location                                                          | `{extract.path}/logs`           |\n| plugins | Plugin files location. Each plugin will be contained in a subdirectory.     | `{extract.path}/plugins`        |\n| repo    | Shared file system repository locations.                                    | Not configured                  |\n| script  | Location of script files.                                                   | `{extract.path}/config/scripts` |\n\n`apt`\n\n| Type    | Description                                                                                                          | Location Debian/Ubuntu             |\n|:--------|:---------------------------------------------------------------------------------------------------------------------|:-----------------------------------|\n| home    | Home of elasticsearch installation.                                                                                  | `/usr/share/elasticsearch`         |\n| bin     | Binary scripts including elasticsearch to start a node.                                                              | `/usr/share/elasticsearch/bin`     |\n| conf    | Configuration files elasticsearch.yml and logging.yml.                                                               | `/etc/elasticsearch`               |\n| conf    | Environment variables including heap size, file descriptors. **There isn't this folder when install using `tar.gz`** | `/etc/default/elasticsearch`       |\n| data    | The location of the data files of each index / shard allocated on the node.                                          | `/var/lib/elasticsearch`           |\n| logs    | Log files location                                                                                                   | `/var/log/elasticsearch`           |\n| plugins | Plugin files location. Each plugin will be contained in a subdirectory.                                              | `/usr/share/elasticsearch/plugins` |\n| repo    | Shared file system repository locations.                                                                             | Not configured                     |\n| script  | Location of script files.                                                                                            | `/etc/elasticsearch/scripts`       |\n\n# Elasticsearch\n\nPlugins are a way to enhance the core Elasticsearch functionality in a custom manner. They range from adding custom mapping types, custom analyzers, native scripts, custom discovery and more.\n\nThere are three types of plugins:\n\n- `Java Plugins`: These plugins contain only JAR files, and must be installed on every node in the cluster. **After installation, each node must be restarted before the plugin becomes visible.**\n- `Site Plugins`: These plugins contain static web content like Javascript, HTML, and CSS files, that can be served directly from Elasticsearch. Site plugins may only need to be installed on one node, and do not require a restart to become visible.\n    - The content of site plugins is accessible via a URL like: `http://yournode:9200/_plugin/[plugin name]`\n- `Mixed Plugins`: Mixed plugins contain both JAR files and web content.\n\n## `Site Plugins`\n\n```bash\n$ sudo su -\n$ cd /\n\n# \n$ /usr/share/elasticsearch/bin/plugin list\n\n# elasticsearch-headhttp://localhost:9200/_plugin/head\n$ /usr/share/elasticsearch/bin/plugin install mobz/elasticsearch-head\n\n# elasticsearch-kopfhttp://localhost:9200/_plugin/kopf\n$ /usr/share/elasticsearch/bin/plugin install lmenezes/elasticsearch-kopf\n\n# elastichqhttp://localhost:9200/_plugin/hq\n$ /usr/share/elasticsearch/bin/plugin install royrusso/elasticsearch-HQ\n\n# elasticsearch-inquisitorhttp://localhost:9200/_plugin/elasticsearch-inquisitor\n$ /usr/share/elasticsearch/bin/plugin install polyfractal/elasticsearch-inquisitor\n```\n\n## `Jar Plugins`\n\n### `elasticsearch-analysis-ik`\n\nElasticsearch[elasticsearch-analysis-ik](https://github.com/medcl/elasticsearch-analysis-ik)\n\n- \n    - [apache maven](http://maven.apache.org/install.html)\n    - `Apache Maven`\n        - `git clone https://github.com/medcl/elasticsearch-analysis-ik.git`\n    - \n        - `cd [elasticsearch-analysis-ik]`\n        - `git checkout v1.9.2`\n        - `mvn package`\n    - `target/releases/elasticsearch-analysis-ik-{version}.zip`Elasticsearchplugins\n        - `unzip elasticsearch-analysis-ik-{version}.zip -d elasticsearch-analysis-ik-{version}`\n        - `scp -r elasticsearch-analysis-ik-{version} ubuntu@xxx.xxx.xxx.xxx:/var/tmp/`\n        - `cp -R /var/tmp/elasticsearch-analysis-ik-{version} /usr/share/elasticsearch/plugins`\n        - `chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/plugins/elasticsearch-analysis-ik-{version}`\n    - elasticsearch\n        - `service elasticsearch restart`\n- [](https://github.com/medcl/elasticsearch-analysis-ik/releases)\n    - \n    - \n\n\n\n- v2.2.1`elasticsearch-analysis-ik``elasticsearch.yml`\n\n### `elasticsearch-analysis-pinyin`\n\nElasticsearch, [elasticsearch-analysis-pinyin](https://github.com/medcl/elasticsearch-analysis-pinyin)\n\n- \n    - `elasticsearch-analysis-ik`\n- [](https://github.com/medcl/elasticsearch-analysis-pinyin/releases)\n\n### `elasticsearch-analysis-stconvert`\n\nElasticsearch, [elasticsearch-analysis-stconvert](https://github.com/medcl/elasticsearch-analysis-stconvert)\n\n- \n    - `elasticsearch-analysis-ik`\n- [](https://github.com/medcl/elasticsearch-analysis-stconvert/releases)\n\n# \n\nOracle JDKElasticsearch`apt`\n\n- \n- \n- ElasticsearchDockerDocker[Dockerfile](https://github.com/docker-library/elasticsearch/blob/8267f6c29f06373373b4379473291d3082728cc0/2.3/Dockerfile)\n","slug":"install-elasticsearch-on-ubuntu-14-04","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf2500012v7e8axosp2r0","content":"<img src=\"/2016/08/06/install-elasticsearch-on-ubuntu-14-04/logo-elastic.png\">\n<h1 id=\"Elasticsearch\"><a href=\"#Elasticsearch\" class=\"headerlink\" title=\"Elasticsearch\"></a>Elasticsearch</h1><ul>\n<li><code>tar.gz</code><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html\" target=\"_blank\" rel=\"noopener\">ElasticSearch Reference 2.3 - Installation</a></li>\n<li><code>apt</code><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-repositories.html\" target=\"_blank\" rel=\"noopener\">ElasticSearch Reference 2.3 - Repositories</a></li>\n</ul>\n<h2 id=\"tar-gz\"><a href=\"#tar-gz\" class=\"headerlink\" title=\"tar.gz\"></a><code>tar.gz</code></h2><ul>\n<li>SSHUbuntu Server<code>ssh ethancai@###.###.###.###</code></li>\n<li>Elasticsearch<ul>\n<li><code>mkdir ~/Downloads &amp;&amp; cd ~/Downloads &amp;&amp; curl -L -O https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/2.3.1/elasticsearch-2.3.1.tar.gz</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>tar -xzvf elasticsearch-2.3.1.tar.gz &amp;&amp; sudo mv elasticsearch-2.3.1 /var/</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>cd /var/elasticsearch-2.3.1/bin</code></li>\n<li><code>./elasticsearch</code><code>cluster</code><code>node</code><code>./elasticsearch --cluster.name my_cluster_name --node.name my_node_name</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"apt\"><a href=\"#apt\" class=\"headerlink\" title=\"apt\"></a><code>apt</code></h2><ul>\n<li>Download and install the Public Signing Key<ul>\n<li><code>wget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -</code></li>\n</ul>\n</li>\n<li>Save the repository definition<ul>\n<li><code>echo &quot;deb http://packages.elastic.co/elasticsearch/2.x/debian stable main&quot; | sudo tee -a /etc/apt/sources.list.d/elasticsearch-2.x.list</code></li>\n</ul>\n</li>\n<li>Install elasticsearch, <ul>\n<li><code>sudo apt-get update &amp;&amp; sudo apt-get install elasticsearch=2.3.2</code></li>\n</ul>\n</li>\n<li>Configure Elasticsearch to automatically start during bootup<ul>\n<li><code>sudo update-rc.d elasticsearch defaults 95 10</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>By default, Elasticsearch uses port 9200 to provide access to its REST API. </p>\n<ul>\n<li><code>curl &#39;localhost:9200/_cat/health?v&#39;</code></li>\n<li><code>curl &#39;localhost:9200/_cat/nodes?v&#39;</code></li>\n<li><code>sudo shutdown -r 0</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-dir-layout.html\" target=\"_blank\" rel=\"noopener\">ElasticSearch Reference 2.3 - Directory Layout</a></p>\n<p><code>tar.gz</code>:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Type</th>\n<th style=\"text-align:left\">Description</th>\n<th style=\"text-align:left\">Location Debian/Ubuntu</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">home</td>\n<td style=\"text-align:left\">Home of elasticsearch installation.</td>\n<td style=\"text-align:left\"><code>{extract.path}</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">bin</td>\n<td style=\"text-align:left\">Binary scripts including elasticsearch to start a node.</td>\n<td style=\"text-align:left\"><code>{extract.path}/bin</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">conf</td>\n<td style=\"text-align:left\">Configuration files elasticsearch.yml and logging.yml.</td>\n<td style=\"text-align:left\"><code>{extract.path}/config</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">data</td>\n<td style=\"text-align:left\">The location of the data files of each index / shard allocated on the node.</td>\n<td style=\"text-align:left\"><code>{extract.path}/data</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">logs</td>\n<td style=\"text-align:left\">Log files location</td>\n<td style=\"text-align:left\"><code>{extract.path}/logs</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">plugins</td>\n<td style=\"text-align:left\">Plugin files location. Each plugin will be contained in a subdirectory.</td>\n<td style=\"text-align:left\"><code>{extract.path}/plugins</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">repo</td>\n<td style=\"text-align:left\">Shared file system repository locations.</td>\n<td style=\"text-align:left\">Not configured</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">script</td>\n<td style=\"text-align:left\">Location of script files.</td>\n<td style=\"text-align:left\"><code>{extract.path}/config/scripts</code></td>\n</tr>\n</tbody>\n</table>\n<p><code>apt</code></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Type</th>\n<th style=\"text-align:left\">Description</th>\n<th style=\"text-align:left\">Location Debian/Ubuntu</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">home</td>\n<td style=\"text-align:left\">Home of elasticsearch installation.</td>\n<td style=\"text-align:left\"><code>/usr/share/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">bin</td>\n<td style=\"text-align:left\">Binary scripts including elasticsearch to start a node.</td>\n<td style=\"text-align:left\"><code>/usr/share/elasticsearch/bin</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">conf</td>\n<td style=\"text-align:left\">Configuration files elasticsearch.yml and logging.yml.</td>\n<td style=\"text-align:left\"><code>/etc/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">conf</td>\n<td style=\"text-align:left\">Environment variables including heap size, file descriptors. <strong>There isnt this folder when install using <code>tar.gz</code></strong></td>\n<td style=\"text-align:left\"><code>/etc/default/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">data</td>\n<td style=\"text-align:left\">The location of the data files of each index / shard allocated on the node.</td>\n<td style=\"text-align:left\"><code>/var/lib/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">logs</td>\n<td style=\"text-align:left\">Log files location</td>\n<td style=\"text-align:left\"><code>/var/log/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">plugins</td>\n<td style=\"text-align:left\">Plugin files location. Each plugin will be contained in a subdirectory.</td>\n<td style=\"text-align:left\"><code>/usr/share/elasticsearch/plugins</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">repo</td>\n<td style=\"text-align:left\">Shared file system repository locations.</td>\n<td style=\"text-align:left\">Not configured</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">script</td>\n<td style=\"text-align:left\">Location of script files.</td>\n<td style=\"text-align:left\"><code>/etc/elasticsearch/scripts</code></td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"Elasticsearch\"><a href=\"#Elasticsearch\" class=\"headerlink\" title=\"Elasticsearch\"></a>Elasticsearch</h1><p>Plugins are a way to enhance the core Elasticsearch functionality in a custom manner. They range from adding custom mapping types, custom analyzers, native scripts, custom discovery and more.</p>\n<p>There are three types of plugins:</p>\n<ul>\n<li><code>Java Plugins</code>: These plugins contain only JAR files, and must be installed on every node in the cluster. <strong>After installation, each node must be restarted before the plugin becomes visible.</strong></li>\n<li><code>Site Plugins</code>: These plugins contain static web content like Javascript, HTML, and CSS files, that can be served directly from Elasticsearch. Site plugins may only need to be installed on one node, and do not require a restart to become visible.<ul>\n<li>The content of site plugins is accessible via a URL like: <code>http://yournode:9200/_plugin/[plugin name]</code></li>\n</ul>\n</li>\n<li><code>Mixed Plugins</code>: Mixed plugins contain both JAR files and web content.</li>\n</ul>\n<h2 id=\"Site-Plugins\"><a href=\"#Site-Plugins\" class=\"headerlink\" title=\"Site Plugins\"></a><code>Site Plugins</code></h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo su -</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> /</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin list</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch-headhttp://localhost:9200/_plugin/head</span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin install mobz/elasticsearch-head</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch-kopfhttp://localhost:9200/_plugin/kopf</span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin install lmenezes/elasticsearch-kopf</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># elastichqhttp://localhost:9200/_plugin/hq</span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin install royrusso/elasticsearch-HQ</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch-inquisitorhttp://localhost:9200/_plugin/elasticsearch-inquisitor</span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin install polyfractal/elasticsearch-inquisitor</span><br></pre></td></tr></table></figure>\n<h2 id=\"Jar-Plugins\"><a href=\"#Jar-Plugins\" class=\"headerlink\" title=\"Jar Plugins\"></a><code>Jar Plugins</code></h2><h3 id=\"elasticsearch-analysis-ik\"><a href=\"#elasticsearch-analysis-ik\" class=\"headerlink\" title=\"elasticsearch-analysis-ik\"></a><code>elasticsearch-analysis-ik</code></h3><p>Elasticsearch<a href=\"https://github.com/medcl/elasticsearch-analysis-ik\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-ik</a></p>\n<ul>\n<li><ul>\n<li><a href=\"http://maven.apache.org/install.html\" target=\"_blank\" rel=\"noopener\">apache maven</a></li>\n<li><code>Apache Maven</code><ul>\n<li><code>git clone https://github.com/medcl/elasticsearch-analysis-ik.git</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>cd [elasticsearch-analysis-ik]</code></li>\n<li><code>git checkout v1.9.2</code></li>\n<li><code>mvn package</code></li>\n</ul>\n</li>\n<li><code>target/releases/elasticsearch-analysis-ik-{version}.zip</code>Elasticsearchplugins<ul>\n<li><code>unzip elasticsearch-analysis-ik-{version}.zip -d elasticsearch-analysis-ik-{version}</code></li>\n<li><code>scp -r elasticsearch-analysis-ik-{version} ubuntu@xxx.xxx.xxx.xxx:/var/tmp/</code></li>\n<li><code>cp -R /var/tmp/elasticsearch-analysis-ik-{version} /usr/share/elasticsearch/plugins</code></li>\n<li><code>chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/plugins/elasticsearch-analysis-ik-{version}</code></li>\n</ul>\n</li>\n<li>elasticsearch<ul>\n<li><code>service elasticsearch restart</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-ik/releases\" target=\"_blank\" rel=\"noopener\"></a><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<p></p>\n<ul>\n<li>v2.2.1<code>elasticsearch-analysis-ik</code><code>elasticsearch.yml</code></li>\n</ul>\n<h3 id=\"elasticsearch-analysis-pinyin\"><a href=\"#elasticsearch-analysis-pinyin\" class=\"headerlink\" title=\"elasticsearch-analysis-pinyin\"></a><code>elasticsearch-analysis-pinyin</code></h3><p>Elasticsearch, <a href=\"https://github.com/medcl/elasticsearch-analysis-pinyin\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-pinyin</a></p>\n<ul>\n<li><ul>\n<li><code>elasticsearch-analysis-ik</code></li>\n</ul>\n</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-pinyin/releases\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n<h3 id=\"elasticsearch-analysis-stconvert\"><a href=\"#elasticsearch-analysis-stconvert\" class=\"headerlink\" title=\"elasticsearch-analysis-stconvert\"></a><code>elasticsearch-analysis-stconvert</code></h3><p>Elasticsearch, <a href=\"https://github.com/medcl/elasticsearch-analysis-stconvert\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-stconvert</a></p>\n<ul>\n<li><ul>\n<li><code>elasticsearch-analysis-ik</code></li>\n</ul>\n</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-stconvert/releases\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Oracle JDKElasticsearch<code>apt</code></p>\n<ul>\n<li></li>\n<li></li>\n<li>ElasticsearchDockerDocker<a href=\"https://github.com/docker-library/elasticsearch/blob/8267f6c29f06373373b4379473291d3082728cc0/2.3/Dockerfile\" target=\"_blank\" rel=\"noopener\">Dockerfile</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<img src=\"/2016/08/06/install-elasticsearch-on-ubuntu-14-04/logo-elastic.png\">\n<h1 id=\"Elasticsearch\"><a href=\"#Elasticsearch\" class=\"headerlink\" title=\"Elasticsearch\"></a>Elasticsearch</h1><ul>\n<li><code>tar.gz</code><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html\" target=\"_blank\" rel=\"noopener\">ElasticSearch Reference 2.3 - Installation</a></li>\n<li><code>apt</code><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-repositories.html\" target=\"_blank\" rel=\"noopener\">ElasticSearch Reference 2.3 - Repositories</a></li>\n</ul>\n<h2 id=\"tar-gz\"><a href=\"#tar-gz\" class=\"headerlink\" title=\"tar.gz\"></a><code>tar.gz</code></h2><ul>\n<li>SSHUbuntu Server<code>ssh ethancai@###.###.###.###</code></li>\n<li>Elasticsearch<ul>\n<li><code>mkdir ~/Downloads &amp;&amp; cd ~/Downloads &amp;&amp; curl -L -O https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/2.3.1/elasticsearch-2.3.1.tar.gz</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>tar -xzvf elasticsearch-2.3.1.tar.gz &amp;&amp; sudo mv elasticsearch-2.3.1 /var/</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>cd /var/elasticsearch-2.3.1/bin</code></li>\n<li><code>./elasticsearch</code><code>cluster</code><code>node</code><code>./elasticsearch --cluster.name my_cluster_name --node.name my_node_name</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"apt\"><a href=\"#apt\" class=\"headerlink\" title=\"apt\"></a><code>apt</code></h2><ul>\n<li>Download and install the Public Signing Key<ul>\n<li><code>wget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -</code></li>\n</ul>\n</li>\n<li>Save the repository definition<ul>\n<li><code>echo &quot;deb http://packages.elastic.co/elasticsearch/2.x/debian stable main&quot; | sudo tee -a /etc/apt/sources.list.d/elasticsearch-2.x.list</code></li>\n</ul>\n</li>\n<li>Install elasticsearch, <ul>\n<li><code>sudo apt-get update &amp;&amp; sudo apt-get install elasticsearch=2.3.2</code></li>\n</ul>\n</li>\n<li>Configure Elasticsearch to automatically start during bootup<ul>\n<li><code>sudo update-rc.d elasticsearch defaults 95 10</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>By default, Elasticsearch uses port 9200 to provide access to its REST API. </p>\n<ul>\n<li><code>curl &#39;localhost:9200/_cat/health?v&#39;</code></li>\n<li><code>curl &#39;localhost:9200/_cat/nodes?v&#39;</code></li>\n<li><code>sudo shutdown -r 0</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-dir-layout.html\" target=\"_blank\" rel=\"noopener\">ElasticSearch Reference 2.3 - Directory Layout</a></p>\n<p><code>tar.gz</code>:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Type</th>\n<th style=\"text-align:left\">Description</th>\n<th style=\"text-align:left\">Location Debian/Ubuntu</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">home</td>\n<td style=\"text-align:left\">Home of elasticsearch installation.</td>\n<td style=\"text-align:left\"><code>{extract.path}</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">bin</td>\n<td style=\"text-align:left\">Binary scripts including elasticsearch to start a node.</td>\n<td style=\"text-align:left\"><code>{extract.path}/bin</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">conf</td>\n<td style=\"text-align:left\">Configuration files elasticsearch.yml and logging.yml.</td>\n<td style=\"text-align:left\"><code>{extract.path}/config</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">data</td>\n<td style=\"text-align:left\">The location of the data files of each index / shard allocated on the node.</td>\n<td style=\"text-align:left\"><code>{extract.path}/data</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">logs</td>\n<td style=\"text-align:left\">Log files location</td>\n<td style=\"text-align:left\"><code>{extract.path}/logs</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">plugins</td>\n<td style=\"text-align:left\">Plugin files location. Each plugin will be contained in a subdirectory.</td>\n<td style=\"text-align:left\"><code>{extract.path}/plugins</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">repo</td>\n<td style=\"text-align:left\">Shared file system repository locations.</td>\n<td style=\"text-align:left\">Not configured</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">script</td>\n<td style=\"text-align:left\">Location of script files.</td>\n<td style=\"text-align:left\"><code>{extract.path}/config/scripts</code></td>\n</tr>\n</tbody>\n</table>\n<p><code>apt</code></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">Type</th>\n<th style=\"text-align:left\">Description</th>\n<th style=\"text-align:left\">Location Debian/Ubuntu</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">home</td>\n<td style=\"text-align:left\">Home of elasticsearch installation.</td>\n<td style=\"text-align:left\"><code>/usr/share/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">bin</td>\n<td style=\"text-align:left\">Binary scripts including elasticsearch to start a node.</td>\n<td style=\"text-align:left\"><code>/usr/share/elasticsearch/bin</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">conf</td>\n<td style=\"text-align:left\">Configuration files elasticsearch.yml and logging.yml.</td>\n<td style=\"text-align:left\"><code>/etc/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">conf</td>\n<td style=\"text-align:left\">Environment variables including heap size, file descriptors. <strong>There isnt this folder when install using <code>tar.gz</code></strong></td>\n<td style=\"text-align:left\"><code>/etc/default/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">data</td>\n<td style=\"text-align:left\">The location of the data files of each index / shard allocated on the node.</td>\n<td style=\"text-align:left\"><code>/var/lib/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">logs</td>\n<td style=\"text-align:left\">Log files location</td>\n<td style=\"text-align:left\"><code>/var/log/elasticsearch</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">plugins</td>\n<td style=\"text-align:left\">Plugin files location. Each plugin will be contained in a subdirectory.</td>\n<td style=\"text-align:left\"><code>/usr/share/elasticsearch/plugins</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">repo</td>\n<td style=\"text-align:left\">Shared file system repository locations.</td>\n<td style=\"text-align:left\">Not configured</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">script</td>\n<td style=\"text-align:left\">Location of script files.</td>\n<td style=\"text-align:left\"><code>/etc/elasticsearch/scripts</code></td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"Elasticsearch\"><a href=\"#Elasticsearch\" class=\"headerlink\" title=\"Elasticsearch\"></a>Elasticsearch</h1><p>Plugins are a way to enhance the core Elasticsearch functionality in a custom manner. They range from adding custom mapping types, custom analyzers, native scripts, custom discovery and more.</p>\n<p>There are three types of plugins:</p>\n<ul>\n<li><code>Java Plugins</code>: These plugins contain only JAR files, and must be installed on every node in the cluster. <strong>After installation, each node must be restarted before the plugin becomes visible.</strong></li>\n<li><code>Site Plugins</code>: These plugins contain static web content like Javascript, HTML, and CSS files, that can be served directly from Elasticsearch. Site plugins may only need to be installed on one node, and do not require a restart to become visible.<ul>\n<li>The content of site plugins is accessible via a URL like: <code>http://yournode:9200/_plugin/[plugin name]</code></li>\n</ul>\n</li>\n<li><code>Mixed Plugins</code>: Mixed plugins contain both JAR files and web content.</li>\n</ul>\n<h2 id=\"Site-Plugins\"><a href=\"#Site-Plugins\" class=\"headerlink\" title=\"Site Plugins\"></a><code>Site Plugins</code></h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo su -</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> /</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin list</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch-headhttp://localhost:9200/_plugin/head</span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin install mobz/elasticsearch-head</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch-kopfhttp://localhost:9200/_plugin/kopf</span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin install lmenezes/elasticsearch-kopf</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># elastichqhttp://localhost:9200/_plugin/hq</span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin install royrusso/elasticsearch-HQ</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># elasticsearch-inquisitorhttp://localhost:9200/_plugin/elasticsearch-inquisitor</span></span><br><span class=\"line\">$ /usr/share/elasticsearch/bin/plugin install polyfractal/elasticsearch-inquisitor</span><br></pre></td></tr></table></figure>\n<h2 id=\"Jar-Plugins\"><a href=\"#Jar-Plugins\" class=\"headerlink\" title=\"Jar Plugins\"></a><code>Jar Plugins</code></h2><h3 id=\"elasticsearch-analysis-ik\"><a href=\"#elasticsearch-analysis-ik\" class=\"headerlink\" title=\"elasticsearch-analysis-ik\"></a><code>elasticsearch-analysis-ik</code></h3><p>Elasticsearch<a href=\"https://github.com/medcl/elasticsearch-analysis-ik\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-ik</a></p>\n<ul>\n<li><ul>\n<li><a href=\"http://maven.apache.org/install.html\" target=\"_blank\" rel=\"noopener\">apache maven</a></li>\n<li><code>Apache Maven</code><ul>\n<li><code>git clone https://github.com/medcl/elasticsearch-analysis-ik.git</code></li>\n</ul>\n</li>\n<li><ul>\n<li><code>cd [elasticsearch-analysis-ik]</code></li>\n<li><code>git checkout v1.9.2</code></li>\n<li><code>mvn package</code></li>\n</ul>\n</li>\n<li><code>target/releases/elasticsearch-analysis-ik-{version}.zip</code>Elasticsearchplugins<ul>\n<li><code>unzip elasticsearch-analysis-ik-{version}.zip -d elasticsearch-analysis-ik-{version}</code></li>\n<li><code>scp -r elasticsearch-analysis-ik-{version} ubuntu@xxx.xxx.xxx.xxx:/var/tmp/</code></li>\n<li><code>cp -R /var/tmp/elasticsearch-analysis-ik-{version} /usr/share/elasticsearch/plugins</code></li>\n<li><code>chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/plugins/elasticsearch-analysis-ik-{version}</code></li>\n</ul>\n</li>\n<li>elasticsearch<ul>\n<li><code>service elasticsearch restart</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-ik/releases\" target=\"_blank\" rel=\"noopener\"></a><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<p></p>\n<ul>\n<li>v2.2.1<code>elasticsearch-analysis-ik</code><code>elasticsearch.yml</code></li>\n</ul>\n<h3 id=\"elasticsearch-analysis-pinyin\"><a href=\"#elasticsearch-analysis-pinyin\" class=\"headerlink\" title=\"elasticsearch-analysis-pinyin\"></a><code>elasticsearch-analysis-pinyin</code></h3><p>Elasticsearch, <a href=\"https://github.com/medcl/elasticsearch-analysis-pinyin\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-pinyin</a></p>\n<ul>\n<li><ul>\n<li><code>elasticsearch-analysis-ik</code></li>\n</ul>\n</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-pinyin/releases\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n<h3 id=\"elasticsearch-analysis-stconvert\"><a href=\"#elasticsearch-analysis-stconvert\" class=\"headerlink\" title=\"elasticsearch-analysis-stconvert\"></a><code>elasticsearch-analysis-stconvert</code></h3><p>Elasticsearch, <a href=\"https://github.com/medcl/elasticsearch-analysis-stconvert\" target=\"_blank\" rel=\"noopener\">elasticsearch-analysis-stconvert</a></p>\n<ul>\n<li><ul>\n<li><code>elasticsearch-analysis-ik</code></li>\n</ul>\n</li>\n<li><a href=\"https://github.com/medcl/elasticsearch-analysis-stconvert/releases\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Oracle JDKElasticsearch<code>apt</code></p>\n<ul>\n<li></li>\n<li></li>\n<li>ElasticsearchDockerDocker<a href=\"https://github.com/docker-library/elasticsearch/blob/8267f6c29f06373373b4379473291d3082728cc0/2.3/Dockerfile\" target=\"_blank\" rel=\"noopener\">Dockerfile</a></li>\n</ul>\n"},{"title":"2 - Make PHP development VM using Vagrant | Study PHP","date":"2017-06-13T09:42:06.000Z","_content":"\n\n{% asset_img make-php-development-VM-using-Vagrant-13489.png %}\n\n\nhttps://github.com/EthanCai/php-dev-vm\n\n# \n\n`php-dev-vm``PHP``Vagrantfile``PHP`\n\n# \n\n\n\n- \n- \n- \n- \n\n#  - VMDocker\n\n\n\n`Vagrant``Rsync``FTP`\n\n **PHP Docker**PHP\n\n#  - `Vagrant`PHP\n\nPHP\n\n## \n\n- macOS Sierra Version 10.12.5\n- `homebrew`\n- `vagrantup`\n- `virualbox`\n\n## Vagrant Box\n\nInstall CentOS 7.2 box\n\n```sh\n> vagrant box add \"CentOS-7.2-x64\" https://github.com/CommanderK5/packer-centos-template/releases/download/0.7.2/vagrant-centos-7.2.box\n```\n\n## PHPVagrant Box\n\n### `php-dev-vm-5.6.30.box`\n\n`Vagrantfile`:\n\n[](./src/PHP-5.6.30/Vagrantfile)\n\n`Vagrant Box`:\n\n```sh\n> # start vm\n> vagrant up\n\n> # config mysql root password\n> mysql_secure_installation\n> # todo: add more config statements\n\n> # create vagrant box\n> vagrant package --output \"php-dev-vm-5.6.30.box\" {vm_id} && mv php-dev-vm-5.6.30.box ../../box/\n```\n\n## Vagrant BoxPHP\n\n###  `php-dev-vm-5.6.30.box`\n\n```sh\n> # build php-dev-vm-5.6.30.box or download box from ftp://10.75.87.202/php-dev-vm-5.6.30.box (get the url from Ethan if not available)\n> wget ftp://10.75.87.202/php-dev-vm-5.6.30.box && mv php-dev-vm-5.6.30.box ./box/php-dev-vm-5.6.30.box\n\n> cd work/php56\n> vagrant box remove \"../../box/php-dev-vm-5.6.30.box\" || true && vagrant up  # ignore error when box not exists\n\n> # the password of mysql `root` user is `eVkU,iO);5R>`\n```\n\n# References\n\n- Vagrant: https://www.vagrantup.com/docs/index.html\n- Discover Vagrant Boxes\n  - https://atlas.hashicorp.com/boxes/search\n  - http://www.vagrantbox.es/\n- Nginx\n  - [Nginx Beginner's Guide](http://nginx.org/en/docs/beginners_guide.html)\n  - [Setting up PHP-FastCGI and nginx? Dont trust the tutorials: check your configuration!](https://nealpoole.com/blog/2011/04/setting-up-php-fastcgi-and-nginx-dont-trust-the-tutorials-check-your-configuration/)\n  - [nginxphp-fpm](https://segmentfault.com/a/1190000003067656)\n- PHP-FPM\n  - FastCGI FPMhttp://php.net/manual/zh/install.fpm.configuration.php\n  - https://www.nginx.com/resources/wiki/start/topics/examples/phpfcgi/\n- PHP Function Reference\n  - http://php.net/manual/en/funcref.php\n- [Debugging with PhpStorm](https://confluence.jetbrains.com/display/PhpStorm/Debugging+with+PhpStorm)\n","source":"_posts/make-php-development-VM-using-Vagrant.md","raw":"---\ntitle: 2 - Make PHP development VM using Vagrant | Study PHP\ntags:\n  - php\ncategories:\n  - \ndate: 2017-06-13 17:42:06\n---\n\n\n{% asset_img make-php-development-VM-using-Vagrant-13489.png %}\n\n\nhttps://github.com/EthanCai/php-dev-vm\n\n# \n\n`php-dev-vm``PHP``Vagrantfile``PHP`\n\n# \n\n\n\n- \n- \n- \n- \n\n#  - VMDocker\n\n\n\n`Vagrant``Rsync``FTP`\n\n **PHP Docker**PHP\n\n#  - `Vagrant`PHP\n\nPHP\n\n## \n\n- macOS Sierra Version 10.12.5\n- `homebrew`\n- `vagrantup`\n- `virualbox`\n\n## Vagrant Box\n\nInstall CentOS 7.2 box\n\n```sh\n> vagrant box add \"CentOS-7.2-x64\" https://github.com/CommanderK5/packer-centos-template/releases/download/0.7.2/vagrant-centos-7.2.box\n```\n\n## PHPVagrant Box\n\n### `php-dev-vm-5.6.30.box`\n\n`Vagrantfile`:\n\n[](./src/PHP-5.6.30/Vagrantfile)\n\n`Vagrant Box`:\n\n```sh\n> # start vm\n> vagrant up\n\n> # config mysql root password\n> mysql_secure_installation\n> # todo: add more config statements\n\n> # create vagrant box\n> vagrant package --output \"php-dev-vm-5.6.30.box\" {vm_id} && mv php-dev-vm-5.6.30.box ../../box/\n```\n\n## Vagrant BoxPHP\n\n###  `php-dev-vm-5.6.30.box`\n\n```sh\n> # build php-dev-vm-5.6.30.box or download box from ftp://10.75.87.202/php-dev-vm-5.6.30.box (get the url from Ethan if not available)\n> wget ftp://10.75.87.202/php-dev-vm-5.6.30.box && mv php-dev-vm-5.6.30.box ./box/php-dev-vm-5.6.30.box\n\n> cd work/php56\n> vagrant box remove \"../../box/php-dev-vm-5.6.30.box\" || true && vagrant up  # ignore error when box not exists\n\n> # the password of mysql `root` user is `eVkU,iO);5R>`\n```\n\n# References\n\n- Vagrant: https://www.vagrantup.com/docs/index.html\n- Discover Vagrant Boxes\n  - https://atlas.hashicorp.com/boxes/search\n  - http://www.vagrantbox.es/\n- Nginx\n  - [Nginx Beginner's Guide](http://nginx.org/en/docs/beginners_guide.html)\n  - [Setting up PHP-FastCGI and nginx? Dont trust the tutorials: check your configuration!](https://nealpoole.com/blog/2011/04/setting-up-php-fastcgi-and-nginx-dont-trust-the-tutorials-check-your-configuration/)\n  - [nginxphp-fpm](https://segmentfault.com/a/1190000003067656)\n- PHP-FPM\n  - FastCGI FPMhttp://php.net/manual/zh/install.fpm.configuration.php\n  - https://www.nginx.com/resources/wiki/start/topics/examples/phpfcgi/\n- PHP Function Reference\n  - http://php.net/manual/en/funcref.php\n- [Debugging with PhpStorm](https://confluence.jetbrains.com/display/PhpStorm/Debugging+with+PhpStorm)\n","slug":"make-php-development-VM-using-Vagrant","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf2510015v7e8fiucvvwo","content":"<img src=\"/2017/06/13/make-php-development-VM-using-Vagrant/make-php-development-VM-using-Vagrant-13489.png\">\n<p><a href=\"https://github.com/EthanCai/php-dev-vm\" target=\"_blank\" rel=\"noopener\">https://github.com/EthanCai/php-dev-vm</a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>php-dev-vm</code><code>PHP</code><code>Vagrantfile</code><code>PHP</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"-VMDocker\"><a href=\"#-VMDocker\" class=\"headerlink\" title=\" - VMDocker\"></a> - VMDocker</h1><p></p>\n<p><code>Vagrant</code><code>Rsync</code><code>FTP</code></p>\n<p> <strong>PHP Docker</strong>PHP</p>\n<h1 id=\"-VagrantPHP\"><a href=\"#-VagrantPHP\" class=\"headerlink\" title=\" - VagrantPHP\"></a> - <code>Vagrant</code>PHP</h1><p>PHP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>macOS Sierra Version 10.12.5</li>\n<li><code>homebrew</code></li>\n<li><code>vagrantup</code></li>\n<li><code>virualbox</code></li>\n</ul>\n<h2 id=\"Vagrant-Box\"><a href=\"#Vagrant-Box\" class=\"headerlink\" title=\"Vagrant Box\"></a>Vagrant Box</h2><p>Install CentOS 7.2 box</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; vagrant box add <span class=\"string\">\"CentOS-7.2-x64\"</span> https://github.com/CommanderK5/packer-centos-template/releases/download/0.7.2/vagrant-centos-7.2.box</span><br></pre></td></tr></table></figure>\n<h2 id=\"PHPVagrant-Box\"><a href=\"#PHPVagrant-Box\" class=\"headerlink\" title=\"PHPVagrant Box\"></a>PHPVagrant Box</h2><h3 id=\"php-dev-vm-5-6-30-box\"><a href=\"#php-dev-vm-5-6-30-box\" class=\"headerlink\" title=\"php-dev-vm-5.6.30.box\"></a><code>php-dev-vm-5.6.30.box</code></h3><p><code>Vagrantfile</code>:</p>\n<p><a href=\"./src/PHP-5.6.30/Vagrantfile\"></a></p>\n<p><code>Vagrant Box</code>:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"comment\"># start vm</span></span><br><span class=\"line\">&gt; vagrant up</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"comment\"># config mysql root password</span></span><br><span class=\"line\">&gt; mysql_secure_installation</span><br><span class=\"line\">&gt; <span class=\"comment\"># todo: add more config statements</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"comment\"># create vagrant box</span></span><br><span class=\"line\">&gt; vagrant package --output <span class=\"string\">\"php-dev-vm-5.6.30.box\"</span> &#123;vm_id&#125; &amp;&amp; mv php-dev-vm-5.6.30.box ../../box/</span><br></pre></td></tr></table></figure>\n<h2 id=\"Vagrant-BoxPHP\"><a href=\"#Vagrant-BoxPHP\" class=\"headerlink\" title=\"Vagrant BoxPHP\"></a>Vagrant BoxPHP</h2><h3 id=\"-php-dev-vm-5-6-30-box\"><a href=\"#-php-dev-vm-5-6-30-box\" class=\"headerlink\" title=\" php-dev-vm-5.6.30.box\"></a> <code>php-dev-vm-5.6.30.box</code></h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"comment\"># build php-dev-vm-5.6.30.box or download box from ftp://10.75.87.202/php-dev-vm-5.6.30.box (get the url from Ethan if not available)</span></span><br><span class=\"line\">&gt; wget ftp://10.75.87.202/php-dev-vm-5.6.30.box &amp;&amp; mv php-dev-vm-5.6.30.box ./box/php-dev-vm-5.6.30.box</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"built_in\">cd</span> work/php56</span><br><span class=\"line\">&gt; vagrant box remove <span class=\"string\">\"../../box/php-dev-vm-5.6.30.box\"</span> || <span class=\"literal\">true</span> &amp;&amp; vagrant up  <span class=\"comment\"># ignore error when box not exists</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"comment\"># the password of mysql `root` user is `eVkU,iO);5R&gt;`</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"References\"><a href=\"#References\" class=\"headerlink\" title=\"References\"></a>References</h1><ul>\n<li>Vagrant: <a href=\"https://www.vagrantup.com/docs/index.html\" target=\"_blank\" rel=\"noopener\">https://www.vagrantup.com/docs/index.html</a></li>\n<li>Discover Vagrant Boxes<ul>\n<li><a href=\"https://atlas.hashicorp.com/boxes/search\" target=\"_blank\" rel=\"noopener\">https://atlas.hashicorp.com/boxes/search</a></li>\n<li><a href=\"http://www.vagrantbox.es/\" target=\"_blank\" rel=\"noopener\">http://www.vagrantbox.es/</a></li>\n</ul>\n</li>\n<li>Nginx<ul>\n<li><a href=\"http://nginx.org/en/docs/beginners_guide.html\" target=\"_blank\" rel=\"noopener\">Nginx Beginners Guide</a></li>\n<li><a href=\"https://nealpoole.com/blog/2011/04/setting-up-php-fastcgi-and-nginx-dont-trust-the-tutorials-check-your-configuration/\" target=\"_blank\" rel=\"noopener\">Setting up PHP-FastCGI and nginx? Dont trust the tutorials: check your configuration!</a></li>\n<li><a href=\"https://segmentfault.com/a/1190000003067656\" target=\"_blank\" rel=\"noopener\">nginxphp-fpm</a></li>\n</ul>\n</li>\n<li>PHP-FPM<ul>\n<li>FastCGI FPM<a href=\"http://php.net/manual/zh/install.fpm.configuration.php\" target=\"_blank\" rel=\"noopener\">http://php.net/manual/zh/install.fpm.configuration.php</a></li>\n<li><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/phpfcgi/\" target=\"_blank\" rel=\"noopener\">https://www.nginx.com/resources/wiki/start/topics/examples/phpfcgi/</a></li>\n</ul>\n</li>\n<li>PHP Function Reference<ul>\n<li><a href=\"http://php.net/manual/en/funcref.php\" target=\"_blank\" rel=\"noopener\">http://php.net/manual/en/funcref.php</a></li>\n</ul>\n</li>\n<li><a href=\"https://confluence.jetbrains.com/display/PhpStorm/Debugging+with+PhpStorm\" target=\"_blank\" rel=\"noopener\">Debugging with PhpStorm</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<img src=\"/2017/06/13/make-php-development-VM-using-Vagrant/make-php-development-VM-using-Vagrant-13489.png\">\n<p><a href=\"https://github.com/EthanCai/php-dev-vm\" target=\"_blank\" rel=\"noopener\">https://github.com/EthanCai/php-dev-vm</a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>php-dev-vm</code><code>PHP</code><code>Vagrantfile</code><code>PHP</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"-VMDocker\"><a href=\"#-VMDocker\" class=\"headerlink\" title=\" - VMDocker\"></a> - VMDocker</h1><p></p>\n<p><code>Vagrant</code><code>Rsync</code><code>FTP</code></p>\n<p> <strong>PHP Docker</strong>PHP</p>\n<h1 id=\"-VagrantPHP\"><a href=\"#-VagrantPHP\" class=\"headerlink\" title=\" - VagrantPHP\"></a> - <code>Vagrant</code>PHP</h1><p>PHP</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>macOS Sierra Version 10.12.5</li>\n<li><code>homebrew</code></li>\n<li><code>vagrantup</code></li>\n<li><code>virualbox</code></li>\n</ul>\n<h2 id=\"Vagrant-Box\"><a href=\"#Vagrant-Box\" class=\"headerlink\" title=\"Vagrant Box\"></a>Vagrant Box</h2><p>Install CentOS 7.2 box</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; vagrant box add <span class=\"string\">\"CentOS-7.2-x64\"</span> https://github.com/CommanderK5/packer-centos-template/releases/download/0.7.2/vagrant-centos-7.2.box</span><br></pre></td></tr></table></figure>\n<h2 id=\"PHPVagrant-Box\"><a href=\"#PHPVagrant-Box\" class=\"headerlink\" title=\"PHPVagrant Box\"></a>PHPVagrant Box</h2><h3 id=\"php-dev-vm-5-6-30-box\"><a href=\"#php-dev-vm-5-6-30-box\" class=\"headerlink\" title=\"php-dev-vm-5.6.30.box\"></a><code>php-dev-vm-5.6.30.box</code></h3><p><code>Vagrantfile</code>:</p>\n<p><a href=\"./src/PHP-5.6.30/Vagrantfile\"></a></p>\n<p><code>Vagrant Box</code>:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"comment\"># start vm</span></span><br><span class=\"line\">&gt; vagrant up</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"comment\"># config mysql root password</span></span><br><span class=\"line\">&gt; mysql_secure_installation</span><br><span class=\"line\">&gt; <span class=\"comment\"># todo: add more config statements</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"comment\"># create vagrant box</span></span><br><span class=\"line\">&gt; vagrant package --output <span class=\"string\">\"php-dev-vm-5.6.30.box\"</span> &#123;vm_id&#125; &amp;&amp; mv php-dev-vm-5.6.30.box ../../box/</span><br></pre></td></tr></table></figure>\n<h2 id=\"Vagrant-BoxPHP\"><a href=\"#Vagrant-BoxPHP\" class=\"headerlink\" title=\"Vagrant BoxPHP\"></a>Vagrant BoxPHP</h2><h3 id=\"-php-dev-vm-5-6-30-box\"><a href=\"#-php-dev-vm-5-6-30-box\" class=\"headerlink\" title=\" php-dev-vm-5.6.30.box\"></a> <code>php-dev-vm-5.6.30.box</code></h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"comment\"># build php-dev-vm-5.6.30.box or download box from ftp://10.75.87.202/php-dev-vm-5.6.30.box (get the url from Ethan if not available)</span></span><br><span class=\"line\">&gt; wget ftp://10.75.87.202/php-dev-vm-5.6.30.box &amp;&amp; mv php-dev-vm-5.6.30.box ./box/php-dev-vm-5.6.30.box</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"built_in\">cd</span> work/php56</span><br><span class=\"line\">&gt; vagrant box remove <span class=\"string\">\"../../box/php-dev-vm-5.6.30.box\"</span> || <span class=\"literal\">true</span> &amp;&amp; vagrant up  <span class=\"comment\"># ignore error when box not exists</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"comment\"># the password of mysql `root` user is `eVkU,iO);5R&gt;`</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"References\"><a href=\"#References\" class=\"headerlink\" title=\"References\"></a>References</h1><ul>\n<li>Vagrant: <a href=\"https://www.vagrantup.com/docs/index.html\" target=\"_blank\" rel=\"noopener\">https://www.vagrantup.com/docs/index.html</a></li>\n<li>Discover Vagrant Boxes<ul>\n<li><a href=\"https://atlas.hashicorp.com/boxes/search\" target=\"_blank\" rel=\"noopener\">https://atlas.hashicorp.com/boxes/search</a></li>\n<li><a href=\"http://www.vagrantbox.es/\" target=\"_blank\" rel=\"noopener\">http://www.vagrantbox.es/</a></li>\n</ul>\n</li>\n<li>Nginx<ul>\n<li><a href=\"http://nginx.org/en/docs/beginners_guide.html\" target=\"_blank\" rel=\"noopener\">Nginx Beginners Guide</a></li>\n<li><a href=\"https://nealpoole.com/blog/2011/04/setting-up-php-fastcgi-and-nginx-dont-trust-the-tutorials-check-your-configuration/\" target=\"_blank\" rel=\"noopener\">Setting up PHP-FastCGI and nginx? Dont trust the tutorials: check your configuration!</a></li>\n<li><a href=\"https://segmentfault.com/a/1190000003067656\" target=\"_blank\" rel=\"noopener\">nginxphp-fpm</a></li>\n</ul>\n</li>\n<li>PHP-FPM<ul>\n<li>FastCGI FPM<a href=\"http://php.net/manual/zh/install.fpm.configuration.php\" target=\"_blank\" rel=\"noopener\">http://php.net/manual/zh/install.fpm.configuration.php</a></li>\n<li><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/phpfcgi/\" target=\"_blank\" rel=\"noopener\">https://www.nginx.com/resources/wiki/start/topics/examples/phpfcgi/</a></li>\n</ul>\n</li>\n<li>PHP Function Reference<ul>\n<li><a href=\"http://php.net/manual/en/funcref.php\" target=\"_blank\" rel=\"noopener\">http://php.net/manual/en/funcref.php</a></li>\n</ul>\n</li>\n<li><a href=\"https://confluence.jetbrains.com/display/PhpStorm/Debugging+with+PhpStorm\" target=\"_blank\" rel=\"noopener\">Debugging with PhpStorm</a></li>\n</ul>\n"},{"title":"","date":"2016-03-26T13:13:28.000Z","_content":"\n    \n    \n\n# \n\n2006CMMIRUPMSFUML\n\n2011Ebooking3\n\n\n\n# \n\n\n\nxx\n\n|                             |  |  |\n|:--------------------------------|:---------|:---------|\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                     |          |          |\n|                     |          |          |\n|                             |          |          |\n|                         |          |          |\n|                       |          |          |\n|                         |          |          |\n|                 |          |          |\n|                 |          |          |\n|                       |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                     |          |          |\n| UML |          |          |\n| E-R                       |          |          |\n|                         |          |          |\n|                         |          |          |\n| Rational                        |          |          |\n| Axure RP                        |          |          |\n| Sketch                          |          |          |\n| UIUE                          |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n\n\n\n\n|                             |  |  |\n|:--------------------------------|:---------|:---------|\n|                         | x        |          |\n|                         | x        |          |\n|                         | x        |          |\n|                         | x        |          |\n|                         |          | x        |\n|                     | x        |          |\n|                     |          | x        |\n|                             |          | x        |\n|                         | x        |          |\n|                       |          | x        |\n|                         |          | x        |\n|                 | x        |          |\n|                 |          | x        |\n|                       |          | x        |\n|                         | x        | x        |\n|                         |          | x        |\n|                         | x        |          |\n|                     |          | x        |\n| UML |          | x        |\n| E-R                       |          | x        |\n|                         |          | x        |\n|                         | x        |          |\n| Rational                        |          | x        |\n| Axure RP                        | x        |          |\n| Sketch                          | x        |          |\n| UIUE                          | x        |          |\n|                         | x        |          |\n|                         | x        |          |\n|                         |          | x        |\n|                         | x        |          |\n\n\n\n- \n- \n- \n\n\n\n# \n\n\n\n- \n- \n\nE-RUML\n\nE-RUMLUI/UE****\n\n# \n\n\n\n\n\n\n\n# \n\n- [UMLChina](http://www.umlchina.com/)\n- [](http://v.youku.com/v_show/id_XMTIzMzczNg==.html)\n","source":"_posts/product-design-vs-requirement-analysis.md","raw":"---\ntitle: \ndate: 2016-03-26 21:13:28\ncategories:\n- \ntags:\n- \n- \n---\n\n    \n    \n\n# \n\n2006CMMIRUPMSFUML\n\n2011Ebooking3\n\n\n\n# \n\n\n\nxx\n\n|                             |  |  |\n|:--------------------------------|:---------|:---------|\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                     |          |          |\n|                     |          |          |\n|                             |          |          |\n|                         |          |          |\n|                       |          |          |\n|                         |          |          |\n|                 |          |          |\n|                 |          |          |\n|                       |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                     |          |          |\n| UML |          |          |\n| E-R                       |          |          |\n|                         |          |          |\n|                         |          |          |\n| Rational                        |          |          |\n| Axure RP                        |          |          |\n| Sketch                          |          |          |\n| UIUE                          |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n|                         |          |          |\n\n\n\n\n|                             |  |  |\n|:--------------------------------|:---------|:---------|\n|                         | x        |          |\n|                         | x        |          |\n|                         | x        |          |\n|                         | x        |          |\n|                         |          | x        |\n|                     | x        |          |\n|                     |          | x        |\n|                             |          | x        |\n|                         | x        |          |\n|                       |          | x        |\n|                         |          | x        |\n|                 | x        |          |\n|                 |          | x        |\n|                       |          | x        |\n|                         | x        | x        |\n|                         |          | x        |\n|                         | x        |          |\n|                     |          | x        |\n| UML |          | x        |\n| E-R                       |          | x        |\n|                         |          | x        |\n|                         | x        |          |\n| Rational                        |          | x        |\n| Axure RP                        | x        |          |\n| Sketch                          | x        |          |\n| UIUE                          | x        |          |\n|                         | x        |          |\n|                         | x        |          |\n|                         |          | x        |\n|                         | x        |          |\n\n\n\n- \n- \n- \n\n\n\n# \n\n\n\n- \n- \n\nE-RUML\n\nE-RUMLUI/UE****\n\n# \n\n\n\n\n\n\n\n# \n\n- [UMLChina](http://www.umlchina.com/)\n- [](http://v.youku.com/v_show/id_XMTIzMzczNg==.html)\n","slug":"product-design-vs-requirement-analysis","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf2520017v7e8r8688yme","content":"<pre><code>\n\n</code></pre><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>2006CMMIRUPMSFUML</p>\n<p>2011Ebooking3</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>xx</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UML</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">E-R</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Rational</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Axure RP</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Sketch</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UIUE</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UML</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">E-R</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Rational</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Axure RP</td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Sketch</td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UIUE</td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>E-RUML</p>\n<p>E-RUMLUI/UE<strong></strong></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://www.umlchina.com/\" target=\"_blank\" rel=\"noopener\">UMLChina</a></li>\n<li><a href=\"http://v.youku.com/v_show/id_XMTIzMzczNg==.html\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<pre><code>\n\n</code></pre><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>2006CMMIRUPMSFUML</p>\n<p>2011Ebooking3</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>xx</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UML</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">E-R</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Rational</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Axure RP</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Sketch</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UIUE</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n<th style=\"text-align:left\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UML</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">E-R</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Rational</td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Axure RP</td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Sketch</td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UIUE</td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">x</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>E-RUML</p>\n<p>E-RUMLUI/UE<strong></strong></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://www.umlchina.com/\" target=\"_blank\" rel=\"noopener\">UMLChina</a></li>\n<li><a href=\"http://v.youku.com/v_show/id_XMTIzMzczNg==.html\" target=\"_blank\" rel=\"noopener\"></a></li>\n</ul>\n"},{"title":"1 - Install PHP | Study PHP","date":"2017-05-17T12:00:00.000Z","_content":"\n# Environment\n\n- macOS Sierra Version 10.12.4\n- Xcode: `xcode-select --install`\n- `Homebrew`\n\n# Install PHP\n\nPHP\n\n```sh\n# php https://github.com/Homebrew/homebrew-php\n> brew install brew-php-switcher\n> brew install php56\n\n> which php\n/usr/local/bin/php\n\n> which php-fpm\nlrwxr-xr-x  1 leeco  admin    32B May 17 15:08 /usr/local/bin/php -> ../Cellar/php56/5.6.30_6/bin/php\n```\n\nPHP\n\n```sh\n#  /private/etc/php.ini\n> sudo vim /usr/local/etc/php/5.6/php.ini\n# date.timezone = Asia/Shanghai\n\n> php -i | grep timezone\nDefault timezone => Asia/Shanghai\ndate.timezone => Asia/Shanghai => Asia/Shanghai\n```\n\n PEAR  PECL:\n\n```sh\n#  https://jason.pureconcepts.net/2012/10/install-pear-pecl-mac-os-x/\n> curl -O http://pear.php.net/go-pear.phar\n> sudo php -d detect_unicode=0 go-pear.phar\n# Press return\n\n#  intl  http://note.rpsh.net/posts/2015/10/07/installing-php-intl-extension-os-x-el-capitan/\n> sudo pear channel-update pear.php.net\n> sudo pecl channel-update pecl.php.net\n> sudo pear upgrade-all\n```\n\n## PHP\n\n```sh\n# php https://github.com/philcook/brew-php-switcher\n> brew unlink php56\n> brew install php71\n\n> brew-php-switcher 56 -s #  php 5.6\n```\n\n# Install Composer\n\n```sh\n> brew install composer\n\n> composer\n```\n\n{% asset_img study-php-and-symfony-on-mac-os-a5831.png %}\n\n# Install PHP Extension\n\n## Install `intl`\n\n\n\n```sh\n> brew install autoconf\n> brew install icu4c\n> brew install php56-intl   # /usr/local/etc/php/5.6/conf.d/ext-intl.ini was created\n```\n\n\n\n```\n> php -m | grep intl #  intl\n```\n\n## Install `OPcache`\n\n```sh\n> brew install php56-opcache\n\n> brew info php56-opcache\n...\nTo finish installing opcache for PHP 5.6:\n  * /usr/local/etc/php/5.6/conf.d/ext-opcache.ini was created,\n    do not forget to remove it upon extension removal.\n  * Validate installation via one of the following methods:\n...\n\n> php -m | grep OPcache  #  OPcache \n```\n\n# Install `Xdebug`\n\n\n\n```sh\n> brew install php56-xdebug\n...\nTo finish installing xdebug for PHP 5.6:\n  * /usr/local/etc/php/5.6/conf.d/ext-xdebug.ini was created,\n    do not forget to remove it upon extension removal.\n  * Validate installation via one of the following methods:\n...\n```\n\nThe Xdebug extension will be enabled per default after the installation, additional configuration of the extension should be done by adding a custom ini-file to `/usr/local/etc/php/<php-version>/conf.d/`.\n\n\n\n```\n> sudo echo 'xdebug.remote_enable=1\nxdebug.remote_host=127.0.0.1\nxdebug.remote_port=9000\nxdebug.profiler_enable=1\nxdebug.profiler_output_dir=\"/tmp/xdebug-profiler-output\"' >> /usr/local/etc/php/5.6/conf.d/ext-xdebug.ini\n```\n\n`xdebug-osx``xdebug`\n\n```sh\n> brew install xdebug-osx\n...\nSignature:\n  xdebug-toggle <on | off> [--no-server-restart]\n\nUsage:\n  xdebug-toggle         # outputs the current status\n  xdebug-toggle on      # enables xdebug\n  xdebug-toggle off     # disables xdebug\n\nOptions:\n  --no-server-restart   # toggles xdebug without restarting apache or php-fpm\n...\n```\n\n# Use PHPStorm as IDE\n\n## Config Language & Frameworks\n\n`Preferences > Languages & Frameworks > PHP`\n\n{% asset_img study-php-and-symfony-on-mac-os-0c6a2.png %}\n\nCLI Intepreter\n\n{% asset_img study-php-and-symfony-on-mac-os-2aa39.png %}\n\n\n## Config `Xdebug`\n\n`Preferences > Languages & Frameworks > PHP > Debug`\n\n{% asset_img study-php-and-symfony-on-mac-os-33b82.png %}\n\n[Configuring Xdebug in PhpStorm](https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html)\n\n## \n\nPHP`php`\n\n{% asset_img study-php-and-symfony-on-mac-os-6c7bd.png %}\n\n`Debug`\n\n{% asset_img study-php-and-symfony-on-mac-os-aec25.png %}\n\n# \n\n- [macOS 10.12 Sierra Apache Setup: MySQL, APC & More...](https://getgrav.org/blog/macos-sierra-apache-mysql-vhost-apc)\n- [Cannot find libz when install php56](https://github.com/Homebrew/homebrew-php/issues/1946)\n- [How to install Xdebug - Xdebug Documents](https://xdebug.org/docs/install)\n- [Xdebug Installation Guide](https://confluence.jetbrains.com/display/PhpStorm/Xdebug+Installation+Guide)\n- [PHPStorm Help - Configuring Xdebug](https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html)\n","source":"_posts/study-php-and-symfony-on-mac-os.md","raw":"---\ntitle: 1 - Install PHP | Study PHP\ntags:\n  - php\ncategories:\n  - \ndate: 2017-05-17 20:00:00\n---\n\n# Environment\n\n- macOS Sierra Version 10.12.4\n- Xcode: `xcode-select --install`\n- `Homebrew`\n\n# Install PHP\n\nPHP\n\n```sh\n# php https://github.com/Homebrew/homebrew-php\n> brew install brew-php-switcher\n> brew install php56\n\n> which php\n/usr/local/bin/php\n\n> which php-fpm\nlrwxr-xr-x  1 leeco  admin    32B May 17 15:08 /usr/local/bin/php -> ../Cellar/php56/5.6.30_6/bin/php\n```\n\nPHP\n\n```sh\n#  /private/etc/php.ini\n> sudo vim /usr/local/etc/php/5.6/php.ini\n# date.timezone = Asia/Shanghai\n\n> php -i | grep timezone\nDefault timezone => Asia/Shanghai\ndate.timezone => Asia/Shanghai => Asia/Shanghai\n```\n\n PEAR  PECL:\n\n```sh\n#  https://jason.pureconcepts.net/2012/10/install-pear-pecl-mac-os-x/\n> curl -O http://pear.php.net/go-pear.phar\n> sudo php -d detect_unicode=0 go-pear.phar\n# Press return\n\n#  intl  http://note.rpsh.net/posts/2015/10/07/installing-php-intl-extension-os-x-el-capitan/\n> sudo pear channel-update pear.php.net\n> sudo pecl channel-update pecl.php.net\n> sudo pear upgrade-all\n```\n\n## PHP\n\n```sh\n# php https://github.com/philcook/brew-php-switcher\n> brew unlink php56\n> brew install php71\n\n> brew-php-switcher 56 -s #  php 5.6\n```\n\n# Install Composer\n\n```sh\n> brew install composer\n\n> composer\n```\n\n{% asset_img study-php-and-symfony-on-mac-os-a5831.png %}\n\n# Install PHP Extension\n\n## Install `intl`\n\n\n\n```sh\n> brew install autoconf\n> brew install icu4c\n> brew install php56-intl   # /usr/local/etc/php/5.6/conf.d/ext-intl.ini was created\n```\n\n\n\n```\n> php -m | grep intl #  intl\n```\n\n## Install `OPcache`\n\n```sh\n> brew install php56-opcache\n\n> brew info php56-opcache\n...\nTo finish installing opcache for PHP 5.6:\n  * /usr/local/etc/php/5.6/conf.d/ext-opcache.ini was created,\n    do not forget to remove it upon extension removal.\n  * Validate installation via one of the following methods:\n...\n\n> php -m | grep OPcache  #  OPcache \n```\n\n# Install `Xdebug`\n\n\n\n```sh\n> brew install php56-xdebug\n...\nTo finish installing xdebug for PHP 5.6:\n  * /usr/local/etc/php/5.6/conf.d/ext-xdebug.ini was created,\n    do not forget to remove it upon extension removal.\n  * Validate installation via one of the following methods:\n...\n```\n\nThe Xdebug extension will be enabled per default after the installation, additional configuration of the extension should be done by adding a custom ini-file to `/usr/local/etc/php/<php-version>/conf.d/`.\n\n\n\n```\n> sudo echo 'xdebug.remote_enable=1\nxdebug.remote_host=127.0.0.1\nxdebug.remote_port=9000\nxdebug.profiler_enable=1\nxdebug.profiler_output_dir=\"/tmp/xdebug-profiler-output\"' >> /usr/local/etc/php/5.6/conf.d/ext-xdebug.ini\n```\n\n`xdebug-osx``xdebug`\n\n```sh\n> brew install xdebug-osx\n...\nSignature:\n  xdebug-toggle <on | off> [--no-server-restart]\n\nUsage:\n  xdebug-toggle         # outputs the current status\n  xdebug-toggle on      # enables xdebug\n  xdebug-toggle off     # disables xdebug\n\nOptions:\n  --no-server-restart   # toggles xdebug without restarting apache or php-fpm\n...\n```\n\n# Use PHPStorm as IDE\n\n## Config Language & Frameworks\n\n`Preferences > Languages & Frameworks > PHP`\n\n{% asset_img study-php-and-symfony-on-mac-os-0c6a2.png %}\n\nCLI Intepreter\n\n{% asset_img study-php-and-symfony-on-mac-os-2aa39.png %}\n\n\n## Config `Xdebug`\n\n`Preferences > Languages & Frameworks > PHP > Debug`\n\n{% asset_img study-php-and-symfony-on-mac-os-33b82.png %}\n\n[Configuring Xdebug in PhpStorm](https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html)\n\n## \n\nPHP`php`\n\n{% asset_img study-php-and-symfony-on-mac-os-6c7bd.png %}\n\n`Debug`\n\n{% asset_img study-php-and-symfony-on-mac-os-aec25.png %}\n\n# \n\n- [macOS 10.12 Sierra Apache Setup: MySQL, APC & More...](https://getgrav.org/blog/macos-sierra-apache-mysql-vhost-apc)\n- [Cannot find libz when install php56](https://github.com/Homebrew/homebrew-php/issues/1946)\n- [How to install Xdebug - Xdebug Documents](https://xdebug.org/docs/install)\n- [Xdebug Installation Guide](https://confluence.jetbrains.com/display/PhpStorm/Xdebug+Installation+Guide)\n- [PHPStorm Help - Configuring Xdebug](https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html)\n","slug":"study-php-and-symfony-on-mac-os","published":1,"updated":"2017-08-14T03:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjbjgf255001av7e8yu9hhvw8","content":"<h1 id=\"Environment\"><a href=\"#Environment\" class=\"headerlink\" title=\"Environment\"></a>Environment</h1><ul>\n<li>macOS Sierra Version 10.12.4</li>\n<li>Xcode: <code>xcode-select --install</code></li>\n<li><code>Homebrew</code></li>\n</ul>\n<h1 id=\"Install-PHP\"><a href=\"#Install-PHP\" class=\"headerlink\" title=\"Install PHP\"></a>Install PHP</h1><p>PHP</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># php https://github.com/Homebrew/homebrew-php</span></span><br><span class=\"line\">&gt; brew install brew-php-switcher</span><br><span class=\"line\">&gt; brew install php56</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"built_in\">which</span> php</span><br><span class=\"line\">/usr/<span class=\"built_in\">local</span>/bin/php</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"built_in\">which</span> php-fpm</span><br><span class=\"line\">lrwxr-xr-x  1 leeco  admin    32B May 17 15:08 /usr/<span class=\"built_in\">local</span>/bin/php -&gt; ../Cellar/php56/5.6.30_6/bin/php</span><br></pre></td></tr></table></figure>\n<p>PHP</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  /private/etc/php.ini</span></span><br><span class=\"line\">&gt; sudo vim /usr/<span class=\"built_in\">local</span>/etc/php/5.6/php.ini</span><br><span class=\"line\"><span class=\"comment\"># date.timezone = Asia/Shanghai</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; php -i | grep timezone</span><br><span class=\"line\">Default timezone =&gt; Asia/Shanghai</span><br><span class=\"line\">date.timezone =&gt; Asia/Shanghai =&gt; Asia/Shanghai</span><br></pre></td></tr></table></figure>\n<p> PEAR  PECL:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  https://jason.pureconcepts.net/2012/10/install-pear-pecl-mac-os-x/</span></span><br><span class=\"line\">&gt; curl -O http://pear.php.net/go-pear.phar</span><br><span class=\"line\">&gt; sudo php -d detect_unicode=0 go-pear.phar</span><br><span class=\"line\"><span class=\"comment\"># Press return</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#  intl  http://note.rpsh.net/posts/2015/10/07/installing-php-intl-extension-os-x-el-capitan/</span></span><br><span class=\"line\">&gt; sudo pear channel-update pear.php.net</span><br><span class=\"line\">&gt; sudo pecl channel-update pecl.php.net</span><br><span class=\"line\">&gt; sudo pear upgrade-all</span><br></pre></td></tr></table></figure>\n<h2 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># php https://github.com/philcook/brew-php-switcher</span></span><br><span class=\"line\">&gt; brew unlink php56</span><br><span class=\"line\">&gt; brew install php71</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; brew-php-switcher 56 -s <span class=\"comment\">#  php 5.6</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"Install-Composer\"><a href=\"#Install-Composer\" class=\"headerlink\" title=\"Install Composer\"></a>Install Composer</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install composer</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; composer</span><br></pre></td></tr></table></figure>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-a5831.png\">\n<h1 id=\"Install-PHP-Extension\"><a href=\"#Install-PHP-Extension\" class=\"headerlink\" title=\"Install PHP Extension\"></a>Install PHP Extension</h1><h2 id=\"Install-intl\"><a href=\"#Install-intl\" class=\"headerlink\" title=\"Install intl\"></a>Install <code>intl</code></h2><p></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install autoconf</span><br><span class=\"line\">&gt; brew install icu4c</span><br><span class=\"line\">&gt; brew install php56-intl   <span class=\"comment\"># /usr/local/etc/php/5.6/conf.d/ext-intl.ini was created</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; php -m | grep intl #  intl</span><br></pre></td></tr></table></figure>\n<h2 id=\"Install-OPcache\"><a href=\"#Install-OPcache\" class=\"headerlink\" title=\"Install OPcache\"></a>Install <code>OPcache</code></h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install php56-opcache</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; brew info php56-opcache</span><br><span class=\"line\">...</span><br><span class=\"line\">To finish installing opcache <span class=\"keyword\">for</span> PHP 5.6:</span><br><span class=\"line\">  * /usr/<span class=\"built_in\">local</span>/etc/php/5.6/conf.d/ext-opcache.ini was created,</span><br><span class=\"line\">    <span class=\"keyword\">do</span> not forget to remove it upon extension removal.</span><br><span class=\"line\">  * Validate installation via one of the following methods:</span><br><span class=\"line\">...</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; php -m | grep OPcache  <span class=\"comment\">#  OPcache </span></span><br></pre></td></tr></table></figure>\n<h1 id=\"Install-Xdebug\"><a href=\"#Install-Xdebug\" class=\"headerlink\" title=\"Install Xdebug\"></a>Install <code>Xdebug</code></h1><p></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install php56-xdebug</span><br><span class=\"line\">...</span><br><span class=\"line\">To finish installing xdebug <span class=\"keyword\">for</span> PHP 5.6:</span><br><span class=\"line\">  * /usr/<span class=\"built_in\">local</span>/etc/php/5.6/conf.d/ext-xdebug.ini was created,</span><br><span class=\"line\">    <span class=\"keyword\">do</span> not forget to remove it upon extension removal.</span><br><span class=\"line\">  * Validate installation via one of the following methods:</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>The Xdebug extension will be enabled per default after the installation, additional configuration of the extension should be done by adding a custom ini-file to <code>/usr/local/etc/php/&lt;php-version&gt;/conf.d/</code>.</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; sudo echo &apos;xdebug.remote_enable=1</span><br><span class=\"line\">xdebug.remote_host=127.0.0.1</span><br><span class=\"line\">xdebug.remote_port=9000</span><br><span class=\"line\">xdebug.profiler_enable=1</span><br><span class=\"line\">xdebug.profiler_output_dir=&quot;/tmp/xdebug-profiler-output&quot;&apos; &gt;&gt; /usr/local/etc/php/5.6/conf.d/ext-xdebug.ini</span><br></pre></td></tr></table></figure>\n<p><code>xdebug-osx</code><code>xdebug</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install xdebug-osx</span><br><span class=\"line\">...</span><br><span class=\"line\">Signature:</span><br><span class=\"line\">  xdebug-toggle &lt;on | off&gt; [--no-server-restart]</span><br><span class=\"line\"></span><br><span class=\"line\">Usage:</span><br><span class=\"line\">  xdebug-toggle         <span class=\"comment\"># outputs the current status</span></span><br><span class=\"line\">  xdebug-toggle on      <span class=\"comment\"># enables xdebug</span></span><br><span class=\"line\">  xdebug-toggle off     <span class=\"comment\"># disables xdebug</span></span><br><span class=\"line\"></span><br><span class=\"line\">Options:</span><br><span class=\"line\">  --no-server-restart   <span class=\"comment\"># toggles xdebug without restarting apache or php-fpm</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<h1 id=\"Use-PHPStorm-as-IDE\"><a href=\"#Use-PHPStorm-as-IDE\" class=\"headerlink\" title=\"Use PHPStorm as IDE\"></a>Use PHPStorm as IDE</h1><h2 id=\"Config-Language-amp-Frameworks\"><a href=\"#Config-Language-amp-Frameworks\" class=\"headerlink\" title=\"Config Language &amp; Frameworks\"></a>Config Language &amp; Frameworks</h2><p><code>Preferences &gt; Languages &amp; Frameworks &gt; PHP</code></p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-0c6a2.png\">\n<p>CLI Intepreter</p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-2aa39.png\">\n<h2 id=\"Config-Xdebug\"><a href=\"#Config-Xdebug\" class=\"headerlink\" title=\"Config Xdebug\"></a>Config <code>Xdebug</code></h2><p><code>Preferences &gt; Languages &amp; Frameworks &gt; PHP &gt; Debug</code></p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-33b82.png\">\n<p><a href=\"https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html\" target=\"_blank\" rel=\"noopener\">Configuring Xdebug in PhpStorm</a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>PHP<code>php</code></p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-6c7bd.png\">\n<p><code>Debug</code></p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-aec25.png\">\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://getgrav.org/blog/macos-sierra-apache-mysql-vhost-apc\" target=\"_blank\" rel=\"noopener\">macOS 10.12 Sierra Apache Setup: MySQL, APC &amp; More</a></li>\n<li><a href=\"https://github.com/Homebrew/homebrew-php/issues/1946\" target=\"_blank\" rel=\"noopener\">Cannot find libz when install php56</a></li>\n<li><a href=\"https://xdebug.org/docs/install\" target=\"_blank\" rel=\"noopener\">How to install Xdebug - Xdebug Documents</a></li>\n<li><a href=\"https://confluence.jetbrains.com/display/PhpStorm/Xdebug+Installation+Guide\" target=\"_blank\" rel=\"noopener\">Xdebug Installation Guide</a></li>\n<li><a href=\"https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html\" target=\"_blank\" rel=\"noopener\">PHPStorm Help - Configuring Xdebug</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Environment\"><a href=\"#Environment\" class=\"headerlink\" title=\"Environment\"></a>Environment</h1><ul>\n<li>macOS Sierra Version 10.12.4</li>\n<li>Xcode: <code>xcode-select --install</code></li>\n<li><code>Homebrew</code></li>\n</ul>\n<h1 id=\"Install-PHP\"><a href=\"#Install-PHP\" class=\"headerlink\" title=\"Install PHP\"></a>Install PHP</h1><p>PHP</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># php https://github.com/Homebrew/homebrew-php</span></span><br><span class=\"line\">&gt; brew install brew-php-switcher</span><br><span class=\"line\">&gt; brew install php56</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"built_in\">which</span> php</span><br><span class=\"line\">/usr/<span class=\"built_in\">local</span>/bin/php</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; <span class=\"built_in\">which</span> php-fpm</span><br><span class=\"line\">lrwxr-xr-x  1 leeco  admin    32B May 17 15:08 /usr/<span class=\"built_in\">local</span>/bin/php -&gt; ../Cellar/php56/5.6.30_6/bin/php</span><br></pre></td></tr></table></figure>\n<p>PHP</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  /private/etc/php.ini</span></span><br><span class=\"line\">&gt; sudo vim /usr/<span class=\"built_in\">local</span>/etc/php/5.6/php.ini</span><br><span class=\"line\"><span class=\"comment\"># date.timezone = Asia/Shanghai</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; php -i | grep timezone</span><br><span class=\"line\">Default timezone =&gt; Asia/Shanghai</span><br><span class=\"line\">date.timezone =&gt; Asia/Shanghai =&gt; Asia/Shanghai</span><br></pre></td></tr></table></figure>\n<p> PEAR  PECL:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  https://jason.pureconcepts.net/2012/10/install-pear-pecl-mac-os-x/</span></span><br><span class=\"line\">&gt; curl -O http://pear.php.net/go-pear.phar</span><br><span class=\"line\">&gt; sudo php -d detect_unicode=0 go-pear.phar</span><br><span class=\"line\"><span class=\"comment\"># Press return</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#  intl  http://note.rpsh.net/posts/2015/10/07/installing-php-intl-extension-os-x-el-capitan/</span></span><br><span class=\"line\">&gt; sudo pear channel-update pear.php.net</span><br><span class=\"line\">&gt; sudo pecl channel-update pecl.php.net</span><br><span class=\"line\">&gt; sudo pear upgrade-all</span><br></pre></td></tr></table></figure>\n<h2 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># php https://github.com/philcook/brew-php-switcher</span></span><br><span class=\"line\">&gt; brew unlink php56</span><br><span class=\"line\">&gt; brew install php71</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; brew-php-switcher 56 -s <span class=\"comment\">#  php 5.6</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"Install-Composer\"><a href=\"#Install-Composer\" class=\"headerlink\" title=\"Install Composer\"></a>Install Composer</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install composer</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; composer</span><br></pre></td></tr></table></figure>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-a5831.png\">\n<h1 id=\"Install-PHP-Extension\"><a href=\"#Install-PHP-Extension\" class=\"headerlink\" title=\"Install PHP Extension\"></a>Install PHP Extension</h1><h2 id=\"Install-intl\"><a href=\"#Install-intl\" class=\"headerlink\" title=\"Install intl\"></a>Install <code>intl</code></h2><p></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install autoconf</span><br><span class=\"line\">&gt; brew install icu4c</span><br><span class=\"line\">&gt; brew install php56-intl   <span class=\"comment\"># /usr/local/etc/php/5.6/conf.d/ext-intl.ini was created</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; php -m | grep intl #  intl</span><br></pre></td></tr></table></figure>\n<h2 id=\"Install-OPcache\"><a href=\"#Install-OPcache\" class=\"headerlink\" title=\"Install OPcache\"></a>Install <code>OPcache</code></h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install php56-opcache</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; brew info php56-opcache</span><br><span class=\"line\">...</span><br><span class=\"line\">To finish installing opcache <span class=\"keyword\">for</span> PHP 5.6:</span><br><span class=\"line\">  * /usr/<span class=\"built_in\">local</span>/etc/php/5.6/conf.d/ext-opcache.ini was created,</span><br><span class=\"line\">    <span class=\"keyword\">do</span> not forget to remove it upon extension removal.</span><br><span class=\"line\">  * Validate installation via one of the following methods:</span><br><span class=\"line\">...</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; php -m | grep OPcache  <span class=\"comment\">#  OPcache </span></span><br></pre></td></tr></table></figure>\n<h1 id=\"Install-Xdebug\"><a href=\"#Install-Xdebug\" class=\"headerlink\" title=\"Install Xdebug\"></a>Install <code>Xdebug</code></h1><p></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install php56-xdebug</span><br><span class=\"line\">...</span><br><span class=\"line\">To finish installing xdebug <span class=\"keyword\">for</span> PHP 5.6:</span><br><span class=\"line\">  * /usr/<span class=\"built_in\">local</span>/etc/php/5.6/conf.d/ext-xdebug.ini was created,</span><br><span class=\"line\">    <span class=\"keyword\">do</span> not forget to remove it upon extension removal.</span><br><span class=\"line\">  * Validate installation via one of the following methods:</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>The Xdebug extension will be enabled per default after the installation, additional configuration of the extension should be done by adding a custom ini-file to <code>/usr/local/etc/php/&lt;php-version&gt;/conf.d/</code>.</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; sudo echo &apos;xdebug.remote_enable=1</span><br><span class=\"line\">xdebug.remote_host=127.0.0.1</span><br><span class=\"line\">xdebug.remote_port=9000</span><br><span class=\"line\">xdebug.profiler_enable=1</span><br><span class=\"line\">xdebug.profiler_output_dir=&quot;/tmp/xdebug-profiler-output&quot;&apos; &gt;&gt; /usr/local/etc/php/5.6/conf.d/ext-xdebug.ini</span><br></pre></td></tr></table></figure>\n<p><code>xdebug-osx</code><code>xdebug</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; brew install xdebug-osx</span><br><span class=\"line\">...</span><br><span class=\"line\">Signature:</span><br><span class=\"line\">  xdebug-toggle &lt;on | off&gt; [--no-server-restart]</span><br><span class=\"line\"></span><br><span class=\"line\">Usage:</span><br><span class=\"line\">  xdebug-toggle         <span class=\"comment\"># outputs the current status</span></span><br><span class=\"line\">  xdebug-toggle on      <span class=\"comment\"># enables xdebug</span></span><br><span class=\"line\">  xdebug-toggle off     <span class=\"comment\"># disables xdebug</span></span><br><span class=\"line\"></span><br><span class=\"line\">Options:</span><br><span class=\"line\">  --no-server-restart   <span class=\"comment\"># toggles xdebug without restarting apache or php-fpm</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<h1 id=\"Use-PHPStorm-as-IDE\"><a href=\"#Use-PHPStorm-as-IDE\" class=\"headerlink\" title=\"Use PHPStorm as IDE\"></a>Use PHPStorm as IDE</h1><h2 id=\"Config-Language-amp-Frameworks\"><a href=\"#Config-Language-amp-Frameworks\" class=\"headerlink\" title=\"Config Language &amp; Frameworks\"></a>Config Language &amp; Frameworks</h2><p><code>Preferences &gt; Languages &amp; Frameworks &gt; PHP</code></p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-0c6a2.png\">\n<p>CLI Intepreter</p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-2aa39.png\">\n<h2 id=\"Config-Xdebug\"><a href=\"#Config-Xdebug\" class=\"headerlink\" title=\"Config Xdebug\"></a>Config <code>Xdebug</code></h2><p><code>Preferences &gt; Languages &amp; Frameworks &gt; PHP &gt; Debug</code></p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-33b82.png\">\n<p><a href=\"https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html\" target=\"_blank\" rel=\"noopener\">Configuring Xdebug in PhpStorm</a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>PHP<code>php</code></p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-6c7bd.png\">\n<p><code>Debug</code></p>\n<img src=\"/2017/05/17/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-aec25.png\">\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://getgrav.org/blog/macos-sierra-apache-mysql-vhost-apc\" target=\"_blank\" rel=\"noopener\">macOS 10.12 Sierra Apache Setup: MySQL, APC &amp; More</a></li>\n<li><a href=\"https://github.com/Homebrew/homebrew-php/issues/1946\" target=\"_blank\" rel=\"noopener\">Cannot find libz when install php56</a></li>\n<li><a href=\"https://xdebug.org/docs/install\" target=\"_blank\" rel=\"noopener\">How to install Xdebug - Xdebug Documents</a></li>\n<li><a href=\"https://confluence.jetbrains.com/display/PhpStorm/Xdebug+Installation+Guide\" target=\"_blank\" rel=\"noopener\">Xdebug Installation Guide</a></li>\n<li><a href=\"https://www.jetbrains.com/help/phpstorm/configuring-xdebug.html\" target=\"_blank\" rel=\"noopener\">PHPStorm Help - Configuring Xdebug</a></li>\n</ul>\n"}],"PostAsset":[{"_id":"source/_posts/elastic-basic-concepts/Brueghel-tower-of-babel.jpg","slug":"Brueghel-tower-of-babel.jpg","post":"cjbjgf24v000qv7e8gbj1r5e3","modified":0,"renderable":0},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-aec25.png","slug":"study-php-and-symfony-on-mac-os-aec25.png","post":"cjbjgf255001av7e8yu9hhvw8","modified":0,"renderable":0},{"_id":"source/_posts/experiences-about-develop-dlog/2016-04-21_07-12-40.png","slug":"2016-04-21_07-12-40.png","post":"cjbjgf24y000wv7e8d4vpuz21","modified":0,"renderable":0},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-6c7bd.png","slug":"study-php-and-symfony-on-mac-os-6c7bd.png","post":"cjbjgf255001av7e8yu9hhvw8","modified":0,"renderable":0},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-33b82.png","slug":"study-php-and-symfony-on-mac-os-33b82.png","post":"cjbjgf255001av7e8yu9hhvw8","modified":0,"renderable":0},{"_id":"source/_posts/configure-smallest-elasticsearch-cluster/es-cluster.jpg","slug":"es-cluster.jpg","post":"cjbjgf24n000dv7e8gpucx5x4","modified":0,"renderable":0},{"_id":"source/_posts/cracking-the-coding-skill/cracking_the_coding_skills.png","slug":"cracking_the_coding_skills.png","post":"cjbjgf24p000iv7e8id2ocice","modified":0,"renderable":0},{"_id":"source/_posts/create-a-launch-agents-in-macOS/2a73dea7a35b4a2057eec46b15c17133.png","slug":"2a73dea7a35b4a2057eec46b15c17133.png","post":"cjbjgf24t000lv7e85q3roztk","modified":0,"renderable":0},{"_id":"source/_posts/install-oracle-jdk-on-ubuntu-14-04/oracle-jdk8-on-Ubuntu.png","slug":"oracle-jdk8-on-Ubuntu.png","post":"cjbjgf24z000zv7e8twykfgeh","modified":0,"renderable":0},{"_id":"source/_posts/install-elasticsearch-on-ubuntu-14-04/logo-elastic.png","slug":"logo-elastic.png","post":"cjbjgf2500012v7e8axosp2r0","modified":0,"renderable":0},{"_id":"source/_posts/make-php-development-VM-using-Vagrant/make-php-development-VM-using-Vagrant-13489.png","slug":"make-php-development-VM-using-Vagrant-13489.png","post":"cjbjgf2510015v7e8fiucvvwo","modified":0,"renderable":0},{"_id":"source/_posts/elastic-basic-concepts/logo-elastic.png","slug":"logo-elastic.png","post":"cjbjgf24v000qv7e8gbj1r5e3","modified":0,"renderable":0},{"_id":"source/_posts/experiences-about-develop-dlog/2016-04-21_07-12-24.png","slug":"2016-04-21_07-12-24.png","post":"cjbjgf24y000wv7e8d4vpuz21","modified":0,"renderable":0},{"_id":"source/_posts/experiences-about-develop-dlog/channel.png","slug":"channel.png","post":"cjbjgf24y000wv7e8d4vpuz21","modified":0,"renderable":0},{"_id":"source/_posts/experiences-about-develop-dlog/expvarmon_screen.png","slug":"expvarmon_screen.png","post":"cjbjgf24y000wv7e8d4vpuz21","modified":0,"renderable":0},{"_id":"source/_posts/experiences-about-develop-dlog/use_channel.png","slug":"use_channel.png","post":"cjbjgf24y000wv7e8d4vpuz21","modified":0,"renderable":0},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-0c6a2.png","slug":"study-php-and-symfony-on-mac-os-0c6a2.png","post":"cjbjgf255001av7e8yu9hhvw8","modified":0,"renderable":0},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-2aa39.png","slug":"study-php-and-symfony-on-mac-os-2aa39.png","post":"cjbjgf255001av7e8yu9hhvw8","modified":0,"renderable":0},{"_id":"source/_posts/study-php-and-symfony-on-mac-os/study-php-and-symfony-on-mac-os-a5831.png","slug":"study-php-and-symfony-on-mac-os-a5831.png","post":"cjbjgf255001av7e8yu9hhvw8","modified":0,"renderable":0},{"_id":"source/_drafts/Error-Handling-in-Go/d2a2d12e1a00f819d7fd7af4b536efa2.png","slug":"d2a2d12e1a00f819d7fd7af4b536efa2.png","post":"cjbjgf24g0006v7e81cgx4byq","modified":1,"renderable":0}],"PostCategory":[{"post_id":"cjbjgf24h0007v7e8cj2cop42","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf24o000ev7e86z7jkt81"},{"post_id":"cjbjgf2470001v7e8tqb9os2r","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf24s000jv7e8su6au52q"},{"post_id":"cjbjgf24l000cv7e8zr4vypkf","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf24t000mv7e8utiv08nb"},{"post_id":"cjbjgf24b0003v7e8fl9j23vt","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf24w000rv7e8h1q08tgr"},{"post_id":"cjbjgf24n000dv7e8gpucx5x4","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf24x000tv7e83vlub4is"},{"post_id":"cjbjgf24p000iv7e8id2ocice","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf24y000xv7e84do1idrt"},{"post_id":"cjbjgf24g0006v7e81cgx4byq","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf2500010v7e8yljifqps"},{"post_id":"cjbjgf24v000qv7e8gbj1r5e3","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf2510013v7e8byf1o7zy"},{"post_id":"cjbjgf24i0008v7e8j5sqe4zb","category_id":"cjbjgf24u000nv7e8off0uv46","_id":"cjbjgf2520016v7e8t3hzj24t"},{"post_id":"cjbjgf24w000sv7e8nlit4ewa","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf2540018v7e8paw2fujo"},{"post_id":"cjbjgf24y000wv7e8d4vpuz21","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf255001bv7e8yrlkb5jy"},{"post_id":"cjbjgf24t000lv7e85q3roztk","category_id":"cjbjgf24x000uv7e8acy8bfl7","_id":"cjbjgf256001ev7e8atm6bpg4"},{"post_id":"cjbjgf24z000zv7e8twykfgeh","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf257001hv7e8b93a2ups"},{"post_id":"cjbjgf2500012v7e8axosp2r0","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf257001jv7e8izhmmed1"},{"post_id":"cjbjgf2510015v7e8fiucvvwo","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf257001lv7e8fv3diqa8"},{"post_id":"cjbjgf255001av7e8yu9hhvw8","category_id":"cjbjgf24d0004v7e86jktnms3","_id":"cjbjgf257001nv7e8jv5bhchx"},{"post_id":"cjbjgf2520017v7e8r8688yme","category_id":"cjbjgf256001dv7e8c8q65c9i","_id":"cjbjgf257001ov7e8sdd16sex"}],"PostTag":[{"post_id":"cjbjgf2470001v7e8tqb9os2r","tag_id":"cjbjgf24f0005v7e8o2owbd2i","_id":"cjbjgf24l000bv7e89cdwqkcu"},{"post_id":"cjbjgf24l000cv7e8zr4vypkf","tag_id":"cjbjgf24f0005v7e8o2owbd2i","_id":"cjbjgf24p000hv7e8bfx71w4t"},{"post_id":"cjbjgf24b0003v7e8fl9j23vt","tag_id":"cjbjgf24j000av7e8bnzr05t9","_id":"cjbjgf24s000kv7e84xaecq53"},{"post_id":"cjbjgf24p000iv7e8id2ocice","tag_id":"cjbjgf24p000gv7e8v38niwkh","_id":"cjbjgf24v000pv7e89j992hej"},{"post_id":"cjbjgf24g0006v7e81cgx4byq","tag_id":"cjbjgf24p000gv7e8v38niwkh","_id":"cjbjgf24z000yv7e89dn5harx"},{"post_id":"cjbjgf24g0006v7e81cgx4byq","tag_id":"cjbjgf24u000ov7e8t6j10349","_id":"cjbjgf2500011v7e8rjeqkq0s"},{"post_id":"cjbjgf24h0007v7e8cj2cop42","tag_id":"cjbjgf24y000vv7e8zk5968v0","_id":"cjbjgf256001cv7e8pyov31r5"},{"post_id":"cjbjgf24h0007v7e8cj2cop42","tag_id":"cjbjgf2510014v7e8s6mbeasw","_id":"cjbjgf256001fv7e8pssb7284"},{"post_id":"cjbjgf24i0008v7e8j5sqe4zb","tag_id":"cjbjgf2540019v7e8m8we421r","_id":"cjbjgf257001iv7e859lj1j9s"},{"post_id":"cjbjgf24n000dv7e8gpucx5x4","tag_id":"cjbjgf256001gv7e8pynxlptb","_id":"cjbjgf257001mv7e83bm4qwjl"},{"post_id":"cjbjgf24t000lv7e85q3roztk","tag_id":"cjbjgf257001kv7e8ubrognk7","_id":"cjbjgf258001qv7e82drxuoo2"},{"post_id":"cjbjgf24v000qv7e8gbj1r5e3","tag_id":"cjbjgf256001gv7e8pynxlptb","_id":"cjbjgf258001sv7e8yhk93fxe"},{"post_id":"cjbjgf24w000sv7e8nlit4ewa","tag_id":"cjbjgf258001rv7e84wep84p1","_id":"cjbjgf259001uv7e8iog9vmmm"},{"post_id":"cjbjgf24y000wv7e8d4vpuz21","tag_id":"cjbjgf259001tv7e84c9mtvle","_id":"cjbjgf259001xv7e8x14jahnw"},{"post_id":"cjbjgf24y000wv7e8d4vpuz21","tag_id":"cjbjgf24y000vv7e8zk5968v0","_id":"cjbjgf25a001yv7e8k2csa6wi"},{"post_id":"cjbjgf24z000zv7e8twykfgeh","tag_id":"cjbjgf259001wv7e8d8w0vu6b","_id":"cjbjgf25a0021v7e8yj83ecwn"},{"post_id":"cjbjgf24z000zv7e8twykfgeh","tag_id":"cjbjgf256001gv7e8pynxlptb","_id":"cjbjgf25b0022v7e867wgf4f7"},{"post_id":"cjbjgf2500012v7e8axosp2r0","tag_id":"cjbjgf259001wv7e8d8w0vu6b","_id":"cjbjgf25c0025v7e8jmhkf3s4"},{"post_id":"cjbjgf2500012v7e8axosp2r0","tag_id":"cjbjgf256001gv7e8pynxlptb","_id":"cjbjgf25c0026v7e88q9dz1gd"},{"post_id":"cjbjgf2510015v7e8fiucvvwo","tag_id":"cjbjgf25b0024v7e8o91mw01v","_id":"cjbjgf25c0028v7e8cqtv5j4i"},{"post_id":"cjbjgf2520017v7e8r8688yme","tag_id":"cjbjgf25c0027v7e8hr7fg2m1","_id":"cjbjgf25d002bv7e8klb84tra"},{"post_id":"cjbjgf2520017v7e8r8688yme","tag_id":"cjbjgf25c0029v7e8w7ul0b3j","_id":"cjbjgf25d002cv7e8c952lvry"},{"post_id":"cjbjgf255001av7e8yu9hhvw8","tag_id":"cjbjgf25b0024v7e8o91mw01v","_id":"cjbjgf25d002dv7e8v3oajupe"}],"Tag":[{"name":"mongodb","_id":"cjbjgf24f0005v7e8o2owbd2i"},{"name":"docker","_id":"cjbjgf24j000av7e8bnzr05t9"},{"name":"coding","_id":"cjbjgf24p000gv7e8v38niwkh"},{"name":"go","_id":"cjbjgf24u000ov7e8t6j10349"},{"name":"golang","_id":"cjbjgf24y000vv7e8zk5968v0"},{"name":"json","_id":"cjbjgf2510014v7e8s6mbeasw"},{"name":"","_id":"cjbjgf2540019v7e8m8we421r"},{"name":"elasticsearch","_id":"cjbjgf256001gv7e8pynxlptb"},{"name":"macOS","_id":"cjbjgf257001kv7e8ubrognk7"},{"name":"API","_id":"cjbjgf258001rv7e84wep84p1"},{"name":"data log","_id":"cjbjgf259001tv7e84c9mtvle"},{"name":"jdk","_id":"cjbjgf259001wv7e8d8w0vu6b"},{"name":"php","_id":"cjbjgf25b0024v7e8o91mw01v"},{"name":"","_id":"cjbjgf25c0027v7e8hr7fg2m1"},{"name":"","_id":"cjbjgf25c0029v7e8w7ul0b3j"}]}}